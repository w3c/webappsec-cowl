<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Confinement with Origin Web Labels</title>
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li li { font-size:   85%;    }

	.toc > li             { margin: 1.5rem 0;    }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	.toc .secno {
		float: left;
		width: 4rem;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 67155cabad72a8ab669a7d4421c90e2999a29b68" name="generator">
  <link href="https://www.w3.org/TR/COWL/" rel="canonical">
  <meta content="d36e6265defdfc39143c77769a19795e89e88755" name="document-revision">
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #000000 } /* Literal.Number */
.highlight .s { color: #a67f59 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #669900 } /* Name.Tag */
.highlight .nv { color: #222222 } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #000000 } /* Literal.Number.Bin */
.highlight .mf { color: #000000 } /* Literal.Number.Float */
.highlight .mh { color: #000000 } /* Literal.Number.Hex */
.highlight .mi { color: #000000 } /* Literal.Number.Integer */
.highlight .mo { color: #000000 } /* Literal.Number.Oct */
.highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
.highlight .sc { color: #a67f59 } /* Literal.String.Char */
.highlight .sd { color: #a67f59 } /* Literal.String.Doc */
.highlight .s2 { color: #a67f59 } /* Literal.String.Double */
.highlight .se { color: #a67f59 } /* Literal.String.Escape */
.highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
.highlight .si { color: #a67f59 } /* Literal.String.Interpol */
.highlight .sx { color: #a67f59 } /* Literal.String.Other */
.highlight .sr { color: #a67f59 } /* Literal.String.Regex */
.highlight .s1 { color: #a67f59 } /* Literal.String.Single */
.highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1>Confinement with Origin Web Labels</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2017-11-07">7 November 2017</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webappsec-cowl/">https://w3c.github.io/webappsec-cowl/</a>
     <dt>Latest published version:
     <dd><a href="https://www.w3.org/TR/COWL/">https://www.w3.org/TR/COWL/</a>
     <dt>Version History:
     <dd><a href="https://github.com/w3c/webappsec-cowl/commits/master/index.src.html">https://github.com/w3c/webappsec-cowl/commits/master/index.src.html</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5Bcowl%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[cowl] <i data-lt="">… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:deian@gitstar.com">Deian Stefan</a> (<span class="p-org org">GitStar Inc.</span>)
     <dt>Participate:
     <dd><a href="https://github.com/w3c/webappsec-cowl/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-cowl/issues">open issues</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2017 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines an API for specifying privacy and

integrity policies on data, in the form of origin labels, and a
mechanism for confining iframes according to such policies.  This
allows Web application authors and server operators to shared data
with untrusted—buggy but not malicious—code (e.g., in a mashup
scenario) yet impose restrictions on how the code running in an iframe can
share the data further.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> <strong>Changes to this document may be tracked at <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong> </p>
   <p> The (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5Bcowl%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="https://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “cowl” in the subject,
	preferably like this:
	“[cowl] <em>…summary of comment…</em>” </p>
   <p> This document was produced by the <a href="https://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2017/Process-20170301/" id="w3c_process_revision">1 March 2017 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a>
      <li>
       <a href="#examples"><span class="secno">1.2</span> <span class="content">Use Cases/Examples</span></a>
       <ol class="toc">
        <li><a href="#examples-checker"><span class="secno">1.2.1</span> <span class="content">Confining untrusted third-party services</span></a>
        <li><a href="#examples-mashup"><span class="secno">1.2.2</span> <span class="content">Sharing data with third-party mashups</span></a>
        <li><a href="#examples-isolation"><span class="secno">1.2.3</span> <span class="content">Content isolation via privilege separation</span></a>
        <li><a href="#examples-leastpriv"><span class="secno">1.2.4</span> <span class="content">Running content with least-privileges</span></a>
       </ol>
      <li>
       <a href="#security-considerations"><span class="secno">1.3</span> <span class="content">Security Considerations</span></a>
       <ol class="toc">
        <li><a href="#covert-channels"><span class="secno">1.3.1</span> <span class="content">Information leakage via covert channels</span></a>
        <li><a href="#defense-in-depth"><span class="secno">1.3.2</span> <span class="content">Defense in depth</span></a>
       </ol>
      <li>
       <a href="#privacy-considerations"><span class="secno">1.4</span> <span class="content">Privacy Considerations</span></a>
       <ol class="toc">
        <li><a href="#privacy-request-header"><span class="secno">1.4.1</span> <span class="content">Encoding information in labels</span></a>
        <li><a href="#privacy-protect"><span class="secno">1.4.2</span> <span class="content">Using labels to enhance privacy</span></a>
       </ol>
     </ol>
    <li>
     <a href="#key-concepts"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
     <ol class="toc">
      <li><a href="#key-concepts-labels"><span class="secno">2.1</span> <span class="content">Labels</span></a>
      <li><a href="#key-concepts-privileges"><span class="secno">2.2</span> <span class="content">Privileges</span></a>
     </ol>
    <li>
     <a href="#framework"><span class="secno">3</span> <span class="content">Framework</span></a>
     <ol class="toc">
      <li>
       <a href="#framework-labels"><span class="secno">3.1</span> <span class="content">Labels</span></a>
       <ol class="toc">
        <li><a href="#label-constructors"><span class="secno">3.1.1</span> <span class="content">Constructors</span></a>
        <li><a href="#label-methods"><span class="secno">3.1.2</span> <span class="content">Methods</span></a>
        <li><a href="#label-stringifer"><span class="secno">3.1.3</span> <span class="content">Serializing labels</span></a>
        <li><a href="#label-examples"><span class="secno">3.1.4</span> <span class="content">Examples</span></a>
       </ol>
      <li>
       <a href="#privileges"><span class="secno">3.2</span> <span class="content">Privileges</span></a>
       <ol class="toc">
        <li><a href="#privilege-constructors"><span class="secno">3.2.1</span> <span class="content">Constructors</span></a>
        <li><a href="#privilege-methods"><span class="secno">3.2.2</span> <span class="content">Methods</span></a>
        <li><a href="#privilege-examples"><span class="secno">3.2.3</span> <span class="content">Examples</span></a>
       </ol>
      <li>
       <a href="#framework-context-labels"><span class="secno">3.3</span> <span class="content">Labeled Contexts</span></a>
       <ol class="toc">
        <li><a href="#cowl-attributes"><span class="secno">3.3.1</span> <span class="content">Attributes</span></a>
        <li><a href="#COWL-examples"><span class="secno">3.3.2</span> <span class="content">Examples</span></a>
       </ol>
      <li>
       <a href="#object-labels"><span class="secno">3.4</span> <span class="content">Labeled Objects</span></a>
       <ol class="toc">
        <li><a href="#labeledobject-constructor"><span class="secno">3.4.1</span> <span class="content">Constructors</span></a>
        <li><a href="#labeledobject-attributes"><span class="secno">3.4.2</span> <span class="content">Attributes</span></a>
        <li><a href="#labeledobject-methods"><span class="secno">3.4.3</span> <span class="content">Methods</span></a>
        <li><a href="#labeledobject-examples"><span class="secno">3.4.4</span> <span class="content">Examples</span></a>
       </ol>
      <li>
       <a href="#header"><span class="secno">3.5</span> <span class="content">The <code>Sec-COWL</code> HTTP Header Field</span></a>
       <ol class="toc">
        <li><a href="#request-header"><span class="secno">3.5.1</span> <span class="content"><code>Sec-COWL</code> in HTTP Requests</span></a>
        <li><a href="#response-header"><span class="secno">3.5.2</span> <span class="content"><code>Sec-COWL</code> in HTTP Responses</span></a>
       </ol>
      <li>
       <a href="#extension-xhr"><span class="secno">3.6</span> <span class="content">Extensions to XMLHttpRequest</span></a>
       <ol class="toc">
        <li>
         <a href="#sending-labeled-objects"><span class="secno">3.6.1</span> <span class="content">Sending <span>labeled objects</span></span></a>
         <ol class="toc">
          <li><a href="#labeledobject-xhr-send-example"><span class="secno">3.6.1.1</span> <span class="content">Examples</span></a>
         </ol>
        <li>
         <a href="#receive-labeled-object"><span class="secno">3.6.2</span> <span class="content">Receiving <span>labeled objects</span></span></a>
         <ol class="toc">
          <li><a href="#labeledobject-xhr-receive-example"><span class="secno">3.6.2.1</span> <span class="content">Examples</span></a>
         </ol>
       </ol>
      <li>
       <a href="#enforcement"><span class="secno">3.7</span> <span class="content">Confinement Enforcement</span></a>
       <ol class="toc">
        <li><a href="#modifications-fetch"><span class="secno">3.7.1</span> <span class="content">Modifications to Fetch</span></a>
        <li><a href="#modifications-to-web-messaging"><span class="secno">3.7.2</span> <span class="content">Modifications to Web Messaging</span></a>
        <li><a href="#modifications-to-html5"><span class="secno">3.7.3</span> <span class="content">Modifications to HTML5</span></a>
        <li><a href="#modifications-websockets"><span class="secno">3.7.4</span> <span class="content">Modifications to WebSockets</span></a>
       </ol>
     </ol>
    <li>
     <a href="#algorithms"><span class="secno">4</span> <span class="content">Algorithms</span></a>
     <ol class="toc">
      <li><a href="#reduce-to-normal-form"><span class="secno">4.1</span> <span class="content">Label Normal Form Reduction</span></a>
      <li><a href="#subsumes-check"><span class="secno">4.2</span> <span class="content">Label Subsumption</span></a>
      <li><a href="#alg-label-downgrade"><span class="secno">4.3</span> <span class="content">Label Downgrade</span></a>
      <li><a href="#alg-label-upgrade"><span class="secno">4.4</span> <span class="content">Label Upgrade</span></a>
      <li><a href="#taint-context"><span class="secno">4.5</span> <span class="content">Context Tainting</span></a>
      <li><a href="#alg-write-check"><span class="secno">4.6</span> <span class="content">Write Check</span></a>
      <li><a href="#structured-cloning"><span class="secno">4.7</span> <span class="content">Structured Cloning</span></a>
      <li><a href="#should-block-fetch"><span class="secno">4.8</span> <span class="content"> Should fetching <var>request</var> be blocked as COWL? </span></a>
      <li><a href="#process-response"><span class="secno">4.9</span> <span class="content"> Process <var>response</var> to <var>request</var> as COWL </span></a>
      <li><a href="#parse-labeled-metadata-data"><span class="secno">4.10</span> <span class="content"> Parse labeled data metadata </span></a>
      <li><a href="#parse-labeled-metadata-ctx"><span class="secno">4.11</span> <span class="content"> Parse labeled context metadata </span></a>
      <li><a href="#parse-label-expression"><span class="secno">4.12</span> <span class="content"> Parse label expression </span></a>
     </ol>
    <li>
     <a href="#iana-considerations"><span class="secno">5</span> <span class="content">IANA Considerations</span></a>
     <ol class="toc">
      <li><a href="#iana-https"><span class="secno">5.1</span> <span class="content"> The <code>Sec-COWL</code> HTTP Header Field </span></a>
      <li><a href="#iana-mime"><span class="secno">5.2</span> <span class="content"> The <code>application/labeled-json</code> MIME media type </span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">6</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>Modern Web applications are conglomerations of JavaScript written by
  multiple authors. Authors routinely incorporate third-party scripts
  into their applications and share user data with third-party
  services (e.g., as part of a <em>mashup</em>).  Unfortunately, in
  the existing model, the user’s data confidentiality and integrity is
  put at risk when one incorporates untrusted third-party code or
  shares data with untrusted third-party services.</p>
    <p>Mechanisms such as CORS and CSP can be used to mitigate these risks
  by giving authors control over whom they share data with. But, once
  data is shared, these mechanisms do not impose any restrictions on
  how the code that was granted access can further disseminate the
  data.</p>
    <p>This document specifies an extension to the current model called
  Confinement with Origin Web Labels (COWL). COWL provides authors
  with APIs for specifying (mandatory) access control policies on
  data, including content, in terms of <a data-link-type="dfn" href="#origin-label" id="ref-for-origin-label">origin labels</a>.  These
  policies are enforced in a mandatory fashion, transitively, even
  once code has access to the data.  For example, with COWL, the
  author of <code>https://example.com</code> can specify that a
  password is confidential to <code>https://example.com</code> (and
  thus should only be disclosed to <code>https://example.com</code>)
  before sharing it with a third-party password strength checking
  service. In turn, COWL ensures that the third-party service, which
  necessarily computes on the sensitive password, is confined and
  respects the policy on the password: COWL disallows it from
  disclosing the password to any <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2">origin</a> other than <code>https://example.com</code>.</p>
    <p>COWL enforces such policies by confining code at the <a data-link-type="dfn">context</a>-level, according to the sensitivity (i.e., the label)
  of the data the code has observed. To reap the greatest benefits of
  COWL, authors will need to compartmentalize applications into
  multiple contexts (e.g., <a data-link-type="dfn" href="https://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element">iframes</a>).</p>
    <p>In the existing model, any page served from an origin has the
  ambient, implicit authority of that origin.  This documents
  generalizes this notion of authority and gives authors explicit
  control over it with <a data-link-type="dfn" href="#privilege" id="ref-for-privilege">privileges</a>.  For example, by default, a
  page whose origin is <code>https://example.com</code> has the
  privilege for <code>https://example.com</code>. This gives the page
  the authority to arbitrarily disseminate data sensitive to <code>https://example.com</code>; to be backwards-compatible,
  COWL does not confine the page when reading data sensitive to <code>https://example.com</code>.  However, COWL allows the author
  to run iframes with "weaker" <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege">delegated privileges</a> (e.g., one
  corresponding the current user at <code>https://example.com</code>)
  or to drop the privilege altogether.</p>
    <p>COWL is intended to be used as a defense-in-depth mechanism that can restrict
  how untrusted—buggy but not malicious—code handles sensitive
  data. Given the complexities of browser implementations and the presence of
  covert channels, malicious code may be able to exfiltrate data. Authors
  should still use discretionary access control mechanisms, such as CSP and
  CORS, to restrict access to the data in the first place.</p>
    <section>
     <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
     <p>The goal of COWL is to provide authors with a means for protecting
  the confidentiality and integrity of data that is shared with
  untrusted code, whether third-party or their own.  Existing
  mechanisms (e.g.,
  CORS’s <a data-link-type="dfn" href="https://www.w3.org/TR/cors/#access-control-allow-origin-response-header" id="ref-for-access-control-allow-origin-response-header"><code>Access-Control-Allow-Origin</code></a> header and the <code>targetOrigin</code> argument to <a data-link-type="functionish" href="https://www.w3.org/TR/webmessaging/#dom-window-postmessage" id="ref-for-dom-window-postmessage"><code>postMessage()</code></a>) provide a way for restricting
  which <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2①">origins</a> may access the shared data.  But, once content
  has access to data it can usually disseminate it without
  restrictions.  While CSP can be used to confine code, i.e., restrict
  how confidential data is disseminated, setting a correct CSP policy
  (as to confine code) is difficult and limited to content the author
  has control over. Indeed, sharing confidential data in the existing
  model almost always requires the sender to trust the receiver not to
  leak the data, accidentally or otherwise.  COWL provides a
  defense-in-depth option for protecting data confidentiality and
  integrity.  In particular, with COWL:</p>
     <ol>
      <li data-md="">
       <p>Authors should be able to specify confidentiality and integrity
 policies on data in terms of origin labels: the origins to whom the
 data is confidential and the origins that endorse the data.  This
 allows authors to share sensitive data with third-party content and
 impose restrictions on the origins with which it can communicate
 once it inspects the sensitive data. Dually, it allows authors to
 share data via intermediate content while retaining its integrity.</p>
      <li data-md="">
       <p>Authors should be able to run code with <em>least privilege</em> by restricting the origins the code can communicate with and thus
 how it can disseminate sensitive data.</p>
      <li data-md="">
       <p>Authors should be able to <em>privilege separate</em> applications by compartmentalizing them into separate contexts that
 have <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege①">delegated privileges</a>.</p>
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Use Cases/Examples</span><a class="self-link" href="#examples"></a></h3>
     <h4 class="heading settled" data-level="1.2.1" id="examples-checker"><span class="secno">1.2.1. </span><span class="content">Confining untrusted third-party services</span><a class="self-link" href="#examples-checker"></a></h4>
     <p>An author wishes to use a service, loaded in the form of an <a data-link-type="dfn">cowl iframe</a>,
  without trusting it (or its dependencies) to not leak her
  sensitive data. To protect the data, the author associates a
  confidentiality <a data-link-type="dfn" href="#label" id="ref-for-label">label</a> with the data, specifying the origins
  allowed to read the data.  The author then shares the newly created <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects">labeled object</a> with the untrusted code.  In turn, COWL
  confines the untrusted code once it inspects the sensitive data, as
  to ensure that it can only communicate according to the
  author-specified policy (the label).</p>
     <div class="example" id="example-c3051554">
      <a class="self-link" href="#example-c3051554"></a> The author of <code>https://example.com</code> wishes to use a third-party password strength checker provided by <code>https://untrusted.com</code>.  To protect the
    confidentiality of the password, the <code>https://example.com</code> application can use COWL to
    run the checker code in a <a data-link-type="dfn">cowl iframe</a> and associate a
    confidentiality policy, in the form of a <a data-link-type="dfn" href="#label" id="ref-for-label②">label</a>, with the password
    before sending it to the untrusted service: 
<pre><code>// Create new policy using <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①">Label</a>s that specifies that the password is sensitive
// to https://example.com and should only be disclosed to this origin:
var policy = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①⓪">Label</a>(window.location.origin);

// Associate the label with the password:
var labeledPassword = new <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject">LabeledObject</a>(password, { confidentiality: policy });

// Send the labeled password to the checker iframe:
checker.postMessage(labeledPassword, "https://untrusted.com");

// Register listener to receive a response from checker, etc.
</code></pre>
      <p>Once the checker inspects the label-<a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object">protected object</a>, i.e., the
    password, COWL limits the iframe to communicating with origins that
    preserve the password’s confidentiality (in this case, <code>https://example.com</code>).  This policy is enforced mandatorily,
    even if the <code>https://untrusted.com</code> iframe sends the password to
    yet another iframe.</p>
      <p class="note" role="note"><span>Note,</span> until the checker actually inspects the labeled password, it
    can freely communicate with any origins, e.g., with <code>https://untrusted.com</code>.  This is important since the
    checker may need to fetch resources (e.g., regular expressions) to
    check the password strength.  It’s also safe—the checker has
    not inspected the sensitive password, and thus need not be
    confined.</p>
     </div>
     <p>Other use cases in this category include password managers and
  encrypted document editors, for example, where an
  encryption/decryption layer and a storage layer are provided by
  distrusting, but not malicious, services.  The academic paper on
  COWL describes these use cases in detail <a data-link-type="biblio" href="#biblio-cowl-osdi">[COWL-OSDI]</a>.</p>
     <h4 class="heading settled" data-level="1.2.2" id="examples-mashup"><span class="secno">1.2.2. </span><span class="content">Sharing data with third-party mashups</span><a class="self-link" href="#examples-mashup"></a></h4>
     <p>A server operator wishes to provide third-party mashups access to user data.
  In addition to using CORS response headers to restrict the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2②">origins</a> that can access the data <a data-link-type="biblio" href="#biblio-cors">[CORS]</a>, the operator wishes to restrict how the
  data is further disseminated by these origins once they have access to it, in
  the browser. To do so, the perator sends a response header field named <a href="#response-header"><code>Sec-COWL</code></a> (described in <a href="#response-header">§3.5.2 Sec-COWL in HTTP Responses</a>) whose value contains the sensitivity of the data in the
  form of a serialized confidentiality <a data-link-type="dfn" href="#label" id="ref-for-label③">label</a>.  In turn, COWL enforces
  the label restrictions on the third-party code.</p>
     <div class="example" id="example-90493c03">
      <a class="self-link" href="#example-90493c03"></a> The server operator of <code>https://provider.com</code> uses a
    CORS response header to grant <code>https://mashup.com</code> access to a resource. The operator also sets a COWL header to
    specify that the resource is confidential to <code>https://provider.com</code> and should not be disseminated
    arbitrarily: 
<pre><code><a data-link-type="dfn" href="https://www.w3.org/TR/cors/#access-control-allow-origin-response-header" id="ref-for-access-control-allow-origin-response-header①">Access-Control-Allow-Origin</a>: https://mashup.com
<a href="#response-header">Sec-COWL</a>: <a data-link-type="dfn" href="#data-confidentiality" id="ref-for-data-confidentiality">data-confidentiality</a> https://provider.com
</code></pre>
      <p>COWL only allows a <code>https://mashup.com</code> context to read
    the sensitive response if the label restrictions of the response
    are respected, i.e., if the code can only communicate with <code>https://provider.com</code>.</p>
      <p class="note" role="note"><span>Note,</span> COWL only allows the code to inspect the response if the <a data-link-type="dfn" href="#context-labels" id="ref-for-context-labels">context
    labels</a>, which dictate the context’s ability to communicate, are more
    restricting than the labels of the response. A more permissive approach,
    which does not require the context give up its ability to communicate
    arbitrarily is to use a <a data-link-type="dfn" href="#labeled-json-response" id="ref-for-labeled-json-response">labeled JSON response</a>.  The <a href="#mashup-example-xhr">mashup XHR example</a> shows how authors can
    accomplish this.</p>
     </div>
     <h4 class="heading settled" data-level="1.2.3" id="examples-isolation"><span class="secno">1.2.3. </span><span class="content">Content isolation via privilege separation</span><a class="self-link" href="#examples-isolation"></a></h4>
     <p>A server operator wishes to isolate content (e.g., of different
  users) while serving it from a single physical <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2③">origin</a>.  The
  operator can leverage <a data-link-type="dfn" href="#privilege" id="ref-for-privilege②">privileges</a> to ensure that content of
  one part of the site has different authority from another and,
  importantly, does not have the authority of the physical origin.
  Concretely, when serving content, the operator can set the
  content’s <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege">context privilege</a> to a weaker, <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege②">delegated
  privilege</a>. This ensures that the content are privilege
  separated.</p>
     <div class="example" id="example-64e01183">
      <a class="self-link" href="#example-64e01183"></a> Suppose <code>https://university.edu</code> wished to isolate
    different parts of their site according to users. The server
    operator can weaken the privilege of a page when serving user
    content by providing a response header field named <a href="#response-header"><code>Sec-COWL</code></a> (see <a href="#response-header">§3.5.2 Sec-COWL in HTTP Responses</a>) whose value contains
    a serialized <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege③">delegated privilege</a>. For example, for any
    content under <code>https://university.edu/~user1</code>, the
    following header is set: 
<pre><code><a href="#response-header">Sec-COWL</a>: <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege">ctx-privilege</a> 'self' OR app:user1
</code></pre>
      <p>Having this privilege can be understood as having the authority of <code>user1</code>’s part of the application’s origin.  COWL ensures that
    the content of this page cannot interfere with the content of <code>https://university.edu</code> or that of another user e.g., <code>user2</code>.  For example, the content cannot modify <code>https://university.edu</code> cookies or the DOM of another <code>https://university.edu</code> page.</p>
      <p>This <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege④">delegated privilege</a> also ensures that the
    content cannot disseminate data sensitive to another user (e.g., <code>user2</code>) arbitrarily—without being confined,
    it can only disseminate <code>user1</code>’s data on <code>https://university.edu</code>.
    Of course, this requires the server operator to label
    sensitive data (e.g., when sending it to the user agent) appropriately
    (e.g., <code>user2</code>’s data is labeled <code><a data-link-type="dfn" href="#label" id="ref-for-label④">Label</a>("https://university.edu").or("app:user2")</code>).</p>
      <p>The <a href="#university-example-js">sub-origin isolation in
    JavaScript</a> example shows how this can be implemented using the
    COWL JavaScript APIs.</p>
     </div>
     <div class="note" role="note"> Note, sub-domains should be used when possible to ensure that
    content is isolated using the Same-Origin Policy. But, even in
    such cases, COWL can provide a useful layer of defense. </div>
     <h4 class="heading settled" data-level="1.2.4" id="examples-leastpriv"><span class="secno">1.2.4. </span><span class="content">Running content with least-privileges</span><a class="self-link" href="#examples-leastpriv"></a></h4>
     <p>An author wishes to use a library that is tightly coupled with the page
  (e.g., jQuery), but not trust it to protect the user’s confidentiality and
  integrity. With COWL, the author can do this by <a data-link-type="dfn" href="#dropping-privileges" id="ref-for-dropping-privileges">dropping privileges</a> (from the context’s <a data-link-type="dfn" href="#default-privilege" id="ref-for-default-privilege">default privilege</a>) and then loading the untrusted
  library.  In dropping privileges, the content (and untrusted library) loses
  its implicit authority over the content’s origin.</p>
     <div class="example" id="example-757d2c2d">
      <a class="self-link" href="#example-757d2c2d"></a> The author of <code>https://example.com</code> can drop privileges
    in JavaScript: 
<pre><code>// Drop privileges, by setting the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①">context privilege</a> to an <a data-link-type="dfn" href="#empty-privilege" id="ref-for-empty-privilege">empty privilege</a>:
COWL.privilege = new <a data-link-type="functionish" href="#dom-privilege-privilege" id="ref-for-dom-privilege-privilege">Privilege()</a>;

// Load untrusted library
</code></pre>
      <p>Or, by setting the content’s initial privilege to the <a data-link-type="dfn" href="#empty-privilege" id="ref-for-empty-privilege①">empty
      privilege</a> using <a href="#response-header"><code>Sec-COWL</code></a> response header:</p>
<pre><code><a href="#response-header">Sec-COWL</a>: <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege①">ctx-privilege</a> 'none'
</code></pre>
      <div class="note" role="note"> Note, while this ensures that the context code cannot, for instance,
      access the origin’s cookies, the author must still associate a
      confidentiality label with resources (e.g., HTTP responses) to
      ensure that data is properly protected. </div>
     </div>
     <p>In some cases it is useful for a particular context to have the
  privilege to disseminate certain categories of data.  (The <code>or</code> part of <a data-link-type="dfn" href="#label" id="ref-for-label⑤">labels</a> can be used to easily
  categorize differently-sensitive data.) To this end, the author
  should run the context with a <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege⑤">delegated privilege</a> instead of
  the <a data-link-type="dfn" href="#empty-privilege" id="ref-for-empty-privilege②">empty privilege</a>. The above <a href="#examples-isolation">§1.2.3 Content isolation via privilege separation</a> shows
  one such example.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="1.3" id="security-considerations"><span class="secno">1.3. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h3>
     <h4 class="heading settled" data-level="1.3.1" id="covert-channels"><span class="secno">1.3.1. </span><span class="content">Information leakage via covert channels</span><a class="self-link" href="#covert-channels"></a></h4>
      COWL provides developers with a way of imposing restrictions on how
      untrusted code can disseminate sensitive data.  However, authors should
      avoid sharing sensitive data with malicious code, since such code may be
      able to exploit covert channels to leak the data.  Covert channels are
      prevalent in most browsers.  COWL can only prevent information leakage from
      code that uses overt communication channels. 
     <p>Similarly, COWL provides no guarantees against attacks wherein users are
      manipulated into leaking sensitive data via out-of-band channels.  For
      example, an attacker may be able to convince a user to navigate their
      user agent to an attacker-owned origin by entering a URL that contains
      sensitive information into the user agent’s address bar.</p>
     <h4 class="heading settled" data-level="1.3.2" id="defense-in-depth"><span class="secno">1.3.2. </span><span class="content">Defense in depth</span><a class="self-link" href="#defense-in-depth"></a></h4>
      COWL has been defined within the context of existing security mechanisms
      (CSP, SRI, CORS, and iframe <code><a data-link-type="element-attr" href="https://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox" id="ref-for-attr-iframe-sandbox">sandbox</a></code>)
      and SHOULD be used as an additional layer of defense. The goal of this
      specification is not to replace existing discretionary access control
      mechanisms. 
    </section>
    <section>
     <h3 class="heading settled" data-level="1.4" id="privacy-considerations"><span class="secno">1.4. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy-considerations"></a></h3>
     <h4 class="heading settled" data-level="1.4.1" id="privacy-request-header"><span class="secno">1.4.1. </span><span class="content">Encoding information in labels</span><a class="self-link" href="#privacy-request-header"></a></h4>
      This specification introduces the <a href="#request-header"><code>Sec-COWL</code> HTTP request header</a> to
      provide server operators with information about the context that made the
      request (e.g., the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege②">context privilege</a>). This header is sent in
      accordance to the<a data-link-type="dfn" href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy" id="ref-for-referrer-policy">referrer policy</a> <a data-link-type="biblio" href="#biblio-referrer-policy">[REFERRER-POLICY]</a>. However,
      since the request header may contain serialized <a data-link-type="dfn" href="#application-specific-principal" id="ref-for-application-specific-principal">application-specific
      principals</a>, this can have privacy implications when the principals
      encode private user information.  It is RECOMMENDED that authors and
      server operators not include any private information in
      labels—labels SHOULD be treated as public data. 
     <h4 class="heading settled" data-level="1.4.2" id="privacy-protect"><span class="secno">1.4.2. </span><span class="content">Using labels to enhance privacy</span><a class="self-link" href="#privacy-protect"></a></h4>
      COWL provides mechanisms for restricting how information flows from
      within the confines of the user agent. Thus, from a privacy perspective,
      application developers, server operators, and specification authors are
      encouraged to consider using these mechanisms (namely, <a data-link-type="dfn" href="#label" id="ref-for-label⑥">labels</a>) to
      prevent unwanted or accidental information leaks. 
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="key-concepts"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#key-concepts"></a></h2>
    <h3 class="heading settled" data-level="2.1" id="key-concepts-labels"><span class="secno">2.1. </span><span class="content">Labels</span><a class="self-link" href="#key-concepts-labels"></a></h3>
    <ol>
     <li data-md="">
      <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="origin-label">origin label</dfn>, or more succinctly a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label">label</dfn>, encodes either a confidentiality or integrity
  security policy as conjunctive normal form (AND’s and OR’s)
  formulae over <a data-link-type="dfn" href="#principal" id="ref-for-principal">principals</a> (typically <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2④">origin</a>s.)  Labels can
  be associated with <a data-link-type="dfn">contexts</a> or with <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone" id="ref-for-structured-clone">structurally clonable</a> objects.</p>
      <p>When associated with a <a data-link-type="dfn">context</a>, the label restricts the
  origins that the context can communicate with, as detailed in <a href="#framework-context-labels">§3.3 Labeled Contexts</a>.</p>
      <div class="example" id="example-9dad37da">
       <a class="self-link" href="#example-9dad37da"></a> The confidentiality label <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①①">Label</a>("https://a.com").or("https://b.com")</code>,
    when associated with a context,
    restricts the context to sending data to <code>https://a.com</code> or <code>https://b.com</code>, but
    no other origins.
    This context label reflects the fact the context may contain data
    that is sensitive to either <code>https://a.com</code> or <code>https://b.com</code>; it is thus only safe for it to
    communicate <em>to</em> these origins. 
       <p class="note" role="note"><span>Note,</span> because the context can communicate data to either origin,
    another context associated with the more restricting
    label <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①②">Label</a>("https://a.com")</code> cannot
    send it data. Doing so would allow for data confidential
    to <code>https://a.com</code> to be leaked to <code>https://b.com</code>.</p>
      </div>
      <div class="example" id="example-b7c7efed"><a class="self-link" href="#example-b7c7efed"></a> The integrity label <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①③">Label</a>("https://a.com").or("https://b.com")</code>,
    when associated with a context, restricts the context to
    receiving data from (a context or server) that is at least as
    trustworthy as <code>https://a.com</code> or <code>https://b.com</code>.  This context label ensures that
    the code running in the context can only be influenced by data
    which either <code>https://a.com</code> or <code>https://b.com</code> endorse. </div>
      <p>When associated with an object, a confidentiality label
  specifies the origins to whom the object is sensitive, while an
  integrity label specifies the origins that endorse the object.
  Objects that have labels associated with them are called <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="labeled-objects">labeled objects</dfn>. <a href="#object-labels">§3.4 Labeled Objects</a> defines how
  labels are associated with objects.</p>
      <div class="example" id="example-b910dc87">
       <a class="self-link" href="#example-b910dc87"></a> Consider an <code>https://example.com</code> page that
    receives a labeled object (e.g., via <a data-link-type="functionish" href="https://www.w3.org/TR/webmessaging/#dom-window-postmessage" id="ref-for-dom-window-postmessage①">postMessage()</a>)
    with the following labels: 
       <ul>
        <li data-md="">
         <p>Confidentiality: <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①④">Label</a>("https://example.com")</code>.
This label indicates that the object is sensitive to <code>https://example.com</code>.</p>
        <li data-md="">
         <p>Integrity: <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①⑤">Label</a>("https://a.com")</code>.  This
label indicates that the object has been endorsed by <code>https://a.com</code>. If <code>https://example.com</code> received the message from an
intermediary <code>https://b.com</code> context, this label
reflects the fact that the object (produced by <code>https://a.com</code>) was not tampered.</p>
       </ul>
      </div>
     <li data-md="">
      <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="principal">principal</dfn> is a string that represents an authoritative
  entity. There are three kind of principals:</p>
      <ul>
       <li data-md="">
        <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="origin-principal">origin principal</dfn> is the stringified <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a> (scheme/host/port triple) of an origin.</p>
       <li data-md="">
        <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="unique-principal">unique principal</dfn> is a stringified <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-2.3" id="ref-for-section-2.3">globally unique
identifier</a> that contains the <code>"unique:"</code> string as a
prefix to a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4122#section-3" id="ref-for-section-3">UUID</a> (see <a data-link-type="dfn" href="#unique-principal-expression" id="ref-for-unique-principal-expression">unique-principal-expression</a>).</p>
       <li data-md="">
        <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="application-specific-principal">application-specific principal</dfn> is used by authors to
encode application-specific security entities (e.g., users, services);
they are strings prefixed by the <code>"app:"</code> string (see <a data-link-type="dfn" href="#app-principal-expression" id="ref-for-app-principal-expression">app-principal-expression</a>).  Such principals, when used in <a data-link-type="dfn" href="#label" id="ref-for-label⑦">labels</a>, typically only make sense if combined (e.g., as a
disjunction) with <a data-link-type="dfn" href="#origin-principal" id="ref-for-origin-principal">origin principals</a> or <a data-link-type="dfn" href="#unique-principal" id="ref-for-unique-principal">unique principals</a>.</p>
      </ul>
     <li data-md="">
      <p>Mathematically, a label is a <em>conjunctive normal form</em> formula over principals <a data-link-type="biblio" href="#biblio-dclabels">[DCLabels]</a>.</p>
      <p>A label is in <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="normal-form">normal form</dfn> if reducing it according to
  the <a data-link-type="dfn" href="#label-normal-form-reduction" id="ref-for-label-normal-form-reduction">label normal form reduction</a> algorithm produces the
  same value.</p>
      <p>Two labels are <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="equivalent">equivalent</dfn> if their <a data-link-type="dfn" href="#normal-form" id="ref-for-normal-form">normal form</a> values are mathematically equal.</p>
      <p>A label <var>A</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="subsumes">subsumes</dfn> (or is more <dfn data-dfn-type="dfn" data-noexport="" id="restricting">restricting<a class="self-link" href="#restricting"></a></dfn> than) another label <var>B</var> if the result of running the <a data-link-type="dfn" href="#label-subsumption" id="ref-for-label-subsumption">label subsumption</a> algorithm on the <a data-link-type="dfn" href="#normal-form" id="ref-for-normal-form①">normal form</a>s of <var>A</var> and <var>B</var> returns <code>true</code>. Labels are partially
  ordered according to this subsumes relation.</p>
      <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="current-confidentiality-label">current confidentiality label</dfn> is the
  confidentiality label associated with the current context. <a href="#framework-context-labels">§3.3 Labeled Contexts</a> specifies how labels are associated with
  contexts.</p>
      <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="current-integrity-label">current integrity label</dfn> is the
  integrity label associated with the current context. <a href="#framework-context-labels">§3.3 Labeled Contexts</a> specifies how labels are associated with
  contexts.</p>
      <p>When reading a <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects①">labeled object</a>, a context gets <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="tainted">tainted</dfn>, i.e., its <a data-link-type="dfn" href="#context-labels" id="ref-for-context-labels①">context labels</a> are updated by
  invoking <a data-link-type="dfn" href="#context-tainting" id="ref-for-context-tainting">context tainting</a> algorithm, to reflect that it
  has read sensitive data, or data of potentially different
  trustworthiness, and should be confined accordingly.</p>
    </ol>
    <h3 class="heading settled" data-level="2.2" id="key-concepts-privileges"><span class="secno">2.2. </span><span class="content">Privileges</span><a class="self-link" href="#key-concepts-privileges"></a></h3>
    <ol>
     <li data-md="">
      <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="privilege">privilege</dfn> is an unforgeable object that corresponds
  to a <a data-link-type="dfn" href="#label" id="ref-for-label⑧">label</a>. Privileges are associated with contexts and
  reflect their authority.</p>
      <p>Privileges can be used to bypass confinement restrictions imposed by
  confidentiality labels.  In particular, a privilege can be used to bypass
  the restrictions imposed by any label that is subsumed by the privilege’s
  corresponding label—the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label">internal privilege label</a>.</p>
      <div class="example" id="example-da3d95b4">
       <a class="self-link" href="#example-da3d95b4"></a> Consider a context from <code>https://a.com</code> whose <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label">current confidentiality label</a> is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①⑥">Label</a>("https://a.com").and("https://b.com")</code>.
    This label confines the context to only communicating with
    entities whose labels are at least as restricting as this
    label. For example, it restricts the context from
    communicating with a context labeled <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①⑦">Label</a>("https://b.com")</code>, since doing
    so could leak <code>https://a.com</code> data to <code>https://b.com</code>. It similarly prevents the context
    from communicating with <code>https://a.com</code>. 
       <p>But, suppose that the context’s <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege">current privilege</a> corresponds to <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①⑧">Label</a>("https://a.com")</code> (afterall, the context originated from <code>https://a.com</code>).
    Then, the context would be able to bypass some of the
    restrictions imposed by the context label.  Specifically, the
    context would be able to communicate with <code>https://b.com</code>; the privilege confers it the right
    to declassify <code>https://a.com</code> data to <code>https://b.com</code>. Indeed, when taking this privilege
    into consideration, the <a data-link-type="dfn" href="#effective-confidentiality-label" id="ref-for-effective-confidentiality-label">effective confidentiality label</a> of the context is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①①⑨">Label</a>("https://b.com")</code>.</p>
       <p class="note" role="note"><span>Note,</span> the privilege does not allow the context to bypass any
    label restrictions. For example, it does not allow the context
    to communicate with <code>https://a.com</code> since doing so
    could leak <code>https://b.com</code> data.</p>
       <div class="note" role="note"> To be flexible, COWL uses the context privilege to remove
      certain restrictions imposed by the <a data-link-type="dfn" href="#context-labels" id="ref-for-context-labels②">context label</a>.
      To avoid accidentally leaking sensitive context data,
      authors should use <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①">LabeledObject</a>s. </div>
      </div>
      <p>Privileges can also be used to bypass integrity restrictions
  imposed by integrity labels. In particular, a privilege can be
  used to endorse an otherwise untrustworthy labeled <a data-link-type="dfn">context</a> (or <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects②">labeled object</a>) as to allow it to
  communicate with more trustworthy end-points (another context or
  server).</p>
      <div class="example" id="example-eef05327">
       <a class="self-link" href="#example-eef05327"></a> Consider an <code>https://a.com</code> context whose <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label">current integrity label</a> is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②⓪">Label</a>("https://a.com").or("https://b.com")</code>.
    This label confines the context to only communicating with
    entities that are at most as trustworthy as this
    label. For example, it restricts the context from
    communicating with a context whose <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label①">current integrity
    label</a> is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②①">Label</a>("https://a.com")</code>, since doing
    so would potentially corrupt <code>https://a.com</code> data
    (e.g., by allowing <code>https://b.com</code> to influence the
    computation). 
       <p>But, if the context’s <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①">current privilege</a> corresponds
    to <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②②">Label</a>("https://a.com")</code>, the
    context would be able to bypass some of these integrity restrictions.
    Specifically, the context would be able to communicate with the
    more-trustworthy context (labeled <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②③">Label</a>("https://a.com")</code>) since the
    privilege confers it the right to endorse (or vouch for) its
    context on behalf of <code>https://a.com</code>. Indeed, when
    taking privileges into account, the <a data-link-type="dfn" href="#effective-integrity-label" id="ref-for-effective-integrity-label">effective integrity
    label</a> of the context is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②④">Label</a>("https://a.com")</code>.</p>
       <p class="note" role="note"><span>Note,</span> the privilege cannot be used to bypass any integrity
    restrictions.  For example, it does not allow the context to
    communicate with a context whose integrity label is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②⑤">Label</a>("https://b.com")</code>.</p>
      </div>
      <p class="note" role="note"><span>Note,</span> <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#windows" id="ref-for-windows">browsing contexts</a> have a <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege②">current privilege</a> that, by default, corresponds to the origin of the context, as
  described in <a href="#framework-context-labels">§3.3 Labeled Contexts</a>. But, authors should set the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege③">current
  privilege</a> to a <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege⑥">delegated privilege</a> to follow
  the principle of least privilege.</p>
     <li data-md="">
      <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="current-privilege">current privilege</dfn> is the privilege associated
  with the current context. <a href="#framework-context-labels">§3.3 Labeled Contexts</a> specifies how
  privileges are associated with contexts.</p>
     <li data-md="">
      <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="effective-confidentiality-label">effective confidentiality label</dfn> is the label
  returned by the <a data-link-type="dfn" href="#label-downgrade" id="ref-for-label-downgrade">label downgrade</a> algorithm when invoked
  with the <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label①">current confidentiality label</a> and <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege④">current
  privilege</a>.</p>
     <li data-md="">
      <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="effective-integrity-label">effective integrity label</dfn> is the label
  returned by the <a data-link-type="dfn" href="#label-upgrade" id="ref-for-label-upgrade">label upgrade</a> algorithm when invoked
  with the <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label②">current integrity label</a> and <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege⑤">current
  privilege</a>.</p>
     <li data-md="">
      <p>Code can take <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ownership">ownership</dfn> of a <a data-link-type="dfn" href="#privilege" id="ref-for-privilege③">privilege</a> <var>priv</var> by setting the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege⑥">current privilege</a> to the
  privilege produced via the <a data-link-type="dfn" href="#combination" id="ref-for-combination">combination</a> of the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege⑦">current
    privilege</a> and <var>priv</var>. In doing so, it is said
  that the context <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="owns">owns</dfn> the privilege.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="framework"><span class="secno">3. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
    <p><em>This sub-section is not normative.</em></p>
    <p>In a nut-shell, the COWL framework provides:</p>
    <dl>
     <dt>Policy specification via <a data-link-type="dfn" href="#label" id="ref-for-label⑨">labels</a>
     <dd> COWL provides a <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②⑥">Label</a> interface for specifying
        confidentiality and integrity policies in terms of <a data-link-type="dfn" href="#principal" id="ref-for-principal①">principals</a> (typically, <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2⑤">origins</a>). <a data-link-type="dfn" href="#label" id="ref-for-label①⓪">Labels</a> can be
        associated with data and content using the JavaScript <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②">LabeledObject</a> and <a class="idl-code" data-link-type="interface" href="#cowl" id="ref-for-cowl">COWL</a> interfaces or the <code>Sec-COWL</code> HTTP header field. 
     <dt>Explicit authority via <a data-link-type="dfn" href="#privilege" id="ref-for-privilege④">privileges</a>
     <dd> The COWL framework provides a JavaScript <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①">Privilege</a> interface for operating on and minting
        new <a data-link-type="dfn" href="#privilege" id="ref-for-privilege⑤">privileges</a>.  The <a class="idl-code" data-link-type="interface" href="#cowl" id="ref-for-cowl①">COWL</a> JavaScript
        interface and <code>Sec-COWL</code> HTTP response header can be
        used to explicitly control the authority of a context by setting
        the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege③">context privilege</a>. 
     <dt>Confinement enforcement mechanism
     <dd> COWL extends <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#windows" id="ref-for-windows①">browsing contexts</a>, in particular <a data-link-type="dfn" href="https://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element①">iframes</a> with labels and privileges, which are used when enforcing confinement,
        i.e., when restricting a context’s network and cross-context messaging
        communication.  This document defines the necessary changes and
        extensions to existing browser constructs and algorithms to enforce
        confinement. 
    </dl>
    <section>
     <h3 class="heading settled" data-level="3.1" id="framework-labels"><span class="secno">3.1. </span><span class="content">Labels</span><a class="self-link" href="#framework-labels"></a></h3>
     <p>Each <a data-link-type="dfn" href="#label" id="ref-for-label①①">label</a> is an immutable object represented by a <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②⑦">Label</a> object, the interface of which is defined in
    this section.</p>
     <p>A <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①②⑧">Label</a> MUST have an internal <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label-set">label set</dfn>, which is
    a non-empty set of <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set">disjunction set</a>s.</p>
     <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="disjunction-set">disjunction set</dfn> is a set of <a data-link-type="dfn" href="#principal" id="ref-for-principal②">principals</a>.</p>
     <p>A label is said to be an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="empty-label">empty label</dfn> if its <a data-link-type="dfn" href="#label-set" id="ref-for-label-set">label
      set</a> contains a single, empty <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set①">disjunction set</a>.</p>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-label-label" id="ref-for-dom-label-label">Constructor</a>, <a class="nv idl-code" data-link-type="constructor" href="#dom-label-label-principal" id="ref-for-dom-label-label-principal">Constructor</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><span class="kt">DOMString</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Label/Label(principal)" data-dfn-type="argument" data-export="" id="dom-label-label-principal-principal"><code>principal</code></dfn>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed">Exposed</a>=(<span class="n">Window</span>, <span class="n">Worker</span>)]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="label①"><code>Label</code></dfn> {
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean"><span class="kt">boolean</span></a> <a class="nv idl-code" data-link-type="method" href="#dom-label-equals" id="ref-for-dom-label-equals">equals</a>(<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①②⑨">Label</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Label/equals(other)" data-dfn-type="argument" data-export="" id="dom-label-equals-other-other"><code>other</code></dfn>);
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean①"><span class="kt">boolean</span></a> <a class="nv idl-code" data-link-type="method" href="#dom-label-subsumes" id="ref-for-dom-label-subsumes">subsumes</a>(<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③⓪">Label</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Label/subsumes(other, priv), Label/subsumes(other)" data-dfn-type="argument" data-export="" id="dom-label-subsumes-other-priv-other"><code>other</code></dfn>, <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①③">Privilege</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Label/subsumes(other, priv), Label/subsumes(other)" data-dfn-type="argument" data-export="" id="dom-label-subsumes-other-priv-priv"><code>priv</code></dfn>);

  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③①">Label</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="and(other)" id="dom-label-and"><code>and</code></dfn>((<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③②">Label</a> <span class="kt">or</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><span class="kt">DOMString</span></a>) <dfn class="nv dfn-paneled idl-code" data-dfn-for="Label/and(other)" data-dfn-type="argument" data-export="" id="dom-label-and-other-other"><code>other</code></dfn>);
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③③">Label</a> <dfn class="nv idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="_or(other)" id="dom-label-_or"><code>_or</code><a class="self-link" href="#dom-label-_or"></a></dfn>((<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③④">Label</a> <span class="kt">or</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②"><span class="kt">DOMString</span></a>) <dfn class="nv dfn-paneled idl-code" data-dfn-for="Label/_or(other)" data-dfn-type="argument" data-export="" id="dom-label-_or-other-other"><code>other</code></dfn>);

  <a class="kt" data-link-type="dfn" href="#label-stringification-behavior" id="ref-for-label-stringification-behavior">stringifier</a>;
};
</pre>
     <h4 class="heading settled" data-level="3.1.1" id="label-constructors"><span class="secno">3.1.1. </span><span class="content">Constructors</span><a class="self-link" href="#label-constructors"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Label" data-dfn-type="constructor" data-export="" id="dom-label-label"><code>Label()</code></dfn>
      <dd> When invoking the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label①">Label()</a> constructor, the user agent
        MUST return a new <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label">empty label</a>. 
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Label" data-dfn-type="constructor" data-export="" data-lt="Label(principal)" id="dom-label-label-principal"><code>Label(DOMString principal)</code></dfn>
      <dd>
        When invoking the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label②">Label(principal)</a> constructor, the user agent
        MUST use an algorithm equivalent to the following: 
       <ol>
        <li data-md="">
         <p>If the <a class="idl-code" data-link-type="argument" href="#dom-label-label-principal-principal" id="ref-for-dom-label-label-principal-principal">principal</a> argument is not a <a data-link-type="dfn" href="#principal" id="ref-for-principal③">principal</a>, the constructor MUST throw a <code>TypeError</code> exception <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a> and
 terminate this algorithm.</p>
        <li data-md="">
         <p>Else, it MUST return a new <a data-link-type="dfn" href="#label" id="ref-for-label①②">Label</a> that contains a <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①">label set</a> of a single <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set②">disjunction set</a>, which
 itself MUST contain the <a data-link-type="dfn" href="#principal" id="ref-for-principal④">principal</a> corresponding to the <a class="idl-code" data-link-type="argument" href="#dom-label-label-principal-principal" id="ref-for-dom-label-label-principal-principal①">principal</a> argument.</p>
       </ol>
     </dl>
     <h4 class="heading settled" data-level="3.1.2" id="label-methods"><span class="secno">3.1.2. </span><span class="content">Methods</span><a class="self-link" href="#label-methods"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="equals(other)" id="dom-label-equals" title="equals(other)"><code>equals(Label other)</code></dfn>
      <dd> The user agent MUST return <code>true</code> if the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①③⑤">Label</a> on
        which the method has been called is <a data-link-type="dfn" href="#equivalent" id="ref-for-equivalent">equivalent</a> to the <a class="idl-code" data-link-type="argument" href="#dom-label-equals-other-other" id="ref-for-dom-label-equals-other-other">other</a> parameter; otherwise it MUST return <code>false</code>. 
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="subsumes(other, priv)|subsumes(other)" id="dom-label-subsumes" title="subsumes(other, priv)"><code>subsumes(Label other, optional Privilege priv)</code></dfn>
      <dd>
        The user agent MUST use an algorithm equivalent to the
        following: 
       <ol>
        <li data-md="">
         <p>Let <var>lab</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label①③">Label</a> on which the method
 has been called.</p>
        <li data-md="">
         <p>If the <a class="idl-code" data-link-type="argument" href="#dom-label-subsumes-other-priv-priv" id="ref-for-dom-label-subsumes-other-priv-priv">priv</a> argument is
 provided, let <var>lab</var> be <code><var>lab</var>.and(priv.<a data-link-type="functionish" href="#dom-privilege-aslabel" id="ref-for-dom-privilege-aslabel">asLabel()</a>)</code>.</p>
        <li data-md="">
         <p>Return <code>true</code> if <var>lab</var> <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes">subsumes</a> the <a class="idl-code" data-link-type="argument" href="#dom-label-subsumes-other-priv-other" id="ref-for-dom-label-subsumes-other-priv-other">other</a> parameter and <code>false</code> otherwise.</p>
       </ol>
      <dt><dfn class="idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" id="dom-label-and-label-or-domstring-other" title="and(other)"><code>and((Label or DOMString) other)</code><a class="self-link" href="#dom-label-and-label-or-domstring-other"></a></dfn>
      <dd>
        The user agent MUST use an algorithm equivalent to the following: 
       <ol>
        <li data-md="">
         <p>Let <var>O</var> be the <a class="idl-code" data-link-type="argument" href="#dom-label-and-other-other" id="ref-for-dom-label-and-other-other">other</a> argument.</p>
        <li data-md="">
         <p>If the type of <a class="idl-code" data-link-type="argument" href="#dom-label-and-other-other" id="ref-for-dom-label-and-other-other①">other</a> is <code>DOMString</code>, run the following sub-steps:</p>
         <ol>
          <li data-md="">
           <p>Set <var>O</var> to the result of invoking the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label③">Label(other)</a> constructor with <a class="idl-code" data-link-type="argument" href="#dom-label-and-other-other" id="ref-for-dom-label-and-other-other②">other</a> as an argument, if the
  constructor did not raise an exception.</p>
          <li data-md="">
           <p>Else, re-throw the exception and terminate this algorithm.</p>
         </ol>
        <li data-md="">
         <p>Return a new <a data-link-type="dfn" href="#normal-form" id="ref-for-normal-form②">normal form</a> <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①③⑥">Label</a> that is <a data-link-type="dfn" href="#equivalent" id="ref-for-equivalent①">equivalent</a> to a label whose <a data-link-type="dfn" href="#label-set" id="ref-for-label-set②">label set</a> contains the <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set③">disjunction sets</a> of <var>O</var> and the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①③⑦">Label</a> on which
 the method was invoked.</p>
       </ol>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" id="dom-label-or" title="or(other)"><code>or((Label or DOMString) other)</code></dfn>
      <dd>
        The user agent MUST use an algorithm equivalent to the following: 
       <ol>
        <li data-md="">
         <p>Let <var>O</var> be the <a class="idl-code" data-link-type="argument" href="#dom-label-and-other-other" id="ref-for-dom-label-and-other-other③">other</a> argument.</p>
        <li data-md="">
         <p>If the type of <a class="idl-code" data-link-type="argument" href="#dom-label-_or-other-other" id="ref-for-dom-label-_or-other-other">other</a> is <code>DOMString</code>, run the following sub-steps:</p>
         <ol>
          <li data-md="">
           <p>Set <var>O</var> to the result of invoking the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label④">Label(other)</a> constructor with <a class="idl-code" data-link-type="argument" href="#dom-label-_or-other-other" id="ref-for-dom-label-_or-other-other①">other</a> as an argument, if the
  constructor did not raise an exception.</p>
          <li data-md="">
           <p>Else, re-throw the exception and terminate this algorithm.</p>
         </ol>
        <li data-md="">
         <p>Return a new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①③⑧">Label</a>, in <a data-link-type="dfn" href="#normal-form" id="ref-for-normal-form③">normal form</a>,
 which is <a data-link-type="dfn" href="#equivalent" id="ref-for-equivalent②">equivalent</a> to adding each element of each <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set④">disjunction set</a> of <var>O</var>’s <a data-link-type="dfn" href="#label-set" id="ref-for-label-set③">label set</a> to
 each <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set⑤">disjunction set</a> of the <a data-link-type="dfn" href="#label-set" id="ref-for-label-set④">label set</a> of the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①③⑨">Label</a> on which the method was called.</p>
       </ol>
     </dl>
     <h4 class="heading settled" data-level="3.1.3" id="label-stringifer"><span class="secno">3.1.3. </span><span class="content">Serializing labels</span><a class="self-link" href="#label-stringifer"></a></h4>
     <p>The <dfn class="dfn-paneled" data-dfn-for="Label" data-dfn-type="dfn" data-noexport="" id="label-stringification-behavior">stringification behavior</dfn> MUST return the
      serialization of the label, which adheres to the <a data-link-type="dfn" href="#label-expression" id="ref-for-label-expression">label-expression</a> grammar, using an algorithm equivalent to the following:</p>
     <ol>
      <li data-md="">
       <p>Let <var>label</var> be the label being serialized.</p>
      <li data-md="">
       <p>If <var>label</var> is the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label②">empty label</a>, return <code>"'none'"</code> and
 terminate this algorithm.</p>
      <li data-md="">
       <p>Let <var>result</var> be the empty string.</p>
      <li data-md="">
       <p>For each element <var>dset</var> in the <var>label</var>’s <a data-link-type="dfn" href="#label-set" id="ref-for-label-set⑤">label set</a>:</p>
       <ol>
        <li data-md="">
         <p>If <var>result</var> is not the empty string, append the characters <code>" AND "</code> to it.</p>
        <li data-md="">
         <p>If the number of elements in <var>dset</var> is greater than 1:</p>
         <ol>
          <li data-md="">
           <p>Append the character "(" (U+0028) to <var>result</var>.</p>
          <li data-md="">
           <p>Append the character  " " (U+0020) to <var>result</var>.</p>
         </ol>
        <li data-md="">
         <p>Let <var>o</var> be the empty string.</p>
        <li data-md="">
         <p>For each element <var>prin</var> in the <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set⑥">disjunction set</a> <var>dset</var>:</p>
         <ol>
          <li data-md="">
           <p>If <var>o</var> is not the empty string, append the characters <code>" OR "</code> to it.</p>
          <li data-md="">
           <p>Append <var>prin</var> to <var>o</var>.</p>
         </ol>
        <li data-md="">
         <p>Append <var>o</var> to <var>result</var>.</p>
        <li data-md="">
         <p>If the number of elements in <var>dset</var> is greater than 1:</p>
         <ol>
          <li data-md="">
           <p>Append the character  " " (U+0020) to <var>result</var>.</p>
          <li data-md="">
           <p>Append the character  ")" (U+0029) to <var>result</var>.</p>
         </ol>
       </ol>
     </ol>
     <h4 class="heading settled" data-level="3.1.4" id="label-examples"><span class="secno">3.1.4. </span><span class="content">Examples</span><a class="self-link" href="#label-examples"></a></h4>
     <div class="example" id="example-61f87694">
      <a class="self-link" href="#example-61f87694"></a> Example labels. Intuition for each label’s semantics is given in
      the context of it being used as a confidentiality label (C) and
      integrity label (I). 
<pre><code>// C: Public data.
// I: Non-endorsed/untrustworthy data.
var empty = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④⓪">Label</a>();

// C: Data confidential to a.com.
// I: Data endorsed/trusted by a.com.
var a = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④①">Label</a>("https://a.com");

// C: Data confidential to b.com.
// I: Data endorsed/trusted by b.com.
var a = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④②">Label</a>("https://b.com");

// C: Data confidential to both a.com and b.com
// I: Data endorsed/trusted by a.com and b.com.
var aANDb = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④③">Label</a>("https://a.com").and("https://b.com");

// C: Data confidential to either a.com or b.com.
// I: Data endorsed/trusted by either a.com or b.com.
var aORb = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④④">Label</a>("https://a.com").or("https://b.com");
</code></pre>
      <p>Examples of label comparisons with intuition for the semantics.</p>
<pre><code>// C: Data confidential to a.com (b.com) data is more sensitive than public data.
// I: Data endorsed by a.com (b.com) is more trustworthy than non-endorsed/untrustworthy data.
a.subsumes(empty) === true;
b.subsumes(empty) === true;

// C: Data that is confidential to a.com and b.com is more
//    confidential than data that is only sensitive to a.com (b.com).
// I: Data that is endorsed/trusted by both a.com and b.com is
//    more trustworthy than data endorsed only by a.com (b.com).
aANDb.subsumes(a) === true;
aANDb.subsumes(b) === true;

// C: Data that that is confidential to a.com (b.com) is not comparable to
//    data that is confidential to b.com (a.com).
// I: Data that that is endorsed by a.com (b.com) is not comparable to
//    data that is endorsed by b.com (a.com).
a.subsumes(b) === false;
b.subsumes(a) === false;

// C: Data that is confidential to a.com (b.com) is more confidential than data that is
//    confidential to either a.com or b.com. Alternative intuition: data that can be read by
//    a.com or b.com can be read by an entity that can read a.com (b.com) data alone.
// I: Data that is endorsed by a.com (b.com) is more trustworthy than data that is endorsed
//    by either a.com or b.com. Alternative intuition: an entity that trusts data endorsed
//    by either a.com or b.com necessarily trusts data endorsed by a.com (b.com) alone.
a.subsumes(aOrb) === true;
b.subsumes(aOrb) === true;
</code></pre>
     </div>
     <div class="example" id="example-be14d9a3">
      <a class="self-link" href="#example-be14d9a3"></a> Using the labels defined in the above example, this example shows how
      labels are serialized. We only define an additional label: 
<pre><code>var aORbANDc = aORb.and(new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④⑤">Label</a>("https://c.com");
</code></pre>
      <p>Converting to string:</p>
<pre><code>empty.toString()    === "'none'";
a.toString()        === "https://a.com";
aANDb.toString()    === "(https://a.com) AND (https://b.com)";
aORb.toString()     === "https://a.com OR https://b.com";
aORbANDc.toString() === "(https://a.com OR https://b.com) AND (https://c.com)";
</code></pre>
     </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.2" id="privileges"><span class="secno">3.2. </span><span class="content">Privileges</span><a class="self-link" href="#privileges"></a></h3>
     <p>Each <a data-link-type="dfn" href="#privilege" id="ref-for-privilege⑥">privilege</a> is an immutable object represented by a <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①④">Privilege</a> object, the interface of which is
    defined in this section.</p>
     <p>A <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①⑤">Privilege</a> MUST have an <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="internal privilege label" data-noexport="" id="internal-privilege-label">internal privilege
    label</dfn>.</p>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="combination">combination</dfn> of privileges <var>A</var> and <var>B</var> is a privilege produced by invoking the <a data-link-type="functionish" href="#dom-privilege-combine" id="ref-for-dom-privilege-combine">combine()</a> method on <var>A</var> (respectively, <var>B</var>) with <var>B</var> (respectively, <var>A</var>) as an
    argument.</p>
     <p>A privilege is said to be an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="empty-privilege">empty privilege</dfn> if its <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①">internal privilege label</a> is the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label③">empty label</a>. A
    context is said to be <dfn data-dfn-type="dfn" data-noexport="" id="unprivileged">unprivileged<a class="self-link" href="#unprivileged"></a></dfn> if its context
    privilege is the <a data-link-type="dfn" href="#empty-privilege" id="ref-for-empty-privilege③">empty privilege</a>.  By setting the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege④">context privilege</a> to the <a data-link-type="dfn" href="#empty-privilege" id="ref-for-empty-privilege④">empty privilege</a>, a context
    is said to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="dropping-privileges">dropping privileges</dfn>.</p>
     <p>A privilege <var>P1</var> is said to be a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="delegated privilege" data-noexport="" id="delegated-privilege">delegated
    privilege</dfn> of <var>P2</var> if <var>P2</var>’s <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label②">internal
    privilege label</a> <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes①">subsumes</a> <var>P1</var>’s <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label③">internal
    privilege label</a>.</p>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-privilege-privilege" id="ref-for-dom-privilege-privilege①">Constructor</a>, <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①">Exposed</a>=(<span class="n">Window</span>, <span class="n">Worker</span>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext">SecureContext</a>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="privilege①"><code>Privilege</code></dfn> {
  <span class="kt">static</span> <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑥">Privilege</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-freshprivilege" id="ref-for-dom-privilege-freshprivilege">FreshPrivilege</a>(); // Named constructor
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①④⑥">Label</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-aslabel" id="ref-for-dom-privilege-aslabel①">asLabel</a>();

  <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑦">Privilege</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-combine" id="ref-for-dom-privilege-combine①">combine</a>(<a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑧">Privilege</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Privilege/combine(other)" data-dfn-type="argument" data-export="" id="dom-privilege-combine-other-other"><code>other</code></dfn>);
  [<a class="nv idl-code" data-link-type="extended-attribute">Throws</a>] <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑨">Privilege</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-delegate" id="ref-for-dom-privilege-delegate">delegate</a>(<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①④⑦">Label</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Privilege/delegate(label)" data-dfn-type="argument" data-export="" id="dom-privilege-delegate-label-label"><code>label</code></dfn>);
};
</pre>
     <h4 class="heading settled" data-level="3.2.1" id="privilege-constructors"><span class="secno">3.2.1. </span><span class="content">Constructors</span><a class="self-link" href="#privilege-constructors"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Privilege" data-dfn-type="constructor" data-export="" id="dom-privilege-privilege"><code>Privilege()</code></dfn>
      <dd> When invoking the <a data-link-type="functionish" href="#dom-privilege-privilege" id="ref-for-dom-privilege-privilege②">Privilege()</a> constructor, the user
        agent MUST return a new <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①⓪">Privilege</a> that has its <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label④">internal privilege label</a> set to the <a data-link-type="dfn" href="#empty-label①" id="ref-for-empty-label①">empty-label</a>. 
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Privilege" data-dfn-type="method" data-export="" id="dom-privilege-freshprivilege" title="FreshPrivilege()"><code>FreshPrivilege()</code></dfn>
      <dd>
       <p>When invoking the <a data-link-type="functionish" href="#dom-privilege-freshprivilege" id="ref-for-dom-privilege-freshprivilege①">FreshPrivilege()</a> constructor, the user
        agent MUST use an algorithm equivalent to the following:</p>
       <ol>
        <li data-md="">
         <p>Let <var>unique principal</var> be a freshly generated <a data-link-type="dfn" href="#unique-principal" id="ref-for-unique-principal①">unique principal</a>.</p>
        <li data-md="">
         <p>Let <var>unique label</var> be the label produced by invoking the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label⑤">Label(principal)</a> constructor with <var>unique principal</var>.</p>
        <li data-md="">
         <p>Return a new <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①①">Privilege</a> that has an <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label⑤">internal privilege label</a> set to <var>unique label</var>.</p>
       </ol>
     </dl>
     <h4 class="heading settled" data-level="3.2.2" id="privilege-methods"><span class="secno">3.2.2. </span><span class="content">Methods</span><a class="self-link" href="#privilege-methods"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Privilege" data-dfn-type="method" data-export="" id="dom-privilege-aslabel" title="asLabel()"><code>asLabel()</code></dfn>
      <dd> The user agent MUST return the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label⑥">internal privilege label</a> of the <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①②">Privilege</a> on which the method has been called. 
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Privilege" data-dfn-type="method" data-export="" data-lt="combine(other)" id="dom-privilege-combine" title="combine(other)"><code>combine(Privilege other)</code></dfn>
      <dd>
       <p>The user agent MUST return a new <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①③">Privilege</a> whose <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label⑦">internal
        privilege label</a> is <a data-link-type="dfn" href="#equivalent" id="ref-for-equivalent③">equivalent</a> to a <a data-link-type="dfn" href="#label" id="ref-for-label①④">label</a> created according to an algorithm equivalent to the following:</p>
       <ol>
        <li data-md="">
         <p>Let <var>internalLabel</var> be the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label⑧">internal privilege label</a> of the <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①④">Privilege</a> on which the method has been called.</p>
        <li data-md="">
         <p>Let <var>otherLabel</var> be the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label⑨">internal privilege label</a> of
 the <a class="idl-code" data-link-type="argument" href="#dom-privilege-combine-other-other" id="ref-for-dom-privilege-combine-other-other">other</a> argument.</p>
        <li data-md="">
         <p>Return <code><var>internalLabel</var>.<a data-link-type="functionish" href="#dom-label-and" id="ref-for-dom-label-and">and(<var>otherLabel</var>)</a></code>.</p>
       </ol>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Privilege" data-dfn-type="method" data-export="" data-lt="delegate(label)" id="dom-privilege-delegate" title="delegate(label)"><code>delegate(Label label)</code></dfn>
      <dd>
       <p>The user agent MUST return a new <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①⑤">Privilege</a> whose <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①⓪">internal
        privilege label</a> is <a data-link-type="dfn" href="#equivalent" id="ref-for-equivalent④">equivalent</a> to a <a data-link-type="dfn" href="#label" id="ref-for-label①⑤">label</a> created according to an algorithm equivalent to the following:</p>
       <ol>
        <li data-md="">
         <p>Let <var>internalLabel</var> be the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①①">internal privilege label</a> of the <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①⑥">Privilege</a> on which the method has been called.</p>
        <li data-md="">
         <p>If the <var>internalLabel</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes②">subsume</a> the <a class="idl-code" data-link-type="argument" href="#dom-privilege-delegate-label-label" id="ref-for-dom-privilege-delegate-label-label">label</a> argument, throw a <code>SecurityError</code> exception and terminate this algorithm.</p>
        <li data-md="">
         <p>Else, return a new <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①⑦">Privilege</a> that has an <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①②">internal privilege label</a> set to <a class="idl-code" data-link-type="argument" href="#dom-privilege-delegate-label-label" id="ref-for-dom-privilege-delegate-label-label①">label</a>.</p>
       </ol>
     </dl>
     <div class="note" role="note"> Note, the <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①①⑧">Privilege</a> constructors and the <a data-link-type="functionish" href="#dom-privilege-combine" id="ref-for-dom-privilege-combine②">combine()</a> and <a data-link-type="functionish" href="#dom-privilege-delegate" id="ref-for-dom-privilege-delegate①">delegate()</a> methods only provide ways
      for creating privileges.  Context code must still take <a data-link-type="dfn" href="#ownership" id="ref-for-ownership">ownership</a> of or set the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege⑧">current privilege</a> to the
      privilege for it to be used (to bypass label restrictions). </div>
     <h4 class="heading settled" data-level="3.2.3" id="privilege-examples"><span class="secno">3.2.3. </span><span class="content">Examples</span><a class="self-link" href="#privilege-examples"></a></h4>
     <div class="example" id="example-e2ef9092">
      <a class="self-link" href="#example-e2ef9092"></a> To be backwards-compatible with the Same-Origin Policy, COWL
      grants each <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#windows" id="ref-for-windows②">browsing context</a> a <a data-link-type="dfn" href="#default-privilege" id="ref-for-default-privilege①">default privilege</a> that corresponds to their origin. For example, a page on <code>https://example.com</code> has a privilege whose <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①③">internal
      privilege label</a> is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④⑧">Label</a>("https://example.com")</code>. 
      <p>As a result, reading data that is sensitive to <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①④⑨">Label</a>("https://example.com")</code> does
      not confine the context. For example, reading a <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects③">labeled object</a> whose confidentiality label is <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑤⓪">Label</a>("https://example.com")</code> does
      not restrict the context from communicating—and thus
      accidentally leaking that object’s contents—to another origin.
      To prevent accidental leaks, the author should drop privileges by
      setting the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege⑨">current privilege</a> to an <a data-link-type="dfn" href="#empty-privilege" id="ref-for-empty-privilege⑤">empty
      privilege</a>:</p>
<pre><code>// Save privilege in case we need it later:
var __savedPriv = COWL.privilege;

// Drop privilege (set the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege⑤">context privilege</a> to the <a data-link-type="dfn" href="#empty-privilege" id="ref-for-empty-privilege⑥">empty privilege</a>):
COWL.privilege = new <a data-link-type="dfn" href="#privilege" id="ref-for-privilege⑦">Privilege</a>();
</code></pre>
      <p>After this point, if the context reads data with a <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑤①">Label</a>("https://example.com")</code> confidentiality label, COWL will restrict it to communicating
      with <code>https://example.com</code>.</p>
     </div>
     <div class="example" id="example-69e8fe9b">
      <a class="self-link" href="#example-69e8fe9b"></a> Consider an extension to the password strength checker example of <a href="#examples-checker">§1.2.1 Confining untrusted third-party services</a> that uses <a data-link-type="functionish" href="#dom-privilege-freshprivilege" id="ref-for-dom-privilege-freshprivilege②">FreshPrivilege()</a>s to
      ensure that the untrusted checker cannot communicate with any
      entity other than the parent context. 
<pre><code>// Create new fresh privilege:
var priv = new <a data-link-type="functionish" href="#dom-privilege-freshprivilege" id="ref-for-dom-privilege-freshprivilege③">FreshPrivilege()</a>;

// Take <a data-link-type="dfn" href="#ownership" id="ref-for-ownership①">ownership</a> of the fresh privilege:
COWL.privilege = COWL.privilege.combine(priv);

// Associate the unique label with the password:
var labeledPassword = new <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject③">LabeledObject</a>(password, {confidentiality: priv.asLabel()});

// Send the labeled password to the checker iframe:
checker.postMessage(labeledPassword, "https://untrusted.com");
</code></pre>
      <p>Once the <code>https://untrusted.com</code> <a data-link-type="dfn">cowl iframe</a> reads the
      password it will be <a data-link-type="dfn" href="#tainted" id="ref-for-tainted">tainted</a> by the unique, <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①④">internal
      privilege label</a> of <code>priv</code>; the unique origin
      ensures that it cannot send the password to, for example, public
      parts of <code>https://example.com</code>. Indeed, only the
      owner of <code>priv</code> can disseminate the labeled password
      (result) arbitrarily.</p>
     </div>
     <div class="example" id="university-example-js">
      <a class="self-link" href="#university-example-js"></a> Consider an implementation of the content isolation example of <a href="#examples-isolation">§1.2.3 Content isolation via privilege separation</a> using the COWL JavaScript API.
      In this example, the author <code>https://university.edu</code> isolates
      different parts of their site according to
      users. For <code>user1</code> it can do this as follows: 
<pre><code>// Create a label corresponding to the university origin:
var uni = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑤②">Label</a>(window.location.origin);
// Create a new label that corresponds to user1’s data on university.edu:
var user1 = uni.or("app:user1"); // Here the app:user1 is an application-specific princial

// Originally, COWL.privilege.asLabel().equals(uni).
// Drop the current <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege⑥">context privilege</a> to a delegated privilege:
COWL.privilege = COWL.privilege.delegate(user1);
</code></pre>
      <p>At this point, the context can only arbitrarily disseminate data
      that is labeled <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑤③">Label</a>("https://university.edu").or("app:user1")</code>;
      it cannot disseminate data that is
      sensitive to the university (e.g., which is labeled <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑤④">Label</a>("https://university.edu")</code>)
      or to another user (e.g., <code>user2</code>’s data is
      labeled <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑤⑤">Label</a>("https://university.edu").or("app:user2")</code>).</p>
     </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.3" id="framework-context-labels"><span class="secno">3.3. </span><span class="content">Labeled Contexts</span><a class="self-link" href="#framework-context-labels"></a></h3>
     <p>COWL extends <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#windows" id="ref-for-windows③">browsing contexts</a> with a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="cowl-state">COWL state</dfn>, which
    is used to restrict the context’s communication channels.  The COWL state
    consists of:</p>
     <ul>
      <li data-md="">
       <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="confinement-mode">confinement mode</dfn> status, which indicates whether
or not COWL confinement is enabled and thus <a data-link-type="dfn" href="#label" id="ref-for-label①⑥">labels</a> should
be enforced in the current context.</p>
       <p>A context is considered a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="confined-context">confined context</dfn> if its <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode">confinement mode</a> status is set, and a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="unconfined context" data-noexport="" id="unconfined-context">unconfined
context</dfn> otherwise.</p>
       <p class="note" role="note"><span>Note:</span> confinement mode is currently only be enabled for contexts
instantiated in <a data-link-type="dfn">cowl iframes</a>.  In future versions we may
generalize the enforcement to other <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#windows" id="ref-for-windows④">browsing contexts</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/workers/#worker" id="ref-for-worker">Workers</a>.</p>
      <li data-md="">
       <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="context-labels">context <a data-link-type="dfn" href="#label" id="ref-for-label①⑦">labels</a></dfn>, which consist of:</p>
       <ul>
        <li data-md="">
         <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="context-confidentiality-label">context confidentiality label</dfn> reflects the
sensitivity of the data that the context has read.</p>
        <li data-md="">
         <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="context-integrity-label">context integrity label</dfn> reflects the integrity of
the data that the context has read.</p>
       </ul>
      <li data-md="">
       <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="context-privilege">context <a data-link-type="dfn" href="#privilege" id="ref-for-privilege⑧">privilege</a></dfn>, which encodes the context’s
ability to bypass the restrictions of certain labels.</p>
     </ul>
     <p>Each context’s <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state">COWL state</a> MUST be initially set to the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="default-cowl-state">default COWL state</dfn>, where:</p>
     <ul>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode①">confinement mode</a> is disabled.</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label">context confidentiality label</a> is set to the <dfn data-dfn-type="dfn" data-noexport="" id="default-confidentiality-label">default confidentiality label<a class="self-link" href="#default-confidentiality-label"></a></dfn>: <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label④">empty label</a>.</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label">context integrity label</a> is set to the <dfn data-dfn-type="dfn" data-noexport="" id="default-integrity-label">default integrity label<a class="self-link" href="#default-integrity-label"></a></dfn>: <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label⑤">empty label</a>.</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege⑦">context privilege</a> is set to the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="default-privilege">default privilege</dfn>: a <a data-link-type="dfn" href="#privilege" id="ref-for-privilege⑨">privilege</a> whose <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①⑤">internal privilege label</a> is
equivalent to <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label⑥">Label(<var>origin</var>)</a>, where <var>origin</var> is the string representation of the context or
Worker’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2⑥">origin</a>.</p>
     </ul>
     <div class="note" role="note">
       The <a data-link-type="dfn" href="#default-cowl-state" id="ref-for-default-cowl-state">default COWL state</a> is backwards-compatible with the
      existing Web model. Specifically: 
      <ul>
       <li data-md="">
        <p>Unless <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode②">confinement mode</a> is enabled, a context is not
subject to confinement.</p>
       <li data-md="">
        <p>Unless the <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label②">current confidentiality label</a> and the <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label③">current integrity label</a> are
non-<a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label⑥">empty label</a>s, the context’s communication
is unrestricted; code is only
subject to the restrictions imposed by other mechanisms such as
the Same-Origin Policy and CSP.</p>
       <li data-md="">
        <p>Unless the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①⓪">current privilege</a> is dropped or set to a <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege⑦">delegated privilege</a>, code can disseminate data sensitive
to the browsing context’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2⑦">origin</a>, even when <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode③">confinement
mode</a> is enabled.  Such data is implicitly <em>declassified</em> using the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege⑧">context privilege</a>. Authors should send <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject④">LabeledObject</a>s to explicitly communicate the
sensitivity (and integrity) of the data they are sharing.</p>
      </ul>
     </div>
     <p>COWL restricts the code running in a <a data-link-type="dfn" href="#confined-context" id="ref-for-confined-context">confined context</a> from
    communicating with other contexts or remote servers in a way that preserves
    confidentiality and integrity (see <a href="#enforcement">§3.7 Confinement Enforcement</a>).</p>
     <p>In general, COWL does not restrict code running in <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context">unconfined
    contexts</a> from communicating with other <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context①">unconfined contexts</a> or
    remote servers.  To preserve this invariant COWL does, however, prevent
    such code from reading overly sensitive data (i.e., data that would <a data-link-type="dfn" href="#tainted" id="ref-for-tainted①">taint</a> the context) or communicating with certain <a data-link-type="dfn" href="#confined-context" id="ref-for-confined-context①">confined
    contexts</a> and COWL-enabled servers.</p>
     <p class="note" role="note"><span>Note:</span> the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state①">COWL state</a> of an <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context②">unconfined context</a> does not change
    from its original <a data-link-type="dfn" href="#default-cowl-state" id="ref-for-default-cowl-state①">default COWL state</a>.</p>
     <p>The <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state②">COWL state</a> is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-exposed" id="ref-for-dfn-exposed">exposed</a> to <a data-link-type="dfn" href="#confined-context" id="ref-for-confined-context②">confined contexts</a> via the <a class="idl-code" data-link-type="interface" href="#cowl" id="ref-for-cowl②">COWL</a> interface defined below.  This interface MUST not be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-exposed" id="ref-for-dfn-exposed①">exposed</a> to <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context③">unconfined contexts</a>.</p>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext①">SecureContext</a>, <a class="nv idl-code" data-link-type="extended-attribute">COWLContext</a>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="cowl"><code>COWL</code></dfn> {
  [<a class="nv idl-code" data-link-type="extended-attribute">SetterThrows</a>] <span class="kt">static</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑤⑥">Label</a> <a class="nv idl-code" data-link-type="attribute" data-type="Label" href="#dom-cowl-confidentiality" id="ref-for-dom-cowl-confidentiality">confidentiality</a>;
  [<a class="nv idl-code" data-link-type="extended-attribute">SetterThrows</a>] <span class="kt">static</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑤⑦">Label</a> <a class="nv idl-code" data-link-type="attribute" data-type="Label" href="#dom-cowl-integrity" id="ref-for-dom-cowl-integrity">integrity</a>;
  [<a class="nv idl-code" data-link-type="extended-attribute">SetterThrows</a>] <span class="kt">static</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①①⑨">Privilege</a> <a class="nv idl-code" data-link-type="attribute" data-type="Privilege" href="#dom-cowl-privilege" id="ref-for-dom-cowl-privilege">privilege</a>;
};
</pre>
     <h4 class="heading settled" data-level="3.3.1" id="cowl-attributes"><span class="secno">3.3.1. </span><span class="content">Attributes</span><a class="self-link" href="#cowl-attributes"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="COWL" data-dfn-type="attribute" data-export="" id="dom-cowl-confidentiality" title="COWL/confidentiality"><code>confidentiality</code></dfn>, <span> of type <a data-link-type="idl-name" href="#label①" id="ref-for-label①⑤⑧">Label</a></span>
      <dd>
       <ul>
        <li data-md="">
         <p>On getting, the user agent MUST return the <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label③">current
confidentiality label</a>.</p>
        <li data-md="">
         <p>On setting, the user agent MUST use an algorithm equivalent
to the following:</p>
         <ol>
          <li data-md="">
           <p>Let <var>conf</var> be the set confidentiality label.</p>
          <li data-md="">
           <p>Let <var>canWrite</var> be the result of invoking
 the <a data-link-type="dfn" href="#write-check" id="ref-for-write-check">write check</a> algorithm with <var>conf</var> and the <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label④">current integrity label</a>.</p>
          <li data-md="">
           <p>If <var>canWrite</var> is <code>false</code>, throw a <code>SecurityError</code> exception and terminate this
 algorithm.</p>
          <li data-md="">
           <p>Else, set the <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label④">current confidentiality label</a> to <var>conf</var>.</p>
         </ol>
       </ul>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="COWL" data-dfn-type="attribute" data-export="" id="dom-cowl-integrity" title="COWL/integrity"><code>integrity</code></dfn>, <span> of type <a data-link-type="idl-name" href="#label①" id="ref-for-label①⑤⑨">Label</a></span>
      <dd>
       <ul>
        <li data-md="">
         <p>On getting, the user agent MUST return the <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label⑤">current
integrity label</a>.</p>
        <li data-md="">
         <p>On setting, the user agent MUST use an algorithm equivalent
to the following:</p>
         <ol>
          <li data-md="">
           <p>Let <var>int</var> be the set integrity label.</p>
          <li data-md="">
           <p>Let <var>canWrite</var> be the result of invoking the <a data-link-type="dfn" href="#write-check" id="ref-for-write-check①">write check</a> algorithm with the <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label⑤">current
 confidentiality label</a> and <var>int</var>.</p>
          <li data-md="">
           <p>If <var>canWrite</var> is <code>false</code>,
 throw a <code>SecurityError</code> exception and terminate this algorithm.</p>
          <li data-md="">
           <p>Else, set the <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label⑥">current integrity label</a> to <var>int</var>.</p>
         </ol>
       </ul>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="COWL" data-dfn-type="attribute" data-export="" id="dom-cowl-privilege" title="COWL/privilege"><code>privilege</code></dfn>, <span> of type <a data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①②⓪">Privilege</a></span>
      <dd>
       <ul>
        <li data-md="">
         <p>On getting, the user agent MUST return the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①①">current
privilege</a>.</p>
        <li data-md="">
         <p>On setting, the user agent MUST use an algorithm equivalent to the following:</p>
         <ol>
          <li data-md="">
           <p>Let <var>priv</var> be the set privilege.</p>
          <li data-md="">
           <p>Set the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①②">current privilege</a> to <var>priv</var>.</p>
         </ol>
       </ul>
     </dl>
     <h4 class="heading settled" data-level="3.3.2" id="COWL-examples"><span class="secno">3.3.2. </span><span class="content">Examples</span><a class="self-link" href="#COWL-examples"></a></h4>
      Below are several examples showing how to use the <a class="idl-code" data-link-type="interface" href="#cowl" id="ref-for-cowl③">COWL</a> API.  The <a href="#privilege-examples">§3.2.3 Examples</a> illustrate
    the use of <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege⑨">context privileges</a>. 
     <div class="example" id="example-5e3e8c6a">
      <a class="self-link" href="#example-5e3e8c6a"></a> An author can set the <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label①">context integrity label</a> to ensure
      that the context can only receive messages from
      (another context or server of) the same origin: 
<pre><code><a class="idl-code" data-link-type="interface" href="#cowl" id="ref-for-cowl④">COWL</a>.integrity = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑥⓪">Label</a>(window.location.origin);
</code></pre>
     </div>
     <div class="example" id="example-7bccdbf1">
      <a class="self-link" href="#example-7bccdbf1"></a> The author of <code>https://mashup.com</code> can set the <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label①">context
      confidentiality label</a> to receive data sensitive from <code>https://provider.com</code>: 
<pre><code><a class="idl-code" data-link-type="interface" href="#cowl" id="ref-for-cowl⑤">COWL</a>.confidentiality = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑥①">Label</a>('https://provider.com');
</code></pre>
      <p>At this point, the context can only communicate with <code>https://provider.com</code>. The data provider can
      ensure that only appropriately labeled contexts
      can inspect an HTTP response by setting response labels using
      the <a href="#response-header"><code>Sec-COWL</code></a> response
      header.</p>
     </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.4" id="object-labels"><span class="secno">3.4. </span><span class="content">Labeled Objects</span><a class="self-link" href="#object-labels"></a></h3>
     <p>A <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject⑤">LabeledObject</a> interface represents an immutable
    object that is protected by a confidentiality and integrity
    label, i.e., the object has associated labels.</p>
     <p>This API is designed to be used in conjunction with other APIs and
    elements on the web platform. In particular, <a data-link-type="functionish" href="https://www.w3.org/TR/webmessaging/#dom-window-postmessage" id="ref-for-dom-window-postmessage②">postMessage()</a> and <a data-link-type="dfn" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest">XMLHttpRequest</a> (e.g., with an
    overloaded <a data-link-type="functionish"><code>send()</code></a> method for <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject⑥">LabeledObject</a> arguments). It SHOULD be exposed to both <a data-link-type="dfn" href="#confined-context" id="ref-for-confined-context③">confined contexts</a> and <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context④">unconfined contexts</a>.</p>
     <p>A <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject⑦">LabeledObject</a> MUST have an internal <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="protected object" data-noexport="" id="protected-object">protected
    object</dfn>, a confidentiality <a data-link-type="dfn" href="#label" id="ref-for-label①⑧">label</a>, and an
    integrity <a data-link-type="dfn" href="#label" id="ref-for-label①⑨">label</a>. The interface is defined below.</p>
<pre class="idl highlight def"><span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-cilabel"><code>CILabel</code></dfn> {
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥②">Label</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="CILabel" data-dfn-type="dict-member" data-export="" data-type="Label? " id="dom-cilabel-confidentiality"><code>confidentiality</code></dfn>;
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥③">Label</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="CILabel" data-dfn-type="dict-member" data-export="" data-type="Label? " id="dom-cilabel-integrity"><code>integrity</code></dfn>;
};

[<a class="nv idl-code" data-link-type="constructor" href="#dom-labeledobject-labeledobject" id="ref-for-dom-labeledobject-labeledobject">Constructor</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object"><span class="kt">object</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LabeledObject/LabeledObject(obj, labels)" data-dfn-type="argument" data-export="" id="dom-labeledobject-labeledobject-obj-labels-obj"><code>obj</code></dfn>, <a class="n" data-link-type="idl-name" href="#dictdef-cilabel" id="ref-for-dictdef-cilabel">CILabel</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LabeledObject/LabeledObject(obj, labels)" data-dfn-type="argument" data-export="" id="dom-labeledobject-labeledobject-obj-labels-labels"><code>labels</code></dfn>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②">Exposed</a>=(<span class="n">Window</span>, <span class="n">Worker</span>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext②">SecureContext</a>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="labeledobject"><code>LabeledObject</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥④">Label</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Label" href="#dom-labeledobject-confidentiality" id="ref-for-dom-labeledobject-confidentiality">confidentiality</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥⑤">Label</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Label" href="#dom-labeledobject-integrity" id="ref-for-dom-labeledobject-integrity">integrity</a>;

  [<a class="nv idl-code" data-link-type="extended-attribute">GetterThrows</a>] <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object①"><span class="kt">object</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="object" href="#dom-labeledobject-protectedobject" id="ref-for-dom-labeledobject-protectedobject">protectedObject</a>;

  [<a class="nv idl-code" data-link-type="extended-attribute">Throws</a>] <a class="n" data-link-type="idl-name" href="#labeledobject" id="ref-for-labeledobject⑧">LabeledObject</a> <a class="nv idl-code" data-link-type="method" href="#dom-labeledobject-clone" id="ref-for-dom-labeledobject-clone">clone</a>(<a class="n" data-link-type="idl-name" href="#dictdef-cilabel" id="ref-for-dictdef-cilabel①">CILabel</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LabeledObject/clone(labels)" data-dfn-type="argument" data-export="" id="dom-labeledobject-clone-labels-labels"><code>labels</code></dfn>);
};
</pre>
     <h4 class="heading settled" data-level="3.4.1" id="labeledobject-constructor"><span class="secno">3.4.1. </span><span class="content">Constructors</span><a class="self-link" href="#labeledobject-constructor"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="LabeledObject" data-dfn-type="constructor" data-export="" id="dom-labeledobject-labeledobject"><code>LabeledObject(obj, labels)</code></dfn>
      <dd>
       <p>When invoking the <a data-link-type="functionish" href="#dom-labeledobject-labeledobject" id="ref-for-dom-labeledobject-labeledobject①">LabeledObject()</a> constructor, the user
      agent MUST use an algorithm equivalent to the following:</p>
       <ol>
        <li data-md="">
         <p>Let <var>obj clone</var> be the result of obtaining a <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone" id="ref-for-structured-clone①">structured clone</a> of the <a class="idl-code" data-link-type="argument" href="#dom-labeledobject-labeledobject-obj-labels-obj" id="ref-for-dom-labeledobject-labeledobject-obj-labels-obj">obj</a> argument.</p>
        <li data-md="">
         <p>Let <var>labels</var> be the <a class="idl-code" data-link-type="argument" href="#dom-labeledobject-labeledobject-obj-labels-labels" id="ref-for-dom-labeledobject-labeledobject-obj-labels-labels">labels</a> argument if it provided, otherwise an empty object with no members.</p>
        <li data-md="">
         <p>Let <var>conf</var> be the <a class="idl-code" data-link-type="dict-member" href="#dom-cilabel-confidentiality" id="ref-for-dom-cilabel-confidentiality">confidentiality</a> member of <var>labels</var>, if it
 is set.  Otherwise, let <var>conf</var> be the <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label⑥">current
 confidentiality label</a>.</p>
        <li data-md="">
         <p>Let <var>int</var> be the <a class="idl-code" data-link-type="dict-member" href="#dom-cilabel-integrity" id="ref-for-dom-cilabel-integrity">integrity</a> member of <var>labels</var>, if it is set.
 Otherwise, let <var>int</var> be the <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label⑦">current integrity label</a>.</p>
        <li data-md="">
         <p>Let <var>canWrite</var> be the result of invoking the <a data-link-type="dfn" href="#write-check" id="ref-for-write-check②">write
 check</a> algorithm with the <var>conf</var> and <var>int</var> labels.</p>
        <li data-md="">
         <p>If <var>canWrite</var> is <code>false</code>, the constructor
 MUST throw a <code>SecurityError</code> exception
 and terminate this algorithm.</p>
        <li data-md="">
         <p>Else, the user agent MUST return a new <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject⑨">LabeledObject</a>, with the <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object①">protected object</a> set to <var>obj clone</var>, the confidentiality label set to <var>conf</var>, and the integrity
 label set to <var>int</var>.</p>
       </ol>
     </dl>
     <div class="note" role="note"> Because COWL enforces labels at context boundaries, there is
      usually no reason to label an object and then use the <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects④">labeled
      object</a> within the same context. <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①⓪">LabeledObject</a>s
      are mainly useful for sending sensitive data to an untrusted <a data-link-type="dfn"> confined context</a>, e.g., via <a data-link-type="dfn" href="https://www.w3.org/TR/webmessaging/#web-messaging" id="ref-for-web-messaging">cross-document messaging</a>, as a way
      to ensure that the data’s confidentiality and integrity (as specified by
      the labels) are respected by the untrusted context. Hence, the <a data-link-type="functionish" href="#dom-labeledobject-labeledobject" id="ref-for-dom-labeledobject-labeledobject②">LabeledObject()</a> constructor only accepts objects that can be <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone" id="ref-for-structured-clone②">structurally cloned</a>. </div>
     <h4 class="heading settled" data-level="3.4.2" id="labeledobject-attributes"><span class="secno">3.4.2. </span><span class="content">Attributes</span><a class="self-link" href="#labeledobject-attributes"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="LabeledObject" data-dfn-type="attribute" data-export="" id="dom-labeledobject-confidentiality" title="LabeledObject/confidentiality"><code>confidentiality</code></dfn>, <span> of type <a data-link-type="idl-name" href="#label①" id="ref-for-label①⑥⑥">Label</a>, readonly</span>
      <dd> On getting, the user agent MUST return the <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①①">LabeledObject</a>’s confidentiality label. 
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="LabeledObject" data-dfn-type="attribute" data-export="" id="dom-labeledobject-integrity" title="LabeledObject/integrity"><code>integrity</code></dfn>, <span> of type <a data-link-type="idl-name" href="#label①" id="ref-for-label①⑥⑦">Label</a>, readonly</span>
      <dd> On getting, the user agent MUST return the <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①②">LabeledObject</a>’s integrity label. 
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="LabeledObject" data-dfn-type="attribute" data-export="" id="dom-labeledobject-protectedobject" title="LabeledObject/protectedObject"><code>protectedObject</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object②">object</a>, readonly</span>
      <dd>
       <p>On getting, the user agent MUST use an algorithm equivalent to
        the following:</p>
       <ol>
        <li data-md="">
         <p>Invoke the <a data-link-type="dfn" href="#context-tainting" id="ref-for-context-tainting①">context tainting</a> algorithm with the <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①③">LabeledObject</a>’s confidentiality and integrity labels.</p>
        <li data-md="">
         <p>If the tainting algorithm raised an exception, re-throw the
 exception and terminate this algorithm.</p>
         <div class="note" role="note"> The tainting algorithm fails if code in a <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context⑤">unconfined
   context</a> tries to read data that should confine the context.
   To make it easier for developers to debug such cases, the user
   agent SHOULD report a message to inform developers that they can
   create <a data-link-type="dfn">cowl iframes</a> wherein they can inspect such sensitive
   objects instead. </div>
        <li data-md="">
         <p>Else, return the <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①④">LabeledObject</a>’s <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object②">protected object</a>.</p>
       </ol>
     </dl>
     <div class="note" role="note">
       Note: the labels of a <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①⑤">LabeledObject</a> are
      essentially public since code can always inspect the labels.
      However, to inspect the internal, <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object③">protected object</a>, the
      current context must be <a data-link-type="dfn" href="#tainted" id="ref-for-tainted②">tainted</a> according to the object’s
      labels. This ensures two things: 
      <ul>
       <li data-md="">
        <p>The context can’t violate the confidentiality of the data (as
specified by the confidentiality label) by communicating
arbitrarily once it reads data labeled as such.</p>
       <li data-md="">
        <p>The context can’t violate the integrity of entities more
trustworthy than the data. (The trustworthiness of the data is
specified by the integrity label.) In particular, once the
context reads the data and gets <a data-link-type="dfn" href="#tainted" id="ref-for-tainted③">tainted</a>, the rest of the
computation is restricted to writing to entities that are at
most as trustworthy as the data, since the read data may have
influenced the computation.</p>
      </ul>
     </div>
     <h4 class="heading settled" data-level="3.4.3" id="labeledobject-methods"><span class="secno">3.4.3. </span><span class="content">Methods</span><a class="self-link" href="#labeledobject-methods"></a></h4>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="LabeledObject" data-dfn-type="method" data-export="" data-lt="clone(labels)" id="dom-labeledobject-clone" title="clone(labels)"><code>clone(CILabel labels)</code></dfn>
      <dd>
       <p>On invocation, the user agent MUST use an algorithm equivalent
      to the following:</p>
       <ol start="0">
        <li data-md="">
         <p>Let <var>obj</var> be the <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object④">protected object</a> of the
 object on which the method was invoked.</p>
        <li data-md="">
         <p>Let <var>conf</var> be the confidentiality label of the
 object on which the method was invoked.</p>
        <li data-md="">
         <p>Let <var>int</var> be the integrity label of the
 object on which the method was invoked.</p>
        <li data-md="">
         <p>Let <var>newConf</var> be the <a class="idl-code" data-link-type="dict-member" href="#dom-cilabel-confidentiality" id="ref-for-dom-cilabel-confidentiality①">confidentiality</a> member of the <a class="idl-code" data-link-type="argument" href="#dom-labeledobject-clone-labels-labels" id="ref-for-dom-labeledobject-clone-labels-labels">labels</a> argument, if it is
 set.  Otherwise, let <var>newConf</var> be <var>conf</var>.</p>
        <li data-md="">
         <p>Let <var>newInt</var> be the <a class="idl-code" data-link-type="dict-member" href="#dom-cilabel-integrity" id="ref-for-dom-cilabel-integrity①">integrity</a> member of the <a class="idl-code" data-link-type="argument" href="#dom-labeledobject-clone-labels-labels" id="ref-for-dom-labeledobject-clone-labels-labels①">labels</a> parameter, if it is set.  Otherwise, let <var>newInt</var> be <var>int</var>.</p>
        <li data-md="">
         <p>Let <var>privs</var> be the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①⑥">internal privilege
 label</a> of the current <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①⓪">context privileges</a>.</p>
        <li data-md="">
         <p>If <code><var>newConf</var>.subsumes(<var>conf</var>, <var>privs</var>)</code> returns <code>false</code> or
 if <code><var>int</var>.<a data-link-type="functionish" href="#dom-label-subsumes" id="ref-for-dom-label-subsumes①">subsumes(<var>newInt</var>, <var>privs</var>)</a></code> returns <code>false</code>, the method
 MUST throw a <code>SecurityError</code> exception and
 terminate this algorithm.</p>
         <p class="note" role="note"><span>Note,</span> these checks ensure that the new labels of the object are
 at least as restricting as the original labels, taking into
 consideration the privileges of the context.</p>
        <li data-md="">
         <p>Else, return a new <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①⑥">LabeledObject</a>, with the <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object⑤">protected object</a> set to <var>obj</var>, the
 confidentiality label set to <var>newConf</var>, and the
 integrity label set to <var>newInt</var>.</p>
       </ol>
     </dl>
     <h4 class="heading settled" data-level="3.4.4" id="labeledobject-examples"><span class="secno">3.4.4. </span><span class="content">Examples</span><a class="self-link" href="#labeledobject-examples"></a></h4>
      Below are several examples showing the usage of <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①⑦">LabeledObject</a>s. <a href="#examples-checker">§1.2.1 Confining untrusted third-party services</a> gives an
    example of how <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①⑧">LabeledObject</a>s can be used to
    confine third-party libraries (e.g., a password strength
    checker). <a href="#labeledobject-xhr-send-example">§3.6.1.1 Examples</a> and <a href="#labeledobject-xhr-receive-example">§3.6.2.1 Examples</a> show how <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject①⑨">LabeledObject</a>s are used with the <a data-link-type="dfn" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest①">XMLHttpRequest</a> constructor. 
     <div class="example" id="example-f7f8a456">
      <a class="self-link" href="#example-f7f8a456"></a> The author of <code>https://police.gov</code> wishes to plot the
      location of police cars on a map provided by <code>https://maps.biz</code> without revealing the individual
      car locations (to the map provider). After revealing the general area to <code>https://maps.biz</code>, the author of <code>https://police.gov</code> labels the police car coordinates and
      sends them to the mapping service: 
<pre><code>
// Fetch map for provided location and draw it
mapsIframe.postMessage({ cmd: 'draw', location: ... }, mapsOrigin);

var locations = ... // Array of police-car coordinates

// Label the locations (as being sensitive to the police origin):
var labeledLocations = new <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②⓪">LabeledObject</a>(locations,
                             { confidentiality: new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑥⑧">Label</a>(window.location.origin) });

// Send the labeled locations to the map iframe to plot them
mapsIframe.postMessage({ cmd: 'plot', locations: labeledLocations }, mapsOrigin);
</code></pre>
      <p>When receiving a <code>draw</code> message, the author of <code>https://maps.biz</code> navigates the iframe map (a nested
      context) to draw the map; otherwise, it simply forwards messages
      from the parent (e.g., <code>plot</code>, <code>zoom</code>, and <code>move</code>). (This design ensures that only the innermost
      iframe gets tainted.)</p>
      <p>The innermost map <a data-link-type="dfn">cowl iframe</a> registers a handler, that, for
      example, draws cars on top of map tiles:</p>
<pre><code>window.addEventListener("message", function (event) {
  switch (event.data.cmd) {
    case 'plot':
      var coordinates = event.data.locations.<a class="idl-code" data-link-type="attribute" href="#dom-labeledobject-protectedobject" id="ref-for-dom-labeledobject-protectedobject①">protectedObject</a>;
      coordinates.forEach(function (coordinate) {
        // add car to map at coordinate
      });
    case 'zoom': ...
    case 'move': ...
    ...
  };
}, false);
</code></pre>
      <p>Note that before getting the first <a class="idl-code" data-link-type="attribute" href="#dom-labeledobject-protectedobject" id="ref-for-dom-labeledobject-protectedobject②">protectedObject</a>, the iframe
      can communicate arbitrarily, e.g., to fetch map tiles. But once
      it inspects the confidential locations COWL confines the
      code—it restricts it to only communicating with <code>https://police.gov</code>. Importantly, it can keep
      receiving messages from its parent context via <a data-link-type="functionish" href="https://www.w3.org/TR/webmessaging/#dom-window-postmessage" id="ref-for-dom-window-postmessage③">postMessage()</a> to, for instance, move a car.</p>
     </div>
     <div class="example" id="example-d3722fd1">
      <a class="self-link" href="#example-d3722fd1"></a> The author of <code>https://example.com</code> wishes to ensure
      that a particular JSON object conforms to a set of validation
      filters before submitting it to a remote server.  Consider, for
      example, a form validator that checks if an email address is
      valid. To this end, it labels the JSON and sends the <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects⑤">labeled
      object</a> to a <a data-link-type="dfn">cowl iframe</a> that performs the validation. 
      <p>The validation author inspects the object, but only endorses it
      if it it is an email:</p>
<pre><code>function handler(lObj) {
  if (isValidEmail(lObj.<a class="idl-code" data-link-type="attribute" href="#dom-labeledobject-protectedobject" id="ref-for-dom-labeledobject-protectedobject③">protectedObject</a>)) {
    var origin = window.location.origin;
    // Endorse with application-specific label: '<validator-origin> OR app:isValidEmail'
    var endorsement = new <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑥⑨">Label</a>(origin).or('app:isValidEmail');
    // Return a clone of the labeled object that is additionally
    // endorsed by the validator’s (sub-)origin.
    return lObj.clone({ integrity: lObj.integrity.and(endorsement) });
  } else {
    return null;
  }
}
</validator-origin></code></pre>
      <p>The author of <code>https://example.com</code> can then pass the
      endorsed object to other validators (e.g., a validator that checks emails
      against a black-list) or end-point (e.g., a server), who can, in turn,
      further endorse the object or verify the origins that have endorsed it.</p>
     </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.5" id="header"><span class="secno">3.5. </span><span class="content">The <code>Sec-COWL</code> HTTP Header Field</span><a class="self-link" href="#header"></a></h3>
     <p>The <code>Sec-COWL</code> HTTP header field is
    used to convey <a data-link-type="dfn" href="#label-metadata" id="ref-for-label-metadata">label metadata</a>.</p>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label-metadata">Label metadata</dfn> is either <a data-link-type="dfn" href="#labeled-context-metadata" id="ref-for-labeled-context-metadata">labeled context metadata</a> or <a data-link-type="dfn" href="#labeled-data-metadata" id="ref-for-labeled-data-metadata">labeled data metadata</a>.</p>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="labeled-context-metadata">Labeled context metadata</dfn> encodes <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state③">COWL state</a> information, including:</p>
     <ul>
      <li data-md="">
       <p>the serialized <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label②">context confidentiality label</a> given by the <a data-link-type="dfn" href="#ctx-confidentiality" id="ref-for-ctx-confidentiality">ctx-confidentiality</a> directive,</p>
      <li data-md="">
       <p>the serialized <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label②">context integrity label</a> given by the <a data-link-type="dfn" href="#ctx-integrity" id="ref-for-ctx-integrity">ctx-integrity</a> directive, and</p>
      <li data-md="">
       <p>the serialized <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①①">context privilege</a>’s <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①⑦">internal privilege label</a> given by the <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege②">ctx-privilege</a> directive.</p>
     </ul>
     <p>Its ABNF is:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ctx-metadata">ctx-metadata</dfn>        = <a data-link-type="dfn" href="#ctx-directive" id="ref-for-ctx-directive">ctx-directive</a> *( ";" [ <a data-link-type="dfn" href="#ctx-directive" id="ref-for-ctx-directive①">ctx-directive</a> ] )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ctx-directive">ctx-directive</dfn>       = *<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1">WSP</a> <a data-link-type="dfn" href="#ctx-directive-name" id="ref-for-ctx-directive-name">ctx-directive-name</a> 1*<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①">WSP</a> <a data-link-type="dfn" href="#label-expression" id="ref-for-label-expression①">label-expression</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ctx-directive-name">ctx-directive-name</dfn>  = "<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ctx-confidentiality">ctx-confidentiality</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ctx-integrity">ctx-integrity</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ctx-privilege">ctx-privilege</dfn>"
</pre>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="labeled-data-metadata">Labeled data metadata</dfn> is used to convey the
    confidentiality and integrity labels of an HTTP request or response, using
    the <a data-link-type="dfn" href="#data-confidentiality" id="ref-for-data-confidentiality①">data-confidentiality</a> and <a data-link-type="dfn" href="#data-integrity" id="ref-for-data-integrity">data-integrity</a> directives.  Its ABNF is:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="data-metadata">data-metadata</dfn>       = <a data-link-type="dfn" href="#data-directive" id="ref-for-data-directive">data-directive</a> *( ";" [ <a data-link-type="dfn" href="#data-directive" id="ref-for-data-directive①">data-directive</a> ] )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="data-directive">data-directive</dfn>      = *<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1②">WSP</a> <a data-link-type="dfn" href="#data-directive-name" id="ref-for-data-directive-name">data-directive-name</a> 1*<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1③">WSP</a> <a data-link-type="dfn" href="#label-expression" id="ref-for-label-expression②">label-expression</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="data-directive-name">data-directive-name</dfn> = "<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="data-confidentiality">data-confidentiality</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="data-integrity">data-integrity</dfn>"
</pre>
     <p>The ABNF for <dfn data-dfn-type="dfn" data-noexport="" id="serialized-labels">serialized labels<a class="self-link" href="#serialized-labels"></a></dfn> is:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label-expression">label-expression</dfn>   = <a data-link-type="dfn" href="#empty-label①" id="ref-for-empty-label①⑨">empty-label</a> / <a data-link-type="dfn" href="#and-expression" id="ref-for-and-expression">and-expression</a> / <a data-link-type="dfn" href="#or-expression" id="ref-for-or-expression">or-expression</a> / <a data-link-type="dfn" href="#principal-expression" id="ref-for-principal-expression">principal-expression</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="and-expression">and-expression</dfn>     = *<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1④">WSP</a> "(" <a data-link-type="dfn" href="#or-expression" id="ref-for-or-expression①">or-expression</a> *<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑤">WSP</a> ")" *( 1*<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑥">WSP</a> "AND" <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑦">WSP</a> <a data-link-type="dfn" href="#and-expression" id="ref-for-and-expression①">and-expression</a> )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="or-expression">or-expression</dfn>      = *<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑧">WSP</a> <a data-link-type="dfn" href="#principal-expression" id="ref-for-principal-expression①">principal-expression</a> *( 1*<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑨">WSP</a> "OR" <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①⓪">WSP</a> <a data-link-type="dfn" href="#or-expression" id="ref-for-or-expression②">or-expression</a> ) 
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="empty-label①">empty-label</dfn>        = "<dfn data-dfn-type="dfn" data-noexport="" id="none">'none'<a class="self-link" href="#none"></a></dfn>"
</pre>
     <p class="note" role="note"><span>Note,</span> the ABNF grammar limits the expression of labels to conjunctions of
    disjunctions, even though the JavaScript API allows AND’s and OR’s to be
    used interchangably. This is done to simplify auditing of declarative
    (header) labels, but may be changed in future versions to be more flexible.</p>
     <p>The ABNF for serialized <a data-link-type="dfn" href="#principal" id="ref-for-principal⑤">principals</a> is:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="principal-expression">principal-expression</dfn>        = <a data-link-type="dfn" href="#origin-principal-expression" id="ref-for-origin-principal-expression">origin-principal-expression</a> 
                            / <a data-link-type="dfn" href="#app-principal-expression" id="ref-for-app-principal-expression①">app-principal-expression</a> 
                            / <a data-link-type="dfn" href="#unique-principal-expression" id="ref-for-unique-principal-expression①">unique-principal-expression</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="origin-principal-expression">origin-principal-expression</dfn> = "<dfn data-dfn-type="dfn" data-noexport="" id="self">'self'<a class="self-link" href="#self"></a></dfn>" / <a data-link-type="dfn" href="https://www.w3.org/TR/CSP2/#host_source" id="ref-for-host_source">host-source</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="app-principal-expression">app-principal-expression</dfn>    = "app:" 1*( <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①①">ALPHA</a> / <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①②">DIGIT</a> / "-" )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="unique-principal-expression">unique-principal-expression</dfn> = "unique:" <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4122#section-3" id="ref-for-section-3①">UUID</a>
</pre>
     <p>The parsing algorithms for <a data-link-type="dfn" href="#label-metadata" id="ref-for-label-metadata①">label metadata</a> are given in <a href="#parse-labeled-metadata-data">§4.10 Parse labeled data metadata</a> and <a href="#parse-labeled-metadata-ctx">§4.11 Parse labeled context metadata</a>.</p>
     <section>
      <h4 class="heading settled" data-level="3.5.1" id="request-header"><span class="secno">3.5.1. </span><span class="content"><code>Sec-COWL</code> in HTTP Requests</span><a class="self-link" href="#request-header"></a></h4>
      <p>The ABNF for <code>Sec-COWL</code> HTTP requests is:</p>
<pre>"Sec-COWL:" ( <a data-link-type="dfn" href="#ctx-metadata" id="ref-for-ctx-metadata">ctx-metadata</a> [ "," <a data-link-type="dfn" href="#data-metadata" id="ref-for-data-metadata">data-metadata</a> ] ) / ( <a data-link-type="dfn" href="#data-metadata" id="ref-for-data-metadata①">data-metadata</a> [ "," <a data-link-type="dfn" href="#ctx-metadata" id="ref-for-ctx-metadata①">ctx-metadata</a> ] )
</pre>
      <p>The user agent MUST send a header field named <code>Sec-COWL</code> along with requests if <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode④">confinement mode</a> is enabled and calling <a data-link-type="dfn" href="https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer" id="ref-for-determine-requests-referrer">determine request’s referrer algorithm</a> does not return <code>none</code>. The value of this header MUST contain the <a data-link-type="dfn" href="#labeled-context-metadata" id="ref-for-labeled-context-metadata①">labeled
      context metadata</a> of the context that performed the request. This <a data-link-type="dfn" href="#labeled-context-metadata" id="ref-for-labeled-context-metadata②">labeled context metadata</a> MUST include the current <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label③">context
      confidentiality label</a>, <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label③">context integrity label</a>, and <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①②">context privileges</a>. The user agent MAY send another header with
      this field name whose value is <a data-link-type="dfn" href="#labeled-data-metadata" id="ref-for-labeled-data-metadata①">labeled data metadata</a> (e.g., when
      sending <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects⑥">labeled objects</a> with <a data-link-type="dfn" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest②">XMLHttpRequest</a>).</p>
      <p class="note" role="note"><span>Note,</span> according to <a data-link-type="biblio" href="#biblio-rfc2616">[RFC2616]</a>, the user agent MAY combine
      multiple header field values into a single, comma-separated
      value.</p>
      <div class="example" id="example-e12abee0">
       <a class="self-link" href="#example-e12abee0"></a> Request header from a <code>https://a.com</code> page that has
        read data sensitive to <code>https://b.com</code>. 
<pre><code>Sec-COWL: <a data-link-type="dfn" href="#ctx-confidentiality" id="ref-for-ctx-confidentiality①">ctx-confidentiality</a> https://b.com;
          <a data-link-type="dfn" href="#ctx-integrity" id="ref-for-ctx-integrity①">ctx-integrity</a> 'none';
          <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege③">ctx-privilege</a> https://a.com
</code></pre>
      </div>
      <div class="example" id="example-dbb81961">
       <a class="self-link" href="#example-dbb81961"></a> A request sent from a public, untrustworthy <code>https://university.edu</code> context that <a data-link-type="dfn" href="#owns" id="ref-for-owns">owns</a> a <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege⑧">delegated privilege</a> and a <a data-link-type="functionish" href="#dom-privilege-freshprivilege" id="ref-for-dom-privilege-freshprivilege④">FreshPrivilege()</a>: 
<pre><code>Sec-COWL: <a data-link-type="dfn" href="#ctx-confidentiality" id="ref-for-ctx-confidentiality②">ctx-confidentiality</a> 'none';
          <a data-link-type="dfn" href="#ctx-integrity" id="ref-for-ctx-integrity②">ctx-integrity</a> 'none';
          <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege④">ctx-privilege</a> (https://university.edu OR app:user1) AND (unique:a0281e1f-8412-4068-a7ed-e3f234d7fd5a)
</code></pre>
      </div>
      <p>When processing a request, a server SHOULD only use the first <code>Sec-COWL</code> header that contains a <a data-link-type="dfn" href="#ctx-metadata" id="ref-for-ctx-metadata②">ctx-metadata</a> directive to retrieve the <a data-link-type="dfn" href="#labeled-context-metadata" id="ref-for-labeled-context-metadata③">labeled context metadata</a>.
      Similarly, a server SHOULD only use the first <code>Sec-COWL</code> header that contains a <a data-link-type="dfn" href="#data-metadata" id="ref-for-data-metadata②">data-metadata</a> directive to retrieve
      the <a data-link-type="dfn" href="#labeled-data-metadata" id="ref-for-labeled-data-metadata②">labeled data metadata</a> of the request.</p>
     </section>
     <section>
      <h4 class="heading settled" data-level="3.5.2" id="response-header"><span class="secno">3.5.2. </span><span class="content"><code>Sec-COWL</code> in HTTP Responses</span><a class="self-link" href="#response-header"></a></h4>
      <p>The ABNF for <code>Sec-COWL</code> HTTP responses is:</p>
<pre>"Sec-COWL:" <a data-link-type="dfn" href="#ctx-metadata" id="ref-for-ctx-metadata③">ctx-metadata</a> / <a data-link-type="dfn" href="#data-metadata" id="ref-for-data-metadata③">data-metadata</a>
</pre>
      <p>The header value may contain <a data-link-type="dfn" href="#labeled-context-metadata" id="ref-for-labeled-context-metadata④">labeled context metadata</a> which can be used to set the initial <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state④">COWL state</a> of a
      context; or it may contain <a data-link-type="dfn" href="#labeled-data-metadata" id="ref-for-labeled-data-metadata③">labeled data metadata</a> which
      specifies the sensitivity of the response (which COWL then uses
      to determine whether or not to block the response).</p>
      <div class="example" id="example-8737033c">
       <a class="self-link" href="#example-8737033c"></a> An author may wish to specify that the <code>https://university.edu/~user1</code> page should run with
        a delegated privilege—namely, <code><a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦⓪">Label</a>("https://university.edu/").or("app:user1")</code>—from
         the start: 
<pre><code>Sec-COWL: <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege⑤">ctx-privilege</a> 'self' OR app:user1;
</code></pre>
      </div>
      <div class="example" id="example-a846a5f3">
       <a class="self-link" href="#example-a846a5f3"></a> The author of <code>https://a.com</code> may wish to respond to a
        request with data that is sensitive to both <code>https://a.com</code> and <code>https://b.com</code>, while simultaneously indicating that
        it endorses the response data: 
<pre><code>Sec-COWL: <a data-link-type="dfn" href="#data-confidentiality" id="ref-for-data-confidentiality②">data-confidentiality</a> 'self' AND https://b.com;
          <a data-link-type="dfn" href="#data-integrity" id="ref-for-data-integrity①">data-integrity</a> 'self'
</code></pre>
       <p>COWL blocks the response unless the current context’s labels
        are at least as restricting.</p>
      </div>
      <p>To process this header, the user agent MUST use the <a href="#process-response">Process <var>response</var> to <var>request</var> as COWL</a> algorithm when performing a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#fetching" id="ref-for-fetching">fetch</a>, as described in <a href="#modifications-fetch">§3.7.1 Modifications to Fetch</a>.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.6" id="extension-xhr"><span class="secno">3.6. </span><span class="content">Extensions to XMLHttpRequest</span><a class="self-link" href="#extension-xhr"></a></h3>
     <p>The XMLHttpRequest specification SHOULD contain the
    modifications described below to enable the rest of this
    specification’s work <a data-link-type="biblio" href="#biblio-xhr">[XHR]</a>.</p>
     <h4 class="heading settled" data-level="3.6.1" id="sending-labeled-objects"><span class="secno">3.6.1. </span><span class="content">Sending <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects⑦">labeled objects</a></span><a class="self-link" href="#sending-labeled-objects"></a></h4>
      To allow authors to send <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects⑧">labeled objects</a> to a remote
    server, this specification extends the <a class="idl-code" data-link-type="interface" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest③">XMLHttpRequest</a> interface with an overloaded <code><a data-link-type="functionish">send()</a></code> method: 
<pre class="idl highlight def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest④">XMLHttpRequest</a> {
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-xmlhttprequest-send" id="ref-for-dom-xmlhttprequest-send">send</a>(<a class="n" data-link-type="idl-name" href="#labeledobject" id="ref-for-labeledobject②①">LabeledObject</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="XMLHttpRequest/send(lobj)" data-dfn-type="argument" data-export="" id="dom-xmlhttprequest-send-lobj-lobj"><code>lobj</code></dfn>);
};
</pre>
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XMLHttpRequest" data-dfn-type="method" data-export="" id="dom-xmlhttprequest-send" title="XMLHttpRequest/send(lobj)"><code>send(lobj)</code></dfn> method MUST use an
      algorithm that is equivalent to the following:</p>
     <ol>
      <li data-md="">
       <p>Let <var>obj</var> be the <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object⑥">protected object</a> of the <a class="idl-code" data-link-type="argument" href="#dom-xmlhttprequest-send-lobj-lobj" id="ref-for-dom-xmlhttprequest-send-lobj-lobj">lobj</a> argument.</p>
      <li data-md="">
       <p>Let <var>conf</var> be the confidentiality label of the <a class="idl-code" data-link-type="argument" href="#dom-xmlhttprequest-send-lobj-lobj" id="ref-for-dom-xmlhttprequest-send-lobj-lobj①">lobj</a> argument.</p>
      <li data-md="">
       <p>Let <var>int</var> be the integrity label of the <a class="idl-code" data-link-type="argument" href="#dom-xmlhttprequest-send-lobj-lobj" id="ref-for-dom-xmlhttprequest-send-lobj-lobj②">lobj</a> argument.</p>
      <li data-md="">
       <p>Let <var>privs</var> be the current <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①③">context privileges</a>.</p>
      <li data-md="">
       <p>Let <var>remoteConf</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label②⓪">label</a> returned by the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label⑦">Label(principal)</a> constructor
 called with the stringified origin <a href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> associated with the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a>.</p>
      <li data-md="">
       <p>If <code><var>remoteConf</var>.subsumes(<var>conf</var>, <var>privs</var>)</code> returns <code>false</code>, throw
 a <code>SecurityError</code> and terminate this algorithm.</p>
       <p>The user agent SHOULD report a warning that the context
 attempted to leak data to a remote server.</p>
      <li data-md="">
       <p>Let <var>json</var> be a new <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4627#section-2" id="ref-for-section-2">JSON</a> object with the
 following entries:</p>
       <ul>
        <li data-md="">
         <p><code>"confidentiality"</code> set to the serialized <var>conf</var>.</p>
        <li data-md="">
         <p><code>"integrity"</code> set to the the serialized <var>int</var>.</p>
        <li data-md="">
         <p><code>"object"</code> set to <var>obj</var>.</p>
       </ul>
      <li data-md="">
       <p>Set the <code>Content-Type</code> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header">header</a> to <code><code>application/labeled-json</code></code>.</p>
      <li data-md="">
       <p>Append a header named <code>Sec-COWL</code> to the <a data-link-type="dfn" href="https://xhr.spec.whatwg.org/#author-request-headers" id="ref-for-author-request-headers">author request headers</a> associated with the object this
 methods was called on.  The value of the <code>Sec-COWL</code> header MUST be <a data-link-type="dfn" href="#labeled-data-metadata" id="ref-for-labeled-data-metadata④">labeled data
 metadata</a> containing the confidentiality and integrity
 labels of the <a class="idl-code" data-link-type="argument" href="#dom-xmlhttprequest-send-lobj-lobj" id="ref-for-dom-xmlhttprequest-send-lobj-lobj③">lobj</a> argument.</p>
      <li data-md="">
       <p>Invoke the <code><a data-link-type="functionish">send()</a></code> method on the object this method was called on with <var>json</var> as an argument.</p>
       <p class="note" role="note"><span>Note,</span> that <code><a data-link-type="functionish">send()</a></code> throws an exception if <var>obj</var> cannot be <a data-link-type="dfn" href="https://w3c.github.io/DOM-Parsing/#dfn-concept-fragment-serializing-algorithm" id="ref-for-dfn-concept-fragment-serializing-algorithm">serialized</a>.
  User agents MUST ensure that all <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object⑦">protected object</a>s can be
  serialized at the time of creating <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②②">LabeledObject</a>s.</p>
       <div class="note" role="note"> This algorithm does not check if the integrity label of
    the object subsumes the server’s integrity label. It is
    the server’s responsibility to ensure that untrustworthy
    data does not affect its computation in an unsafe way.
    Indeed, the only reason for checking the confidentiality
    labels is because the user agent has no way to ensure that
    the server will respect the confidentiality of the data. </div>
     </ol>
     <h5 class="heading settled" data-level="3.6.1.1" id="labeledobject-xhr-send-example"><span class="secno">3.6.1.1. </span><span class="content">Examples</span><a class="self-link" href="#labeledobject-xhr-send-example"></a></h5>
     <div class="example" id="example-3628d2cb">
      <a class="self-link" href="#example-3628d2cb"></a> Author of <code>https://example.com</code> sends JSON object
      endorsed by <code>https://validator.com</code>: 
<pre><code>// Suppose that labeledObject is a public, high-integrity value:
labeledObject.confidentiality.toString() === "'none'";
labeledObject.integrity.toString() === "https://validator.com";

// Create an XHR request:
var req = new XMLHttpRequest()
req.open("POST", "https://example.com/");

// Send the labeled object:
req.send(labeledObject);
</code></pre>
      <p>Assuming the context has a <a data-link-type="dfn" href="#default-cowl-state" id="ref-for-default-cowl-state②">default COWL state</a>, <code><a data-link-type="functionish">send()</a></code> would make an HTTP request of the form:</p>
<pre><code>Sec-COWL: <a data-link-type="dfn" href="#ctx-confidentiality" id="ref-for-ctx-confidentiality③">ctx-confidentiality</a> 'none';
          <a data-link-type="dfn" href="#ctx-integrity" id="ref-for-ctx-integrity③">ctx-integrity</a> 'none';
          <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege⑥">ctx-privilege</a> https://example.com
Sec-COWL: <a data-link-type="dfn" href="#data-confidentiality" id="ref-for-data-confidentiality③">data-confidentiality</a> 'none';
          <a data-link-type="dfn" href="#data-integrity" id="ref-for-data-integrity②">data-integrity</a> https://validator.com
Content-Type: application/labeled-json;

{
  "confidentiality": "'none'",
  "integrity": "https://validator.com",
  "object": ... JSON object ...
}
</code></pre>
      <p>The server can then verify the integrity label of the request
      and ensure that, if the user agent is conformant, the data was
      endorsed by <code>https://validator.com</code>.</p>
     </div>
     <h4 class="heading settled" data-level="3.6.2" id="receive-labeled-object"><span class="secno">3.6.2. </span><span class="content">Receiving <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects⑨">labeled objects</a></span><a class="self-link" href="#receive-labeled-object"></a></h4>
      To allow authors to receive <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects①⓪">labeled objects</a> from remote
    servers, the XMLHttpRequest specification SHOULD contain the
    following modifications <a data-link-type="biblio" href="#biblio-xhr">[XHR]</a>: 
     <ol>
      <li data-md="">
       <p>The <code><a class="idl-code" data-link-type="enum" href="https://xhr.spec.whatwg.org/#xmlhttprequestresponsetype" id="ref-for-xmlhttprequestresponsetype">XMLHttpRequestResponseType</a></code> enumeration is extended with a new response type:</p>
<pre class="idl highlight def"><span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="https://xhr.spec.whatwg.org/#xmlhttprequestresponsetype" id="ref-for-xmlhttprequestresponsetype①">XMLHttpRequestResponseType</a> {
  // ... existing response types ...
  <dfn class="s idl-code" data-dfn-for="XMLHttpRequestResponseType" data-dfn-type="enum-value" data-export="" data-lt="&quot;labeled-json&quot;|labeled-json" id="dom-xmlhttprequestresponsetype-labeled-json"><code>"labeled-json"</code><a class="self-link" href="#dom-xmlhttprequestresponsetype-labeled-json"></a></dfn>
};
</pre>
      <li data-md="">
       <p>The <a href="https://xhr.spec.whatwg.org/#response-body">Response
body</a> section of the specification is modified to add:</p>
       <ol>
        <li data-md="">
         <p>An <a class="idl-code" data-link-type="interface" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest⑤">XMLHttpRequest</a> has associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="response-labeledobject-object">response <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②③">LabeledObject</a> object</dfn>.</p>
        <li data-md="">
         <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="labeled-json-response">labeled JSON response</dfn> is the return value
  of these steps:</p>
         <ol>
          <li data-md="">
           <p>If the <a data-link-type="dfn" href="#response-labeledobject-object" id="ref-for-response-labeledobject-object">response LabeledObject object</a> is non-null, return it.</p>
          <li data-md="">
           <p>If <a class="idl-code" data-link-type="attribute" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-responsetype" id="ref-for-dom-xmlhttprequest-responsetype">responseType</a> is not <code>"labeled-json"</code> or the <a data-link-type="dfn" href="https://xhr.spec.whatwg.org/#final-mime-type" id="ref-for-final-mime-type">final MIME
 type</a> is not <code>application/labeled-json</code>, return null.</p>
          <li data-md="">
           <p>Let <var>bytes</var> be the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body">body</a>.</p>
          <li data-md="">
           <p>If <var>bytes</var> is null, return null.</p>
          <li data-md="">
           <p>Let <var>JSON text</var> be the result of running <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode" id="ref-for-utf-8-decode">utf-8 decode</a> on byte stream <var>bytes</var>.</p>
          <li data-md="">
           <p>Let <var>JSON object</var> be the result of invoking the initial
 value of the <code>parse</code> property of the <code>JSON</code> object, with <var>JSON text</var> as its only argument. If that threw an
 exception, return null. <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a></p>
          <li data-md="">
           <p>If the <var>JSON object</var> is missing any of
 the three entries: <code>"object"</code>, <code>"confidentiality"</code>, or <code>"integrity"</code> return null.</p>
          <li data-md="">
           <p>Let <var>protected object</var> be the value of the <code>"object"</code> entry.</p>
          <li data-md="">
           <p>Let <var>self</var> be the <a href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> associated with the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a>.</p>
          <li data-md="">
           <p>Let <var>conf</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label②①">label</a> returned by invoking the <a href="#parse-label-expression">§4.12 Parse label expression</a> algorithm with the <code>"confidentiality"</code> entry of the <var>JSON object</var> and <var>self</var>.  If parsing failed, return null.</p>
          <li data-md="">
           <p>Let <var>int</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label②②">label</a> returned by invoking the <a href="#parse-label-expression">§4.12 Parse label expression</a> algorithm with the <code>"integrity"</code> entry of the <var>JSON object</var> and <var>self</var>.  If parsing failed, return null.</p>
          <li data-md="">
           <p>Let <var>responseInt</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label②③">label</a> returned by the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label⑧">Label(principal)</a> constructor
  called with <var>self</var>.</p>
          <li data-md="">
           <p>If <var>responseInt</var> does not subsume <var>int</var>, return null.</p>
           <p>The user agent SHOULD report a warning message indicating that
  the server provided an integrity label that it is not allowed
  to provide.</p>
          <li data-md="">
           <p>Set the <a data-link-type="dfn" href="#response-labeledobject-object" id="ref-for-response-labeledobject-object①">response LabeledObject object</a> to a newly
  created <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②④">LabeledObject</a> whose <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object⑧">protected object</a> is <var>protected object</var>,
  whose confidentiality label is <var>conf</var>, and
  whose integrity label is <var>int</var>.</p>
          <li data-md="">
           <p>Return the <a data-link-type="dfn" href="#response-labeledobject-object" id="ref-for-response-labeledobject-object②">response LabeledObject object</a>.</p>
         </ol>
       </ol>
      <li data-md="">
       <p>Modify the <a class="idl-code" data-link-type="attribute" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-responsetype" id="ref-for-dom-xmlhttprequest-responsetype①">response</a> attribute by
 adding the following clause to step 2 of the <strong>↪ Otherwise</strong> clause:</p>
       <p><strong>↪ If <a class="idl-code" data-link-type="attribute" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-responsetype" id="ref-for-dom-xmlhttprequest-responsetype②">responseType</a> is</strong> <code>"labeled-json"</code></p>
       <p style="text-indent: 2.5em">Return the <a data-link-type="dfn" href="#labeled-json-response" id="ref-for-labeled-json-response①">labeled JSON response</a>.</p>
      <li data-md="">
       <p>Modify step 12 of the <a data-link-type="functionish" href="https://xhr.spec.whatwg.org/#the-open()-method" id="ref-for-the-open()-method">open()</a> method by adding the
 following sub-step:</p>
       <ul>
        <li data-md="">
         <p>Set <a data-link-type="dfn" href="#response-labeledobject-object" id="ref-for-response-labeledobject-object③">response LabeledObject object</a> to null.</p>
       </ul>
     </ol>
     <h5 class="heading settled" data-level="3.6.2.1" id="labeledobject-xhr-receive-example"><span class="secno">3.6.2.1. </span><span class="content">Examples</span><a class="self-link" href="#labeledobject-xhr-receive-example"></a></h5>
     <div class="example" id="mashup-example-xhr">
      <a class="self-link" href="#mashup-example-xhr"></a> <a href="#examples-mashup">§1.2.2 Sharing data with third-party mashups</a> gives an example of a mashup scenario
      wherein the data provider uses the <a href="#response-header">Sec-COWL</a> HTTP response header to
      ensure that the mashup integrator can only read the HTTP
      response if it is sufficiently confined. A more permissive
      approach is to send a <a data-link-type="dfn" href="#labeled-json-response" id="ref-for-labeled-json-response②">labeled JSON response</a>. 
      <p>Specifically, the server operator of <code>https://provider.com</code> uses a CORS response header to
      send <code>https://mashup.com</code> a labeled JSON object. To
      ensure that the data is protected it sets the <code>Content-Type</code> response header value to <code><code>application/labeled-json</code></code> and sets the labels
      appropriately:</p>
<pre><code><a data-link-type="dfn" href="https://www.w3.org/TR/cors/#access-control-allow-origin-response-header" id="ref-for-access-control-allow-origin-response-header②">Access-Control-Allow-Origin</a>: https://mashup.com
Content-Type: application/labeled-json;

{
  "confidentiality": "'self'",
  "integrity": "'self'",
  "object": ... JSON object ...
}
</code></pre>
      <p>The confidentiality label specifies that the object is
      confidential to <code>https://provider.com</code> and should
      not be disseminated arbitrarily.</p>
      <p class="note" role="note"><span>Note,</span> the server operator can also set a <a href="#response-header"><code>Sec-COWL</code></a> response header if it
      wished to ensure that the context is already confined according to some
      label.</p>
      <p>The author of <code>https://mashup.com</code> can read such
      labeled responses by simply setting the <a class="idl-code" data-link-type="attribute" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-responsetype" id="ref-for-dom-xmlhttprequest-responsetype③">responseType</a> accordingly:</p>
<pre><code>
// Create an XHR request to get the data:
var req = new XMLHttpRequest()
req.open("GET", "https://provider.com/apis/...");
req.responseType = "labeled-json";
req.onload = function (e) {
  var labeledObject = req.response; // is a <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②⑤">LabeledObject</a>

  // At this point, the context is still untainted, but:
  labeledObject.confidentiality.toString() === "https://provider.com";
  labeledObject.integrity.toString() ===  "https://provider.com";
};
req.send();
</code></pre>
      <p>Here, COWL sets the <a class="idl-code" data-link-type="attribute" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-responsetype" id="ref-for-dom-xmlhttprequest-responsetype④">response</a> to a new <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②⑥">LabeledObject</a>, but does not <a data-link-type="dfn" href="#tainted" id="ref-for-tainted④">taint</a> the
      context with the response label. Indeed the <code>https://mashup.com</code> integrator can perform many
      other requests to different origins. Only when the <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object⑨">protected objects</a> of these <a data-link-type="dfn" href="#labeled-objects" id="ref-for-labeled-objects①①">labeled objects</a> are
      used will COWL taint the context and impose the label
      restrictions.</p>
     </div>
     <div class="example" id="example-4e90fb63">
      <a class="self-link" href="#example-4e90fb63"></a> An image provider can serve "read-once" images by labeling them
      with a unique origin when reply to an HTTP request: 
<pre><code><a data-link-type="dfn" href="https://www.w3.org/TR/cors/#access-control-allow-origin-response-header" id="ref-for-access-control-allow-origin-response-header③">Access-Control-Allow-Origin</a>: *
Content-Type: application/labeled-json;

{
  "confidentiality": app:too-secret,
  "integrity": 'none',
  "object": ... base64-encoded image ...
}
</code></pre>
      <p>Once the receiver inspects the <a class="idl-code" data-link-type="attribute" href="#dom-labeledobject-protectedobject" id="ref-for-dom-labeledobject-protectedobject④">protectedObject</a> of the response, COWL <a data-link-type="dfn" href="#tainted" id="ref-for-tainted⑤">taint</a>s the context and ensures that
      it cannot communicate with anybody.</p>
      <p class="note" role="note"><span>Note,</span> to read the protected object, one must do so in a <a data-link-type="dfn" href="#confined-context" id="ref-for-confined-context④">confined context</a> since reading such a sensitive data would prevent code from communicating
      arbitrarily thereafter.</p>
     </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.7" id="enforcement"><span class="secno">3.7. </span><span class="content">Confinement Enforcement</span><a class="self-link" href="#enforcement"></a></h3>
     <p><em>This sub-section is non-normative</em></p>
     <p>To enforce confinement, COWL ensures that code in a <a data-link-type="dfn">context</a> cannot send data (e.g., via <a data-link-type="dfn" href="https://www.w3.org/TR/webmessaging/#web-messaging" id="ref-for-web-messaging①">cross-document
        messaging</a> or by performing a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#fetching" id="ref-for-fetching①">fetch</a>) to contexts or
        servers that do not preserve the confidentiality of the data.
        Similarly, COWL ensures that a context cannot receive data from a
        context or server that is less trustworthy.</p>
     <h4 class="heading settled" data-level="3.7.1" id="modifications-fetch"><span class="secno">3.7.1. </span><span class="content">Modifications to Fetch</span><a class="self-link" href="#modifications-fetch"></a></h4>
     <p>The Fetch specification SHOULD contain the following
          modifications in order to enable the rest of this
          specification’s work <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>:</p>
     <ol>
      <li data-md="">
       <p>Perform the following step between step 5 and 6 in the
 "<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch" id="ref-for-main-fetch">main fetch</a>" algorithm:</p>
       <ol>
        <li data-md="">
         <p>If <a href="#should-block-fetch">should fetching <var>request</var> be blocked as
  COWL</a> returns <strong>blocked</strong>, set <var>response</var> to a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error">network error</a>.</p>
       </ol>
      <li data-md="">
       <p>Perform the following step between step 13 and 14 in the
 "<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch" id="ref-for-main-fetch①">main fetch</a>" algorithm:</p>
       <ol>
        <li data-md="">
         <p>If <a href="#process-response">process <var>response</var> to <var>request</var> as COWL</a> returns <strong>blocked</strong>, set <var>response</var> to a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error①">network error</a>.</p>
       </ol>
     </ol>
     <h4 class="heading settled" data-level="3.7.2" id="modifications-to-web-messaging"><span class="secno">3.7.2. </span><span class="content">Modifications to Web Messaging</span><a class="self-link" href="#modifications-to-web-messaging"></a></h4>
     <p>The Web Messaging specification SHOULD contain the following
          modifications in order to enable the rest of this
          specification’s work <a data-link-type="biblio" href="#biblio-webmessaging">[WEBMESSAGING]</a>:</p>
     <ol>
      <li data-md="">
       <p>Perform the following step between step 9 and 10 in the <a data-link-type="dfn" href="https://www.w3.org/TR/webmessaging/#posting-messages" id="ref-for-posting-messages">posting messages</a> algorithm:</p>
       <ol>
        <li data-md="">
         <p>Let <var>conf</var> be the current context’s <a data-link-type="dfn" href="#effective-confidentiality-label" id="ref-for-effective-confidentiality-label①">effective
  confidentiality label</a>.</p>
        <li data-md="">
         <p>Let <var>int</var> be the current context’s <a data-link-type="dfn" href="#effective-integrity-label" id="ref-for-effective-integrity-label①">effective
  integrity label</a>.</p>
        <li data-md="">
         <p>Let <var>dstState</var> be the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state⑤">COWL state</a> associated with the <code><a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/html5/dom.html#the-document-object" id="ref-for-the-document-object">Document</a></code> of the <code><a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/html5/browsers.html#window" id="ref-for-window">Window</a></code> object on which the
  method was invoked.</p>
        <li data-md="">
         <p>Let <var>dstConf</var> be the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦①">Label</a> returned
  by the <a data-link-type="dfn" href="#label-upgrade" id="ref-for-label-upgrade①">label upgrade</a> algorithm when invoked with the <var>dstState</var> <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label④">context confidentiality label</a> and <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①④">context privilege</a>.</p>
         <p class="note" role="note"><span>Note,</span> in using the <a data-link-type="dfn" href="#label-upgrade" id="ref-for-label-upgrade②">label upgrade</a> COWL flexibly assumes
  that receivers wish to receive data potentially sensitive to
  their origin (really data they can declassify with their <a data-link-type="dfn" href="#privilege" id="ref-for-privilege①⓪">privileges</a>).</p>
        <li data-md="">
         <p>Let <var>dstInt</var> be the <var>dstState</var> <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label④">context
  integrity label</a>.</p>
        <li data-md="">
         <p>If <var>dstConf</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes③">subsume</a> <var>conf</var> or if <var>int</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes④">subsume</a> <var>dstInt</var>, then abort the
  remaining steps silently.</p>
       </ol>
      <li data-md="">
       <p>Perform the following step between step 9 and 10 in the <a data-link-type="dfn" href="https://www.w3.org/TR/webmessaging/#dom-messageport-postmessage" id="ref-for-dom-messageport-postmessage">MessagePort <code>postMessage()</code></a> method:</p>
       <ol>
        <li data-md="">
         <p>Let <var>conf</var> be the current context’s <a data-link-type="dfn" href="#effective-confidentiality-label" id="ref-for-effective-confidentiality-label②">effective
  confidentiality label</a>.</p>
        <li data-md="">
         <p>Let <var>int</var> be the current context’s <a data-link-type="dfn" href="#effective-integrity-label" id="ref-for-effective-integrity-label②">effective
  integrity label</a>.</p>
        <li data-md="">
         <p>Let <var>dstState</var> be the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state⑥">COWL state</a> associated with the <a data-link-type="dfn" href="https://www.w3.org/TR/webmessaging/#concept-port-owner" id="ref-for-concept-port-owner">owner</a> of the <code>target
  port</code> the <a data-link-type="dfn" href="https://www.w3.org/TR/webmessaging/#messageport" id="ref-for-messageport">Message Port</a> <code>postMessage()</code> was called on.</p>
        <li data-md="">
         <p>Else, let <var>dstConf</var> be the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦②">Label</a> returned by the <a data-link-type="dfn" href="#label-upgrade" id="ref-for-label-upgrade③">label upgrade</a> algorithm when invoked with
  the <var>dstState</var> <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label⑤">context confidentiality label</a> and <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①⑤">context privilege</a>.</p>
         <p class="note" role="note"><span>Note,</span> in using the <a data-link-type="dfn" href="#label-upgrade" id="ref-for-label-upgrade④">label upgrade</a> COWL flexibly assumes
  that receivers wish to receive data potentially sensitive to
  their origin (really data they can declassify with their <a data-link-type="dfn" href="#privilege" id="ref-for-privilege①①">privileges</a>).</p>
        <li data-md="">
         <p>Let <var>dstInt</var> be the <var>dstState</var> <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label⑤">context
  integrity label</a>.</p>
        <li data-md="">
         <p>If <var>dstConf</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes⑤">subsume</a> <var>conf</var> or if <var>int</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes⑥">subsume</a> <var>dstInt</var>, then abort the
  remaining steps.</p>
       </ol>
     </ol>
     <h4 class="heading settled" data-level="3.7.3" id="modifications-to-html5"><span class="secno">3.7.3. </span><span class="content">Modifications to HTML5</span><a class="self-link" href="#modifications-to-html5"></a></h4>
     <p>When <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode⑤">confinement mode</a> is enabled the user agent MUST
          ensure that content cannot access other content from the
          same origin (e.g., using an iframe’s <code><a data-link-type="element-attr" href="https://www.w3.org/TR/html5/embedded-content-0.html#dom-iframe-contentdocument" id="ref-for-dom-iframe-contentdocument">contentDocument</a></code>) that would violate
          label restrictions. Specifically, if a <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#windows" id="ref-for-windows⑤">browsing
            context</a>’s <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode⑥">confinement mode</a> is enabled
          the user agent MUST set the following flags
          of the context’s <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#active-sandboxing-flag-set" id="ref-for-active-sandboxing-flag-set">active sandboxing flag set</a>:</p>
     <ul>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#sandboxed-plugins-browsing-context-flag" id="ref-for-sandboxed-plugins-browsing-context-flag">sandboxed plugins browsing context flag</a>.</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#sandboxed-document.domain-browsing-context-flag" id="ref-for-sandboxed-document.domain-browsing-context-flag">sandboxed <code>document.domain</code> browsing context flag</a>.</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#sandboxed-origin-browsing-context-flag" id="ref-for-sandboxed-origin-browsing-context-flag">sandboxed origin browsing context flag</a>.</p>
       <p class="note" role="note"><span>Note,</span> this flag is used to ensure that the browsing context cannot
directly access content of the same origin. It also prevents <a data-link-type="dfn" href="https://www.w3.org/TR/html5/dom.html#sandboxCookies" id="ref-for-sandboxCookies">script from reading from or writing to the <code>document.cookie</code> IDL attribute</a>, and blocks access
to <code>localStorage</code>. <a data-link-type="biblio" href="#biblio-webstorage">[WEBSTORAGE]</a></p>
       <p class="issue" id="issue-af89ca42"><a class="self-link" href="#issue-af89ca42"></a> is there a better way for us to just disallow direct DOM
access and preserve same-origin?</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#sandboxed-navigation-browsing-context-flag" id="ref-for-sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing context flag</a>.</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#sandboxed-auxiliary-navigation-browsing-context-flag" id="ref-for-sandboxed-auxiliary-navigation-browsing-context-flag">sandboxed auxiliary navigation browsing context flag</a>.</p>
      <li data-md="">
       <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#sandboxed-top-level-navigation-browsing-context-flag" id="ref-for-sandboxed-top-level-navigation-browsing-context-flag">sandboxed top-level navigation browsing context flag</a>.</p>
     </ul>
     <h4 class="heading settled" data-level="3.7.4" id="modifications-websockets"><span class="secno">3.7.4. </span><span class="content">Modifications to WebSockets</span><a class="self-link" href="#modifications-websockets"></a></h4>
     <p>When <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode⑦">confinement mode</a> is enabled the user agent MUST ensure
          that code cannot leak information by either creating a new WebSocket
          or writing to an existing (otherwise disallowed) WebSocket. To this
          end, the WebSockets specification SHOULD contain the following
          modification in order to enable the rest of this specification’s
          work <a data-link-type="biblio" href="#biblio-websockets">[WEBSOCKETS]</a>:</p>
     <ul>
      <li data-md="">
       <p>Perform the following steps between step 6 and 7 in the <a data-link-type="functionish" href="https://www.w3.org/TR/websockets/#dom-websocket" id="ref-for-dom-websocket">WebSocket()</a> constructor:</p>
       <ol>
        <li data-md="">
         <p>Let <var>dstConf</var> be the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦③">Label</a> created by invoking
 the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label⑨">Label(principal)</a> with the <var>url</var> argument
 that was passed to the constructor.</p>
        <li data-md="">
         <p>Let <var>canWrite</var> be the result of invoking
 the <a data-link-type="dfn" href="#write-check" id="ref-for-write-check③">write check</a> algorithm with <var>dstConf</var> and the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label⑦">empty label</a>.</p>
        <li data-md="">
         <p>If <var>canWrite</var> is <code>false</code>, throw a <code>SecurityError</code> exception.</p>
         <p>The user agent SHOULD report a warning that the current context
 may have attempted to leak data to a remote server.</p>
       </ol>
       <p class="note" role="note"><span>Note,</span> only the confidentiality label plays a role in this step
 since conceptually, the integrity label of a server is the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label⑧">empty label</a> and, thus, always subsumed.</p>
     </ul>
     <p>To prevent leaks via already established WebSockets, if the <a data-link-type="dfn" href="#effective-confidentiality-label" id="ref-for-effective-confidentiality-label③">effective confidentiality label</a> or integrity label of the 
          current context are not the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label⑨">empty label</a> the user agent MUST
          additionally perform the following step:</p>
     <ul>
      <li data-md="">
       <p>For each created WebSocket <var>ws</var> associated with the current execution context:</p>
       <ol>
        <li data-md="">
         <p>Let <var>dstConf</var> be the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦④">Label</a> created by invoking
the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label①⓪">Label(principal)</a> with the <a href="https://www.w3.org/TR/websockets/#dom-websocket-url">url</a> attribute of the <var>ws</var> object.</p>
        <li data-md="">
         <p>Let <var>canWrite</var> be the result of invoking
the <a data-link-type="dfn" href="#write-check" id="ref-for-write-check④">write check</a> algorithm with <var>dstConf</var> and the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①⓪">empty label</a>.</p>
        <li data-md="">
         <p>If <var>canWrite</var> is <code>false</code> or the <a data-link-type="dfn" href="#current-integrity-label" id="ref-for-current-integrity-label⑧">current integrity label</a> is not the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①①">empty label</a>, the user agent is to <a data-link-type="dfn" href="https://www.w3.org/TR/websockets/#make-disappear" id="ref-for-make-disappear">make
disappear</a> the <var>ws</var> object.</p>
       </ol>
     </ul>
     <p class="note" role="note"><span>Note,</span> it is sufficient for user agents to perform this step when the
            context enables <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode⑧">confinement mode</a> and whenever it gets <a data-link-type="dfn" href="#tainted" id="ref-for-tainted⑥">tainted</a>.</p>
     <div class="note" role="note"> This step closes any WebSockets that are deemed unsafe for
             the current context to communicate with. This may be because it
             may be possible for the context to leak overly-confidential data
             to the remote server; or, it may be because the <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label⑥">context
             integrity label</a> is set and thus the (high integrity) context
             should not be affected by reading potentially less trustworthy
             data from the remote server. </div>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="algorithms"><span class="secno">4. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
    <section>
     <h3 class="heading settled" data-level="4.1" id="reduce-to-normal-form"><span class="secno">4.1. </span><span class="content">Label Normal Form Reduction</span><a class="self-link" href="#reduce-to-normal-form"></a></h3>
      The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label-normal-form-reduction">label normal form reduction</dfn> algorithm takes a <var>label</var> argument and produces a <a data-link-type="dfn" href="#label" id="ref-for-label②④">Label</a> value
    according to the following steps: 
     <ol>
      <li data-md="">
       <p>Let <var>lset</var> be the <a data-link-type="dfn" href="#label-set" id="ref-for-label-set⑥">label set</a> of an <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①②">empty label</a>.</p>
      <li data-md="">
       <p>For each <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set⑦">disjunction set</a> <var>dset</var> in the <a data-link-type="dfn" href="#label-set" id="ref-for-label-set⑦">label set</a> of <var>label</var>:</p>
       <ol>
        <li data-md="">
         <p>If there is no <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set⑧">disjunction set</a> in <var>lset</var> that is a subset of <var>dset</var>, then:</p>
         <ol>
          <li data-md="">
           <p>Remove every <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set⑨">disjunction set</a> in <var>lset</var> that <var>dset</var> is a subset of.</p>
          <li data-md="">
           <p>Add <var>dset</var> to <var>lset</var>.</p>
         </ol>
       </ol>
      <li data-md="">
       <p>Return a newly created <a data-link-type="dfn" href="#label" id="ref-for-label②⑤">Label</a> whose <a data-link-type="dfn" href="#label-set" id="ref-for-label-set⑧">label set</a> is <var>lset</var>.</p>
     </ol>
     <p class="note" role="note"><span>Note,</span> this algorithms assumes that <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set①⓪">disjunction sets</a> and <a data-link-type="dfn" href="#label-set" id="ref-for-label-set⑨">label sets</a> do not have duplicate elements, much like
    mathematical sets.</p>
     <div class="example" id="example-b02bb67d">
      <a class="self-link" href="#example-b02bb67d"></a> The <a data-link-type="dfn" href="#label" id="ref-for-label②⑥">Label</a> API uses this algorithm to ensure that labels
      don’t have redundant information. Consider for example, the
      following labels: 
<pre><code>var a    = <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label①①">Label("https://a.com")</a>;  // https://a.com
var aORb = <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label①②">Label("https://a.com")</a>.<a data-link-type="functionish" href="#dom-label-or" id="ref-for-dom-label-or">or("https://b.com")</a>; // https://a.com OR https://b.com
var a2   = a.<a data-link-type="functionish" href="#dom-label-and" id="ref-for-dom-label-and①">and(aORb)</a>; // (https://a.com) AND (https://a.com OR https://b.com) ≡ https://a.com
</code></pre>
      <p>The label <code>a2</code> is equivalent to <code>a</code> (since <code>a.<a data-link-type="functionish" href="#dom-label-subsumes" id="ref-for-dom-label-subsumes②">subsumes(aORb)</a></code>):</p>
<pre><code>a2.toString() === "https://a.com";
a2.<a data-link-type="functionish" href="#dom-label-equals" id="ref-for-dom-label-equals①">equals(a)</a>;
</code></pre>
     </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.2" id="subsumes-check"><span class="secno">4.2. </span><span class="content">Label Subsumption</span><a class="self-link" href="#subsumes-check"></a></h3>
      The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label-subsumption">label subsumption</dfn> algorithm takes a two labels <var>A</var> and <var>B</var> and produces a boolean according to
    these steps: 
     <ol>
      <li data-md="">
       <p>If, for each <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set①①">disjunction set</a> <var>b</var> in the <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①⓪">label set</a> of <var>B</var> there is <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set①②">disjunction set</a> <var>a</var> in the <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①①">label set</a> of <var>A</var> such that <var>a</var> is a <em>subset</em> of <var>b</var>, return <code>true</code>.</p>
      <li data-md="">
       <p>Else, return <code>false</code>.</p>
     </ol>
     <p class="note" role="note"><span>Note,</span> when interpreting labels as mathematical formulae, <a data-link-type="dfn" href="#label-subsumption" id="ref-for-label-subsumption①">label
    subsumption</a> is logical implication: <var>A</var> subsumes <var>B</var> is equivalent as <var>A</var> <em>implies</em> <var>B</var>, i.e, <var>A</var>⇒<var>B</var>.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.3" id="alg-label-downgrade"><span class="secno">4.3. </span><span class="content">Label Downgrade</span><a class="self-link" href="#alg-label-downgrade"></a></h3>
      The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label-downgrade">label downgrade</dfn> algorithm takes a label <var>label</var> and
    a privilege <var>priv</var>, and returns the least restricting label
    according to the following steps: 
     <ol>
      <li data-md="">
       <p>Let <var>privLabel</var> be the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①⑧">internal privilege label</a> of <var>priv</var>.</p>
      <li data-md="">
       <p>Let <var>lset</var> be the <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①②">label set</a> of an <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①③">empty label</a>.</p>
      <li data-md="">
       <p>For each <a data-link-type="dfn" href="#disjunction-set" id="ref-for-disjunction-set①③">disjunction set</a> <var>dset</var> in the <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①③">label set</a> of <var>label</var>:</p>
       <ol>
        <li data-md="">
         <p>Let <var>cur</var> be a newly created <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦⑤">Label</a> whose <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①④">label set</a> is <var>dset</var>.</p>
        <li data-md="">
         <p>If <var>privLabel</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes⑦">subsume</a> <var>cur</var>, add <var>dset</var> to <var>lset</var>.</p>
       </ol>
      <li data-md="">
       <p>Return a newly created <a data-link-type="dfn" href="#label" id="ref-for-label②⑦">Label</a> whose <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①⑤">label set</a> is <var>lset</var>.</p>
     </ol>
     <p class="note" role="note"><span>Note,</span> <a data-link-type="dfn" href="#label-downgrade" id="ref-for-label-downgrade①">label downgrade</a> removes every disjunction set
    permitted by <var>priv</var>. This is used to safely declassify
    data labeled <var>label</var>.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.4" id="alg-label-upgrade"><span class="secno">4.4. </span><span class="content">Label Upgrade</span><a class="self-link" href="#alg-label-upgrade"></a></h3>
      The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="label-upgrade">label upgrade</dfn> algorithm takes a label <var>label</var> and a
    privilege <var>priv</var>, and returns the most permissive label according
    to the following steps: 
     <ol>
      <li data-md="">
       <p>Let <var>privLabel</var> be the <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label①⑨">internal privilege label</a> of <var>priv</var>.</p>
      <li data-md="">
       <p>Return <code><var>label</var>.<a data-link-type="functionish" href="#dom-label-and" id="ref-for-dom-label-and②">and(<var>privLabel</var>)</a></code>.</p>
     </ol>
     <p class="note" role="note"><span>Note,</span> <a data-link-type="dfn" href="#label-upgrade" id="ref-for-label-upgrade⑤">label upgrade</a> is the dual of <a data-link-type="dfn" href="#label-downgrade" id="ref-for-label-downgrade②">label downgrade</a>.
    This can be used to safely endorse data labeled <var>label</var> (and thus potentially already endorsed).</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.5" id="taint-context"><span class="secno">4.5. </span><span class="content">Context Tainting</span><a class="self-link" href="#taint-context"></a></h3>
      The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="context-tainting">context tainting</dfn> algorithm takes a two labels, <var>confidentiality</var> and <var>integrity</var>, and updates the <a data-link-type="dfn" href="#context-labels" id="ref-for-context-labels③">context labels</a> to allow for reading data labeled with these labels.
    If the context is an <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context⑥">unconfined context</a> and tainting the
    context would change its <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state⑦">COWL state</a>, the algorithm throws a <code>SecurityError</code> exception. The user agent MUST use an algorithm
    whose behavior is as follows: 
     <ol>
      <li data-md="">
       <p>Let <var>currentConf</var> be the current <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label⑥">context
 confidentiality label</a>.</p>
      <li data-md="">
       <p>Let <var>currentInt</var> be the current <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label⑦">context
 integrity label</a>.</p>
      <li data-md="">
       <p>Let <var>newConf</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label②⑧">Label</a> returned by the by
 the <a data-link-type="dfn" href="#label-downgrade" id="ref-for-label-downgrade③">label downgrade</a> algorithm when invoked with <var>currentConf</var>.<a data-link-type="functionish" href="#dom-label-and" id="ref-for-dom-label-and③">and(<var>confidentiality</var>)</a> and <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①③">current privilege</a>.</p>
      <li data-md="">
       <p>Let <var>newInt</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label②⑨">Label</a> returned by the <a data-link-type="dfn" href="#label-downgrade" id="ref-for-label-downgrade④">label downgrade</a> algorithm when invoked with <var>currentInt</var>.<a data-link-type="functionish" href="#dom-label-or" id="ref-for-dom-label-or①">or(<var>integrity</var>)</a> and <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①④">current
 privilege</a>.</p>
      <li data-md="">
       <p>If the current context is an <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context⑦">unconfined context</a> and
 either <var>newConf</var> or <var>newInt are not the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①④">empty label</a>, throw a <code>SecurityError</code> exception
 and terminate this algorithm.</var></p>
      <li data-md="">
       <p>Set the <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label⑦">context confidentiality label</a> to <var>newConf</var>.</p>
      <li data-md="">
       <p>Set the <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label⑧">context integrity label</a> to <var>newInt</var>.</p>
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.6" id="alg-write-check"><span class="secno">4.6. </span><span class="content">Write Check</span><a class="self-link" href="#alg-write-check"></a></h3>
      The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="write-check">write check</dfn> algorithm takes two labels, <var>objConf</var> and <var>objInt</var>, and returns <code>true</code> if the current context is allowed to write to
    (or create) an entity labeled as such; otherwise, it returns <code>false</code>. The user agent MUST use an algorithm whose
    behavior is as follows: 
     <ol>
      <li data-md="">
       <p>Let <var>currentConf</var> be the current  context’s <a data-link-type="dfn" href="#effective-confidentiality-label" id="ref-for-effective-confidentiality-label④">effective
 confidentiality label</a>.</p>
      <li data-md="">
       <p>Let <var>currentInt</var> be the current context’s <a data-link-type="dfn" href="#effective-integrity-label" id="ref-for-effective-integrity-label③">effective
 integrity label</a>.</p>
      <li data-md="">
       <p>If <var>objConf</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes⑧">subsume</a> <var>currentConf</var> or if <var>currentInt</var> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes⑨">subsume</a> <var>objInt</var>, return <code>false</code>.</p>
      <li data-md="">
       <p>Else, return <code>true</code>.</p>
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.7" id="structured-cloning"><span class="secno">4.7. </span><span class="content">Structured Cloning</span><a class="self-link" href="#structured-cloning"></a></h3>
      When a user agent is required to obtain a <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone" id="ref-for-structured-clone③">structured clone</a> of an object whose type is defined in this document, it MUST use
    an algorithm whose behavior is as follows: 
     <ol>
      <li data-md="">
       <p>Let <var>input</var> be the value being cloned.</p>
      <li data-md="">
       <p>If <var>input</var> is a <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦⑥">Label</a> object, let <var>output</var> be a newly constructed <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦⑦">Label</a> object with the same <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①⑥">label set</a> as that of <var>input</var>.</p>
      <li data-md="">
       <p>If <var>input</var> is a <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①②①">Privilege</a> object, then:</p>
       <ol>
        <li data-md="">
         <p>If the <var>input</var>’s <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label②⓪">internal privilege label</a> <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes①⓪">subsumes</a> any label whose <a data-link-type="dfn" href="#label-set" id="ref-for-label-set①⑦">label set</a> is a singleton <a data-link-type="dfn" href="#origin-principal" id="ref-for-origin-principal①">origin principal</a>, let <var>output</var> be <code>null</code>.</p>
        <li data-md="">
         <p>Else, let <var>output</var> be a newly constructed <a class="idl-code" data-link-type="interface" href="#privilege①" id="ref-for-privilege①②②">Privilege</a> object with the same <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label②①">internal privilege
 label</a> as that of <var>input</var>.</p>
       </ol>
       <div class="note" role="note"> To prevent attacks that launder <a data-link-type="dfn" href="#default-privilege" id="ref-for-default-privilege②">default privileges</a>, the current
   version of COWL only allows transferring weaker <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege⑨">delegated
   privileges</a> or privileges constructed with <a data-link-type="functionish" href="#dom-privilege-freshprivilege" id="ref-for-dom-privilege-freshprivilege⑤">FreshPrivilege()</a>.
   The first step above ensures this by setting the <var>output</var> to <code>null</code> if the privilege subsumes any privilege
   corresponding to an <a data-link-type="dfn" href="#origin-principal" id="ref-for-origin-principal②">origin principal</a>. </div>
      <li data-md="">
       <p>If <var>input</var> is a <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②⑦">LabeledObject</a> object, let <var>output</var> be a newly constructed <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②⑧">LabeledObject</a> object whose
 confidentiality and integrity labels are the same as that of <var>input</var>, and whose internal <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object①⓪">protected object</a> is
 a <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone" id="ref-for-structured-clone④">structured clone</a> of the <a data-link-type="dfn" href="#protected-object" id="ref-for-protected-object①①">protected object</a> of the <var>input</var> <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject②⑨">LabeledObject</a>.</p>
      <li data-md="">
       <p>Return <var>output</var>.</p>
     </ol>
     <p class="note" role="note"><span>Note,</span> cross-context messaging constructs such as <a data-link-type="functionish" href="https://www.w3.org/TR/webmessaging/#dom-window-postmessage" id="ref-for-dom-window-postmessage④">postMessage()</a> use the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone" id="ref-for-structured-clone⑤">structured clone</a> algorithm
    (e.g., see the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#internal-structured-cloning-algorithm" id="ref-for-internal-structured-cloning-algorithm">internal structured cloning algorithm</a>).
    This algorithm is used to allow  authors to transfer COWL
    object, such as <a class="idl-code" data-link-type="interface" href="#labeledobject" id="ref-for-labeledobject③⓪">LabeledObject</a>s, to other contexts.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.8" id="should-block-fetch"><span class="secno">4.8. </span><span class="content"> Should fetching <var>request</var> be blocked as COWL? </span><a class="self-link" href="#should-block-fetch"></a></h3>
     <div class="note" role="note"> Note: this algorithm is used to determine whether a request should
      be entirely blocked, because it may potentially leak sensitive
      data to an unauthorized server. </div>
     <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">Request</a> <var>request</var>, a user agent determines
    whether the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">Request</a> <var>request</var> should proceed or
    not via the following algorithm:</p>
     <ol>
      <li data-md="">
       <p>Let <var>context</var> be the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client">client</a> associated with the <var>request</var>.</p>
      <li data-md="">
       <p>If <var>context</var> is null, let <var>context</var> be the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object" id="ref-for-incumbent-settings-object">incumbent settings object</a>.</p>
       <p class="note" role="note"><span>Note,</span> the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①">client</a> associated with the <var>request</var> is null when <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#navigate" id="ref-for-navigate">navigating</a>, so we use
 the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object" id="ref-for-incumbent-settings-object①">incumbent settings object</a> to get the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state⑧">COWL
 state</a> of the <a data-link-type="dfn">context</a> that initiated the request.</p>
      <li data-md="">
       <p>Let <var>state</var> be the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state⑨">COWL state</a> retrieved via the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/webappapis.html#settings-object" id="ref-for-settings-object">environment settings object</a> <var>context</var>.</p>
      <li data-md="">
       <p>If the <var>state</var> <a data-link-type="dfn" href="#confinement-mode" id="ref-for-confinement-mode⑨">confinement mode</a> is not
 enabled, return <strong>allowed</strong> and terminate this
 algorithm.</p>
      <li data-md="">
       <p>Let <var>conf</var> be the <var>state</var> <a data-link-type="dfn" href="#effective-confidentiality-label" id="ref-for-effective-confidentiality-label⑤">effective confidentiality label</a>.</p>
      <li data-md="">
       <p>Let <var>dstConf</var> be the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦⑧">Label</a> created by invoking
 the <a data-link-type="functionish" href="#dom-label-label" id="ref-for-dom-label-label①③">Label(principal)</a> constructor with the stringified <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2⑧">origin</a> of the <a href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> associated with the <var>request</var>.</p>
      <li data-md="">
       <p>If <var>dstConf</var> <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes①①">subsumes</a> <var>conf</var>, return <strong>allowed</strong>.</p>
      <li data-md="">
       <p>Else, return <strong>blocked</strong>.</p>
       <p>The user agent SHOULD report a warning that the context
 attempted to leak data to a remote server.</p>
     </ol>
     <p class="note" role="note"><span>Note,</span> the integrity label of the current context is not used in
    this algorithm since, conceptually, the integrity label of a
    server is the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①⑤">empty label</a> and, thus, always subsumed.
    Server operators SHOULD check the <a href="#request-header"><code>Sec-COWL</code></a> request header
    to ensure untrustworthy data does not affect the computation in an
    unsafe way.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.9" id="process-response"><span class="secno">4.9. </span><span class="content"> Process <var>response</var> to <var>request</var> as COWL </span><a class="self-link" href="#process-response"></a></h3>
     <div class="note" role="note">
       <a href="#should-block-fetch">If a request proceeds</a>, we
      still might want to block the response based on the <a data-link-type="dfn" href="#labeled-data-metadata" id="ref-for-labeled-data-metadata⑤">labeled
      data metadata</a> of the response. For example, if the <a data-link-type="dfn" href="#current-confidentiality-label" id="ref-for-current-confidentiality-label⑦">current confidentiality label</a> does not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes①②">subsume</a> the
      confidentiality label of the response, the user agent MUST block
      the response since it could otherwise violate the confidentiality
      of the response data. (The dual holds for integrity.) This
      algorithm is used to make the determination of whether or not a
      response is blocked. 
      <p>This algorithm is also used to set the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state①⓪">COWL state</a> for
      new documents and Workers according to the server-supplied <a data-link-type="dfn" href="#labeled-context-metadata" id="ref-for-labeled-context-metadata⑤">labeled context metadata</a>.</p>
     </div>
     <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">Request</a> <var>request</var> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②">Response</a> <var>response</var>, a user agent determines
    whether the response should be returned via the following algorithm:</p>
     <ol>
      <li data-md="">
       <p>If the <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a> has no <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header①">header</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-name" id="ref-for-concept-header-name">name</a> is <code>Sec-COWL</code>, return <strong>allowed</strong> and
 terminate this algorithm.</p>
      <li data-md="">
       <p>Let <var>destination</var> be the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination">destination</a>.</p>
      <li data-md="">
       <p>Let <var>context</var> be the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client②">client</a> associated with the <var>request</var>.</p>
      <li data-md="">
       <p>If <var>context</var> is null, let <var>context</var> be the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object" id="ref-for-incumbent-settings-object②">incumbent settings object</a>.</p>
       <p class="note" role="note"><span>Note,</span> the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client③">client</a> associated with the <var>request</var> is null when <a data-link-type="dfn" href="https://www.w3.org/TR/html5/browsers.html#navigate" id="ref-for-navigate①">navigating</a>, so we use
 the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object" id="ref-for-incumbent-settings-object③">incumbent settings object</a> to get or set the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state①①">COWL
 state</a> of the <a data-link-type="dfn">context</a> that initiated the request.</p>
      <li data-md="">
       <p>Let <var>state</var> be the <a data-link-type="dfn" href="#cowl-state" id="ref-for-cowl-state①②">COWL state</a> retrieved via the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/webappapis.html#settings-object" id="ref-for-settings-object①">environment settings object</a> <var>context</var>.</p>
      <li data-md="">
       <p>Let <var>metadata</var> be
 the <em>first</em> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header②">header</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-name" id="ref-for-concept-header-name①">name</a> is <code>Sec-COWL</code> in the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③">response</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list①">header list</a>.</p>
      <li data-md="">
       <p>If <var>destination</var> is <code>"document"</code>, <code>"worker"</code> or <code>"serviceworker"</code>:</p>
       <ol start="0">
        <li data-md="">
         <p>Let <var>self</var> be the serialization of the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2⑨">origin</a> retrieved via the <a data-link-type="dfn" href="https://www.w3.org/TR/html5/webappapis.html#settings-object" id="ref-for-settings-object②">environment settings object</a> <var>context</var>.</p>
        <li data-md="">
         <p>Let <var>conf</var>, <var>int</var>, <var>priv</var> be the
  result of calling the <a data-link-type="dfn" href="#parse-labeled-context-metadata" id="ref-for-parse-labeled-context-metadata">parse labeled context
  metadata</a> algorithm with <var>metadata</var> and <var>self</var>.</p>
        <li data-md="">
         <p>If either <var>conf</var>, <var>int</var>, or <var>priv</var> are null, return <strong>blocked</strong>.</p>
         <p>The user agent SHOULD report a warning that the server supplied a
  malformed <code>Sec-COWL</code> header.</p>
        <li data-md="">
         <p>Else:</p>
         <ol>
          <li data-md="">
           <p>If <var>context is an <a data-link-type="dfn" href="#unconfined-context" id="ref-for-unconfined-context⑧">unconfined context</a>,
 return <strong>blocked</strong> and terminate this algorithm.</var></p>
           <p>The user agent SHOULD report a warning that the application
 attempted to embed confined content outside a <a data-link-type="dfn">cowl iframe</a>.</p>
          <li data-md="">
           <p>If <var>priv</var> is not a <a data-link-type="dfn" href="#delegated-privilege" id="ref-for-delegated-privilege①⓪">delegated privilege</a> of the <var>state</var> <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①⑥">context privilege</a>, return <strong>blocked</strong> and terminate this algorithm.</p>
           <p>The user agent SHOULD report a warning that the server supplied
 a privilege that it is not trusted for.</p>
          <li data-md="">
           <p>If the <var>state</var> <a data-link-type="dfn" href="#effective-integrity-label" id="ref-for-effective-integrity-label④">effective integrity label</a> does
 not <a data-link-type="dfn" href="#subsumes" id="ref-for-subsumes①③">subsume</a> <var>int</var>, return <strong>blocked</strong> and terminate this algorithm.</p>
           <p>The user agent SHOULD report a warning that the server supplied
 an integrity label that it is not trusted for.</p>
          <li data-md="">
           <p>Set the <var>state</var> <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label⑧">context confidentiality label</a> to <var>conf</var>.</p>
          <li data-md="">
           <p>Set the <var>state</var> <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label⑨">context integrity label</a> to <var>int</var>.</p>
           <p class="note" role="note"><span>Note,</span> by performing the <a data-link-type="dfn" href="#label-subsumption" id="ref-for-label-subsumption②">label subsumption</a> check (step 3
 above) before setting the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①⑦">context privilege</a> (next step),
 the <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label①⓪">context integrity label</a> can be upgraded from the <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①⑥">empty label</a>, while allowing the <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①⑧">context privilege</a> to also be dropped.</p>
          <li data-md="">
           <p>Set the <var>state</var> <a data-link-type="dfn" href="#context-privilege" id="ref-for-context-privilege①⑨">context privilege</a> to <var>priv</var>.</p>
          <li data-md="">
           <p>Return <strong>allowed</strong>.</p>
         </ol>
       </ol>
      <li data-md="">
       <p>Else:</p>
       <ol>
        <li data-md="">
         <p>Let <var>self</var> be the origin of the <a href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> associated with the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④">response</a>.</p>
        <li data-md="">
         <p>Let <var>conf</var> and <var>int</var> be the
 results of calling the <a data-link-type="dfn" href="#parse-labeled-data-metadata" id="ref-for-parse-labeled-data-metadata">parse labeled data metadata</a> with <var>metadata</var> and <var>self</var>.</p>
        <li data-md="">
         <p>If either <var>conf</var> or <var>int</var> is null,
 return <strong>blocked</strong> and terminate this algorithm.</p>
         <p>The user agent SHOULD report a warning that the server supplied a
 malformed <code>Sec-COWL</code> header.</p>
        <li data-md="">
         <p>Let <var>effConf</var> be the <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑦⑨">Label</a> returned by the <a data-link-type="dfn" href="#label-downgrade" id="ref-for-label-downgrade⑤">label downgrade</a> algorithm when invoked with <var>conf</var> and
 the <var>state</var> <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①⑤">current privilege</a>.</p>
         <p class="note" role="note"><span>Note,</span> <var>effConf</var> is the <em>effective confidentiality label of
 the response</em>—COWL flexibly declassifies responses (as much as
 the <a data-link-type="dfn" href="#current-privilege" id="ref-for-current-privilege①⑥">current privilege</a> permits).</p>
        <li data-md="">
         <p>If the <var>state</var> <a data-link-type="dfn" href="#context-confidentiality-label" id="ref-for-context-confidentiality-label⑨">context confidentiality
 label</a> subsumes <var>effConf</var> and <var>int</var> subsumes the <var>state</var> <a data-link-type="dfn" href="#effective-integrity-label" id="ref-for-effective-integrity-label⑤">effective integrity
 label</a>, return <strong>allowed</strong>.</p>
        <li data-md="">
         <p>Else, return <strong>blocked</strong>.</p>
         <p class="note" role="note"><span>Note,</span> COWL conservatively blocks a response that is
 potentially more confidential or less trustworthy than the
 context making the request. In future versions of COWL,
 certain responses (e.g., images) which are only not as
 trustworthy as the <a data-link-type="dfn" href="#context-integrity-label" id="ref-for-context-integrity-label①①">context integrity label</a> may be allowed by the user agent.</p>
       </ol>
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.10" id="parse-labeled-metadata-data"><span class="secno">4.10. </span><span class="content"> Parse labeled data metadata </span><a class="self-link" href="#parse-labeled-metadata-data"></a></h3>
     <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="parse-labeled-data-metadata">parse <a data-link-type="dfn" href="#labeled-data-metadata" id="ref-for-labeled-data-metadata⑥">labeled data metadata</a></dfn> <var>metadata</var> for
    origin <var>self</var>, the user agent MUST use an algorithm
    equivalent to the following:</p>
     <ol>
      <li data-md="">
       <p>Let <var>conf</var> be null.</p>
      <li data-md="">
       <p>Let <var>int</var> be null.</p>
      <li data-md="">
       <p>For each non-empty token returned by <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string" id="ref-for-strictly-split-a-string">strictly splitting</a> the string <var>metadata</var> on the character U+003B SEMICOLON (<code>;</code>):</p>
       <ol>
        <li data-md="">
         <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#skip-whitespace" id="ref-for-skip-whitespace">Skip whitespace</a>.</p>
        <li data-md="">
         <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters" id="ref-for-collect-a-sequence-of-characters">Collect a sequence of characters</a> that are
  not <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#space-character" id="ref-for-space-character">space characters</a>. The collected characters
  are the <var>directive name</var>.</p>
        <li data-md="">
         <p>If there are characters remaining in <var>token</var>,
  skip ahead exactly one character (which must be a <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#space-character" id="ref-for-space-character①">space character</a>).</p>
        <li data-md="">
         <p>The remaining characters in <var>token</var> (if any) are
  the <var>directive value</var>.</p>
        <li data-md="">
         <p>Let <var>label value</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label③⓪">label</a> returned by
  invoking the <a data-link-type="dfn" href="#parse-label-expression①" id="ref-for-parse-label-expression①">parse label-expression</a> algorithm with the <var>directive value</var> and <var>self</var>.  If parsing
  failed, terminate the rest of these sub-steps.</p>
         <p>The user agent SHOULD report a warning that the server provided a
  malformed label directive.</p>
        <li data-md="">
         <p>If <var>directive name</var> is <a data-link-type="dfn" href="#data-confidentiality" id="ref-for-data-confidentiality④"><code>data-confidentiality</code></a> and <var>conf</var> is null, let <var>conf</var> be <var>label
  value</var>.</p>
        <li data-md="">
         <p>Else, if <var>directive name</var> is <a data-link-type="dfn" href="#data-integrity" id="ref-for-data-integrity③"><code>data-integrity</code></a> and <var>int</var> is null,
  let <var>int</var> be <var>label value</var>.</p>
        <li data-md="">
         <p>Else, terminate the rest of these sub-steps.</p>
         <p>The user agent SHOULD report a warning that the server provided a
  malformed label directive.</p>
       </ol>
      <li data-md="">
       <p>Return <var>conf</var> and <var>int</var>.</p>
     </ol>
     <div class="note" role="note"> To make it easier for developers to debug applications, user
      agents SHOULD report the directives that were ignored. </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.11" id="parse-labeled-metadata-ctx"><span class="secno">4.11. </span><span class="content"> Parse labeled context metadata </span><a class="self-link" href="#parse-labeled-metadata-ctx"></a></h3>
     <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="parse-labeled-context-metadata">parse <a data-link-type="dfn" href="#labeled-context-metadata" id="ref-for-labeled-context-metadata⑥">labeled context metadata</a></dfn> <var>metadata</var> for
    origin <var>self</var>, the user agent MUST use an algorithm
    equivalent to the following:</p>
     <ol>
      <li data-md="">
       <p>Let <var>conf</var> be null.</p>
      <li data-md="">
       <p>Let <var>int</var> be null.</p>
      <li data-md="">
       <p>Let <var>priv</var> be null.</p>
      <li data-md="">
       <p>For each non-empty token returned by <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string" id="ref-for-strictly-split-a-string①">strictly splitting</a> the string <var>metadata</var> on the character U+003B SEMICOLON (<code>;</code>):</p>
       <ol>
        <li data-md="">
         <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#skip-whitespace" id="ref-for-skip-whitespace①">Skip whitespace</a>.</p>
        <li data-md="">
         <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters" id="ref-for-collect-a-sequence-of-characters①">Collect a sequence of characters</a> that are
  not <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#space-character" id="ref-for-space-character②">space characters</a>. The collected characters
  are the <var>directive name</var>.</p>
        <li data-md="">
         <p>If there are characters remaining in <var>token</var>,
  skip ahead exactly one character (which must be a <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#space-character" id="ref-for-space-character③">space character</a>).</p>
        <li data-md="">
         <p>The remaining characters in <var>token</var> (if any) are
  the <var>directive value</var>.</p>
        <li data-md="">
         <p>Let <var>label value</var> be the <a data-link-type="dfn" href="#label" id="ref-for-label③①">label</a> returned by
  invoking the <a data-link-type="dfn" href="#parse-label-expression①" id="ref-for-parse-label-expression①①">parse label-expression</a> algorithm with the <var>directive value</var> and <var>self</var>.  If parsing
  failed, terminate the rest of these sub-steps.</p>
         <p>The user agent SHOULD report a warning that the server provided a
  malformed label directive.</p>
        <li data-md="">
         <p>If <var>directive name</var> is <a data-link-type="dfn" href="#ctx-confidentiality" id="ref-for-ctx-confidentiality④"><code>ctx-confidentiality</code></a> and <var>conf</var> is
  null, let <var>conf</var> be <var>label value</var>.</p>
        <li data-md="">
         <p>Else, if <var>directive name</var> is <a data-link-type="dfn" href="#ctx-integrity" id="ref-for-ctx-integrity④"><code>ctx-integrity</code></a> and <var>int</var> is null,
  let <var>int</var> be <var>label value</var>.</p>
        <li data-md="">
         <p>Else, if <var>directive name</var> is <a data-link-type="dfn" href="#ctx-privilege" id="ref-for-ctx-privilege⑦"><code>ctx-privilege</code></a> and <var>priv</var> is null,
  let <var>priv</var> be a newly created <a data-link-type="dfn" href="#privilege" id="ref-for-privilege①②">privilege</a> whose <a data-link-type="dfn" href="#internal-privilege-label" id="ref-for-internal-privilege-label②②">internal privilege label</a> is set to <var>label
  value</var>.</p>
        <li data-md="">
         <p>Else, terminate the rest of these sub-steps.</p>
         <p>The user agent SHOULD report a warning that the server provided a
  malformed label directive.</p>
       </ol>
      <li data-md="">
       <p>Return <var>conf</var>, <var>int</var>, and <var>priv</var>.</p>
     </ol>
     <div class="note" role="note"> To make it easier for developers to debug applications, user
      agents SHOULD report the directives that were ignored. </div>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.12" id="parse-label-expression"><span class="secno">4.12. </span><span class="content"> Parse label expression </span><a class="self-link" href="#parse-label-expression"></a></h3>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="parse-label-expression①">parse <a data-link-type="dfn" href="#label-expression" id="ref-for-label-expression③">label-expression</a></dfn> algorithm takes a <var>input</var> representing a <a data-link-type="dfn" href="#label-expression" id="ref-for-label-expression④">label-expression</a> and a
    stringified origin URL <var>self</var> and returns the parsed <a class="idl-code" data-link-type="interface" href="#label①" id="ref-for-label①⑧⓪">Label</a>. If at any point the algorithm says that it "fails",
    this means that it is aborted at that point and returns nothing.
    The user agent MUST use an algorithm equivalent to the following:</p>
     <ol>
      <li data-md="">
       <p>Let <var>label</var> be a new <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①⑦">empty label</a>.</p>
      <li data-md="">
       <p>If <var>input</var> is not a string, fail.</p>
      <li data-md="">
       <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#strip-and-collapse-whitespace" id="ref-for-strip-and-collapse-whitespace">Strip and collapse whitespace</a> from <var>input</var>.</p>
      <li data-md="">
       <p>Let <var>AND expr</var> be the remaining characters in <var>input</var>.</p>
      <li data-md="">
       <p>If <var>AND expr</var> is the string <code>"'none'"</code>, return <var>label</var> and terminate this algorithm.</p>
      <li data-md="">
       <p><a data-link-type="dfn" href="#split" id="ref-for-split">Split</a> the <var>AND expr</var> string on <code>"AND"</code>. Let <var>AND
 tokens</var> be the resulting list of tokens, if the splitting didn’t
 fail. Otherwise, fail.</p>
      <li data-md="">
       <p>For each token in <var>AND tokens</var>, run the following sub-steps:</p>
       <ol>
        <li data-md="">
         <p>Let <var>input</var> be the token.</p>
        <li data-md="">
         <p>If the number of elements in <var>AND tokens</var> is greater than 1:</p>
         <ol>
          <li data-md="">
           <p>If first character of <var>input</var> is not <code>"("</code> (UA+0028), fail.</p>
          <li data-md="">
           <p>If last character of <var>input</var> is not <code>")"</code> (UA+0029), fail.</p>
          <li data-md="">
           <p>Remove the first and last characters from <var>input</var>.</p>
         </ol>
        <li data-md="">
         <p>Else, if first character of <var>input</var> is <code>"("</code> (UA+0028) or if
  last character of <var>input</var> is <code>")"</code> (UA+0029):</p>
         <ol>
          <li data-md="">
           <p>If first character of <var>input</var> is not <code>"("</code> (UA+0028), fail.</p>
          <li data-md="">
           <p>If last character of <var>input</var> is not <code>")"</code> (UA+0029), fail.</p>
          <li data-md="">
           <p>Remove the first and last characters from <var>input</var>.</p>
         </ol>
        <li data-md="">
         <p>Let <var>OR expr</var> be the remaining characters in <var>input</var>.</p>
        <li data-md="">
         <p>Let <var>orExp</var> be a new <a data-link-type="dfn" href="#empty-label" id="ref-for-empty-label①⑧">empty label</a>.</p>
        <li data-md="">
         <p><a data-link-type="dfn" href="#split" id="ref-for-split①">Split</a> the string <var>OR expr</var> on <code>"OR"</code>. Let <var>OR
  tokens</var> be the resulting list of tokens, if the splitting didn’t
  fail. Otherwise, fail.</p>
        <li data-md="">
         <p>For each token in <var>OR tokens</var>, run the following sub-steps:</p>
         <ol>
          <li data-md="">
           <p>Let <var>prin</var> be the token.</p>
          <li data-md="">
           <p>If <var>prin</var> is the string <code>"'self'"</code>, set <var>prin</var> be <var>self</var>.</p>
          <li data-md="">
           <p>Set <var>orExp</var> to <code><var>orExp</var>.or(<var>prin</var>)</code>,
 if calling the <code>or</code> method didn’t throw an exception. Otherwise, fail.</p>
           <p class="note" role="note"><span>Note,</span> the method throws an exception if <var>prin</var> is not a <a data-link-type="dfn" href="#principal" id="ref-for-principal⑥">principal</a>. Hence, this algorithm should fail.</p>
         </ol>
        <li data-md="">
         <p>Set <var>label</var> to <code><var>label</var>.and(<var>orExp</var>)</code>.</p>
       </ol>
      <li data-md="">
       <p>Return <var>label</var>.</p>
     </ol>
     <p>When a user agent has to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="split">split</dfn> a string on particular
    delimiter characters <var>delimiter</var>, it MUST use an algorithm
    equivalent to the following:</p>
     <ol>
      <li data-md="">
       <p>Let <var>input</var> be the string being split.</p>
      <li data-md="">
       <p>Let <var>position</var> be a pointer into <var>input</var>, initially
 pointing at the start of the string.</p>
      <li data-md="">
       <p>Let <var>delimiter length</var> be the number of characters in <var>delimiter</var>.</p>
      <li data-md="">
       <p>Let <var>tokens</var> be the resulting list of tokens.</p>
      <li data-md="">
       <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace" id="ref-for-strip-leading-and-trailing-whitespace">Strip leading and trailing whitespace</a>.</p>
      <li data-md="">
       <p>If <var>input</var> is the empty string, fail.</p>
      <li data-md="">
       <p>While <var>position</var> is not past the end of <var>input</var>:</p>
       <ol>
        <li data-md="">
         <p>Let <var>s</var> be the empty string.</p>
        <li data-md="">
         <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#skip-whitespace" id="ref-for-skip-whitespace②">Skip whitespace</a>.</p>
        <li data-md="">
         <p>Let <var>done</var> be <code>false</code>.</p>
        <li data-md="">
         <p>While <var>done</var> is <code>false</code> and <var>position</var> is not past
  the end of <var>input</var>:</p>
         <ol>
          <li data-md="">
           <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters" id="ref-for-collect-a-sequence-of-characters②">Collect a sequence of characters</a> that are not <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#space-character" id="ref-for-space-character④">space
  characters</a>. Append the resulting sequence to <var>s</var>.</p>
          <li data-md="">
           <p>If <var>position</var> points past the end of <var>input</var>,
 set <var>done</var> to <code>true</code> and end these sub-steps.</p>
          <li data-md="">
           <p><a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters" id="ref-for-collect-a-sequence-of-characters③">Collect a sequence of characters</a> that are <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#space-character" id="ref-for-space-character⑤">space
 characters</a>. Let <var>ws</var> be the resulting sequence.</p>
          <li data-md="">
           <p>If the next <var>delimiter length</var> characters are an <a data-link-type="dfn" href="https://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive">ASCII case-insensitive</a> match for the string <var>delimiter</var>, then set <var>done</var> to <code>true</code> and advance <var>position</var> by <var>delimiter length</var> characters.</p>
          <li data-md="">
           <p>Else, append <var>ws</var> to <var>s</var>.</p>
         </ol>
        <li data-md="">
         <p>Append <var>s</var> to <var>tokens</var>.</p>
       </ol>
      <li data-md="">
       <p>Return <var>tokens</var>.</p>
     </ol>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="iana-considerations"><span class="secno">5. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
    <h3 class="heading settled" data-level="5.1" id="iana-https"><span class="secno">5.1. </span><span class="content"> The <code>Sec-COWL</code> HTTP Header Field </span><a class="self-link" href="#iana-https"></a></h3>
     The permanent message header field registry should be updated with the
  following registration <a data-link-type="biblio" href="#biblio-rfc3864">[RFC3864]</a>: 
    <dl>
     <dt>Header field name
     <dd>Sec-COWL
     <dt>Applicable protocol
     <dd>http
     <dt>Status
     <dd>standard
     <dt>Author/Change controller
     <dd>W3C
     <dt>Specification document
     <dd>This specification (See <a href="#header">§3.5 The Sec-COWL HTTP Header Field</a>)
    </dl>
    <h3 class="heading settled" data-level="5.2" id="iana-mime"><span class="secno">5.2. </span><span class="content"> The <code>application/labeled-json</code> MIME media type </span><a class="self-link" href="#iana-mime"></a></h3>
    <dl>
     <dt>Type name
     <dd>application
     <dt>Subtype name
     <dd>labeled-json
     <dt>Required parameters
     <dd>Same as for <code>application/json</code>. <a data-link-type="biblio" href="#biblio-json">[JSON]</a>
     <dt>Optional parameters
     <dd>Same as for <code>application/json</code>. <a data-link-type="biblio" href="#biblio-json">[JSON]</a>
     <dt>Encoding considerations
     <dd>Same as for <code>application/json</code>. <a data-link-type="biblio" href="#biblio-json">[JSON]</a>
     <dt>Security considerations
     <dd>Same as for <code>application/json</code>. <a data-link-type="biblio" href="#biblio-json">[JSON]</a>
     <dt>Interoperability considerations
     <dd>Same as for <code>application/json</code>. <a data-link-type="biblio" href="#biblio-json">[JSON]</a>
     <dt>Published specification
     <dd> Labeling a resource with the <code>application/labeled-json</code> type asserts that the resource is a JSON text that consists of an
    object with a single entry called <code>"confidentiality"</code> consisting of a string, a single entry called <code>"integrity"</code> consisting of string, and a single entry called <code>"object"</code> consisting of a JSON object.  The relevant specifications are the
    JSON specification and this specification. <a data-link-type="biblio" href="#biblio-json">[JSON]</a> 
     <dt>Author/Change controller
     <dd>W3C
    </dl>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="acknowledgements"><span class="secno">6. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>Thanks to Niklas Andreasson, Dan Boneh, Brendan Eich, Lon Ingram, Brad Hill,
  Dave Herman, Bobby Holley, Brad Karp, Jonathan Kingston, Petr Marchenko,
  David Mazières, Devon Rifkin, Alejandro Russo, Brian Smith, and the W3C
  WebAppSec team for influencing (directly or otherwise) the design of COWL
  and/or their comments on this document.</p>
   </section>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#and-expression">and-expression</a><span>, in §3.5</span>
   <li><a href="#dom-label-and-label-or-domstring-other">and((Label or DOMString) other)</a><span>, in §3.1.2</span>
   <li><a href="#dom-label-and">and(other)</a><span>, in §3.1</span>
   <li><a href="#application-specific-principal">application-specific principal</a><span>, in §2.1</span>
   <li><a href="#app-principal-expression">app-principal-expression</a><span>, in §3.5</span>
   <li><a href="#dom-privilege-aslabel">asLabel()</a><span>, in §3.2.2</span>
   <li><a href="#dictdef-cilabel">CILabel</a><span>, in §3.4</span>
   <li><a href="#dom-labeledobject-clone">clone(labels)</a><span>, in §3.4.3</span>
   <li><a href="#combination">combination</a><span>, in §3.2</span>
   <li><a href="#dom-privilege-combine">combine(other)</a><span>, in §3.2.2</span>
   <li>
    confidentiality
    <ul>
     <li><a href="#dom-cowl-confidentiality">attribute for COWL</a><span>, in §3.3.1</span>
     <li><a href="#dom-cilabel-confidentiality">dict-member for CILabel</a><span>, in §3.4</span>
     <li><a href="#dom-labeledobject-confidentiality">attribute for LabeledObject</a><span>, in §3.4.2</span>
    </ul>
   <li><a href="#confined-context">confined context</a><span>, in §3.3</span>
   <li><a href="#confinement-mode">confinement mode</a><span>, in §3.3</span>
   <li><a href="#context-confidentiality-label">context confidentiality label</a><span>, in §3.3</span>
   <li><a href="#context-integrity-label">context integrity label</a><span>, in §3.3</span>
   <li><a href="#context-labels">context labels</a><span>, in §3.3</span>
   <li><a href="#context-privilege">context privilege</a><span>, in §3.3</span>
   <li><a href="#context-tainting">context tainting</a><span>, in §4.5</span>
   <li><a href="#cowl">COWL</a><span>, in §3.3</span>
   <li><a href="#cowl-state">COWL state</a><span>, in §3.3</span>
   <li><a href="#ctx-confidentiality">ctx-confidentiality</a><span>, in §3.5</span>
   <li><a href="#ctx-directive">ctx-directive</a><span>, in §3.5</span>
   <li><a href="#ctx-directive-name">ctx-directive-name</a><span>, in §3.5</span>
   <li><a href="#ctx-integrity">ctx-integrity</a><span>, in §3.5</span>
   <li><a href="#ctx-metadata">ctx-metadata</a><span>, in §3.5</span>
   <li><a href="#ctx-privilege">ctx-privilege</a><span>, in §3.5</span>
   <li><a href="#current-confidentiality-label">current confidentiality label</a><span>, in §2.1</span>
   <li><a href="#current-integrity-label">current integrity label</a><span>, in §2.1</span>
   <li><a href="#current-privilege">current privilege</a><span>, in §2.2</span>
   <li><a href="#data-confidentiality">data-confidentiality</a><span>, in §3.5</span>
   <li><a href="#data-directive">data-directive</a><span>, in §3.5</span>
   <li><a href="#data-directive-name">data-directive-name</a><span>, in §3.5</span>
   <li><a href="#data-integrity">data-integrity</a><span>, in §3.5</span>
   <li><a href="#data-metadata">data-metadata</a><span>, in §3.5</span>
   <li><a href="#default-confidentiality-label">default confidentiality label</a><span>, in §3.3</span>
   <li><a href="#default-cowl-state">default COWL state</a><span>, in §3.3</span>
   <li><a href="#default-integrity-label">default integrity label</a><span>, in §3.3</span>
   <li><a href="#default-privilege">default privilege</a><span>, in §3.3</span>
   <li><a href="#delegated-privilege">delegated privilege</a><span>, in §3.2</span>
   <li><a href="#dom-privilege-delegate">delegate(label)</a><span>, in §3.2.2</span>
   <li><a href="#disjunction-set">disjunction set</a><span>, in §3.1</span>
   <li><a href="#dropping-privileges">dropping privileges</a><span>, in §3.2</span>
   <li><a href="#effective-confidentiality-label">effective confidentiality label</a><span>, in §2.2</span>
   <li><a href="#effective-integrity-label">effective integrity label</a><span>, in §2.2</span>
   <li><a href="#empty-label">empty label</a><span>, in §3.1</span>
   <li><a href="#empty-label①">empty-label</a><span>, in §3.5</span>
   <li><a href="#empty-privilege">empty privilege</a><span>, in §3.2</span>
   <li><a href="#dom-label-equals">equals(other)</a><span>, in §3.1.2</span>
   <li><a href="#equivalent">equivalent</a><span>, in §2.1</span>
   <li><a href="#dom-privilege-freshprivilege">FreshPrivilege()</a><span>, in §3.2.1</span>
   <li>
    integrity
    <ul>
     <li><a href="#dom-cowl-integrity">attribute for COWL</a><span>, in §3.3.1</span>
     <li><a href="#dom-cilabel-integrity">dict-member for CILabel</a><span>, in §3.4</span>
     <li><a href="#dom-labeledobject-integrity">attribute for LabeledObject</a><span>, in §3.4.2</span>
    </ul>
   <li><a href="#internal-privilege-label">internal privilege label</a><span>, in §3.2</span>
   <li><a href="#dom-label-label">Label()</a><span>, in §3.1.1</span>
   <li><a href="#label①">Label</a><span>, in §3.1</span>
   <li><a href="#label">label</a><span>, in §2.1</span>
   <li><a href="#label-downgrade">label downgrade</a><span>, in §4.3</span>
   <li><a href="#labeled-context-metadata">Labeled context metadata</a><span>, in §3.5</span>
   <li><a href="#labeled-data-metadata">Labeled data metadata</a><span>, in §3.5</span>
   <li><a href="#dom-xmlhttprequestresponsetype-labeled-json">labeled-json</a><span>, in §3.6.2</span>
   <li><a href="#dom-xmlhttprequestresponsetype-labeled-json">"labeled-json"</a><span>, in §3.6.2</span>
   <li><a href="#labeled-json-response">labeled JSON response</a><span>, in §3.6.2</span>
   <li><a href="#labeledobject">LabeledObject</a><span>, in §3.4</span>
   <li><a href="#dom-labeledobject-labeledobject">LabeledObject(obj, labels)</a><span>, in §3.4.1</span>
   <li><a href="#labeled-objects">labeled objects</a><span>, in §2.1</span>
   <li><a href="#label-expression">label-expression</a><span>, in §3.5</span>
   <li><a href="#label-metadata">Label metadata</a><span>, in §3.5</span>
   <li><a href="#label-normal-form-reduction">label normal form reduction</a><span>, in §4.1</span>
   <li><a href="#dom-label-label-principal">Label(principal)</a><span>, in §3.1.1</span>
   <li><a href="#label-set">label set</a><span>, in §3.1</span>
   <li><a href="#label-subsumption">label subsumption</a><span>, in §4.2</span>
   <li><a href="#label-upgrade">label upgrade</a><span>, in §4.4</span>
   <li><a href="#none">'none'</a><span>, in §3.5</span>
   <li><a href="#normal-form">normal form</a><span>, in §2.1</span>
   <li><a href="#or-expression">or-expression</a><span>, in §3.5</span>
   <li><a href="#origin-label">origin label</a><span>, in §2.1</span>
   <li><a href="#origin-principal">origin principal</a><span>, in §2.1</span>
   <li><a href="#origin-principal-expression">origin-principal-expression</a><span>, in §3.5</span>
   <li><a href="#dom-label-or">or((Label or DOMString) other)</a><span>, in §3.1.2</span>
   <li><a href="#dom-label-_or">_or(other)</a><span>, in §3.1</span>
   <li><a href="#ownership">ownership</a><span>, in §2.2</span>
   <li><a href="#owns">owns</a><span>, in §2.2</span>
   <li><a href="#parse-labeled-context-metadata">parse labeled context metadata</a><span>, in §4.11</span>
   <li><a href="#parse-labeled-data-metadata">parse labeled data metadata</a><span>, in §4.10</span>
   <li><a href="#parse-label-expression①">parse label-expression</a><span>, in §4.12</span>
   <li><a href="#principal">principal</a><span>, in §2.1</span>
   <li><a href="#principal-expression">principal-expression</a><span>, in §3.5</span>
   <li><a href="#privilege①">Privilege</a><span>, in §3.2</span>
   <li><a href="#dom-privilege-privilege">Privilege()</a><span>, in §3.2.1</span>
   <li>
    privilege
    <ul>
     <li><a href="#privilege">definition of</a><span>, in §2.2</span>
     <li><a href="#dom-cowl-privilege">attribute for COWL</a><span>, in §3.3.1</span>
    </ul>
   <li><a href="#protected-object">protected object</a><span>, in §3.4</span>
   <li><a href="#dom-labeledobject-protectedobject">protectedObject</a><span>, in §3.4.2</span>
   <li><a href="#response-labeledobject-object">response LabeledObject object</a><span>, in §3.6.2</span>
   <li><a href="#restricting">restricting</a><span>, in §2.1</span>
   <li><a href="#self">'self'</a><span>, in §3.5</span>
   <li><a href="#dom-xmlhttprequest-send">send(lobj)</a><span>, in §3.6.1</span>
   <li><a href="#serialized-labels">serialized labels</a><span>, in §3.5</span>
   <li><a href="#split">split</a><span>, in §4.12</span>
   <li><a href="#label-stringification-behavior">stringification behavior</a><span>, in §3.1.3</span>
   <li><a href="#subsumes">subsumes</a><span>, in §2.1</span>
   <li><a href="#dom-label-subsumes">subsumes(other)</a><span>, in §3.1.2</span>
   <li><a href="#dom-label-subsumes">subsumes(other, priv)</a><span>, in §3.1.2</span>
   <li><a href="#tainted">tainted</a><span>, in §2.1</span>
   <li><a href="#unconfined-context">unconfined context</a><span>, in §3.3</span>
   <li><a href="#unique-principal">unique principal</a><span>, in §2.1</span>
   <li><a href="#unique-principal-expression">unique-principal-expression</a><span>, in §3.5</span>
   <li><a href="#unprivileged">unprivileged</a><span>, in §3.2</span>
   <li><a href="#write-check">write check</a><span>, in §4.6</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CORS]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/cors/#access-control-allow-origin-response-header">access-control-allow-origin</a>
    </ul>
   <li>
    <a data-link-type="biblio">[CSP2]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/CSP2/#host_source">host-source</a>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM-Parsing]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/DOM-Parsing/#dfn-concept-fragment-serializing-algorithm">serialized</a>
    </ul>
   <li>
    <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
    <ul>
     <li><a href="https://encoding.spec.whatwg.org/#utf-8-decode">utf-8 decode</a>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-body">body</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a>
     <li><a href="https://fetch.spec.whatwg.org/#fetching">fetching</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header">header</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-list">header list</a>
     <li><a href="https://fetch.spec.whatwg.org/#main-fetch">main fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-name">name</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-network-error">network error</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request">request</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response">response</a>
    </ul>
   <li>
    <a data-link-type="biblio">[html5]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/html5/dom.html#the-document-object">Document</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#window">Window</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#active-sandboxing-flag-set">active sandboxing flag set</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ascii case-insensitive</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#windows">browsing context</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters">collect a sequence of characters</a>
     <li><a href="https://www.w3.org/TR/html5/embedded-content-0.html#dom-iframe-contentdocument">contentdocument</a>
     <li><a href="https://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a>
     <li><a href="https://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a>
     <li><a href="https://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#internal-structured-cloning-algorithm">internal structured cloning algorithm</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#navigate">navigating</a>
     <li><a href="https://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox">sandbox</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#sandboxed-auxiliary-navigation-browsing-context-flag">sandboxed auxiliary navigation browsing context flag</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#sandboxed-document.domain-browsing-context-flag">sandboxed document.domain browsing context flag</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing context flag</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#sandboxed-origin-browsing-context-flag">sandboxed origin browsing context flag</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#sandboxed-plugins-browsing-context-flag">sandboxed plugins browsing context flag</a>
     <li><a href="https://www.w3.org/TR/html5/browsers.html#sandboxed-top-level-navigation-browsing-context-flag">sandboxed top-level navigation browsing context flag</a>
     <li><a href="https://www.w3.org/TR/html5/dom.html#sandboxCookies">script from reading from or writing to the document.cookie idl attribute</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#skip-whitespace">skip whitespace</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#space-character">space characters</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">strictly split a string</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#strip-and-collapse-whitespace">strip and collapse whitespace</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace">strip leading and trailing whitespace</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone">structurally clonable</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone">structurally cloned</a>
     <li><a href="https://www.w3.org/TR/html5/infrastructure.html#structured-clone">structured clone</a>
    </ul>
   <li>
    <a data-link-type="biblio">[JSON]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc4627#section-2">json</a>
    </ul>
   <li>
    <a data-link-type="biblio">[REFERRER-POLICY]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer">determine request's referrer algorithm</a>
     <li><a href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy">referrer policy</a>
    </ul>
   <li>
    <a data-link-type="biblio">[rfc4122]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc4122#section-3">uuid</a>
    </ul>
   <li>
    <a data-link-type="biblio">[rfc5234]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">alpha</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">digit</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">wsp</a>
    </ul>
   <li>
    <a data-link-type="biblio">[rfc6454]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6454#section-2.3">globally unique identifier</a>
     <li><a href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><a href="https://url.spec.whatwg.org/#concept-url">url</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#Exposed">Exposed</a>
     <li><a href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a>
     <li><a href="https://heycam.github.io/webidl/#idl-boolean">boolean</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL2]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
     <li><a href="https://heycam.github.io/webidl/#dfn-exposed">exposed</a>
     <li><a href="https://heycam.github.io/webidl/#idl-object">object</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBMESSAGING]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/webmessaging/#web-messaging">cross-document messaging</a>
     <li><a href="https://www.w3.org/TR/webmessaging/#messageport">message port</a>
     <li><a href="https://www.w3.org/TR/webmessaging/#dom-messageport-postmessage">messageport postmessage()</a>
     <li><a href="https://www.w3.org/TR/webmessaging/#concept-port-owner">owner</a>
     <li><a href="https://www.w3.org/TR/webmessaging/#dom-window-postmessage">postMessage()</a>
     <li><a href="https://www.w3.org/TR/webmessaging/#posting-messages">posting messages</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBSOCKETS]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/websockets/#dom-websocket">WebSocket()</a>
     <li><a href="https://www.w3.org/TR/websockets/#make-disappear">make disappear</a>
    </ul>
   <li>
    <a data-link-type="biblio">[workers]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/workers/#worker">worker</a>
    </ul>
   <li>
    <a data-link-type="biblio">[XHR]</a> defines the following terms:
    <ul>
     <li><a href="https://xhr.spec.whatwg.org/#xmlhttprequest">XMLHttpRequest</a>
     <li><a href="https://xhr.spec.whatwg.org/#xmlhttprequestresponsetype">XMLHttpRequestResponseType</a>
     <li><a href="https://xhr.spec.whatwg.org/#author-request-headers">author request headers</a>
     <li><a href="https://xhr.spec.whatwg.org/#final-mime-type">final mime type</a>
     <li><a href="https://xhr.spec.whatwg.org/#the-open()-method">open()</a>
     <li><a href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-responsetype">response</a>
     <li><a href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-responsetype">responseType</a>
     <li><a href="https://xhr.spec.whatwg.org/#xmlhttprequest">xmlhttprequest</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-cors">[CORS]
   <dd>Anne van Kesteren. <a href="https://www.w3.org/TR/cors/">Cross-Origin Resource Sharing</a>. 16 January 2014. REC. URL: <a href="https://www.w3.org/TR/cors/">https://www.w3.org/TR/cors/</a>
   <dt id="biblio-csp2">[CSP2]
   <dd>Mike West; Adam Barth; Daniel Veditz. <a href="https://www.w3.org/TR/CSP2/">Content Security Policy Level 2</a>. 15 December 2016. REC. URL: <a href="https://www.w3.org/TR/CSP2/">https://www.w3.org/TR/CSP2/</a>
   <dt id="biblio-ecma-262">[ECMA-262]
   <dd><a href="https://tc39.github.io/ecma262/">ECMAScript Language Specification</a>. URL: <a href="https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/">Encoding Standard</a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html5">[HTML5]
   <dd>Ian Hickson; et al. <a href="https://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
   <dt id="biblio-json">[JSON]
   <dd>T. Bray, Ed.. <a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>. March 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7159">https://tools.ietf.org/html/rfc7159</a>
   <dt id="biblio-referrer-policy">[REFERRER-POLICY]
   <dd>Jochen Eisinger; Emily Stark. <a href="https://www.w3.org/TR/referrer-policy/">Referrer Policy</a>. 26 January 2017. CR. URL: <a href="https://www.w3.org/TR/referrer-policy/">https://www.w3.org/TR/referrer-policy/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc2616">[RFC2616]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>. September 2004. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc3864">https://tools.ietf.org/html/rfc3864</a>
   <dt id="biblio-rfc4122">[RFC4122]
   <dd>P. Leach; M. Mealling; R. Salz. <a href="https://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>. July 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-rfc6454">[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren; Sam Ruby. <a href="https://www.w3.org/TR/url">URL</a>. WD. URL: <a href="https://www.w3.org/TR/url">https://www.w3.org/TR/url</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 15 December 2016. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-webidl2">[WEBIDL2]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="https://heycam.github.io/webidl/">Web IDL (Second Edition)</a>. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-webmessaging">[WEBMESSAGING]
   <dd>Ian Hickson. <a href="https://www.w3.org/TR/webmessaging/">HTML5 Web Messaging</a>. 19 May 2015. REC. URL: <a href="https://www.w3.org/TR/webmessaging/">https://www.w3.org/TR/webmessaging/</a>
   <dt id="biblio-websockets">[WEBSOCKETS]
   <dd>Ian Hickson. <a href="https://www.w3.org/TR/websockets/">The WebSocket API</a>. 20 September 2012. CR. URL: <a href="https://www.w3.org/TR/websockets/">https://www.w3.org/TR/websockets/</a>
   <dt id="biblio-xhr">[XHR]
   <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/">XMLHttpRequest Standard</a>. Living Standard. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-cowl-osdi">[COWL-OSDI]
   <dd>Deian Stefan; et al. <a href="https://www.usenix.org/system/files/conference/osdi14/osdi14-paper-stefan.pdf">Protecting Users by Confining JavaScript with COWL</a>. URL: <a href="https://www.usenix.org/system/files/conference/osdi14/osdi14-paper-stefan.pdf">https://www.usenix.org/system/files/conference/osdi14/osdi14-paper-stefan.pdf</a>
   <dt id="biblio-dclabels">[DCLabels]
   <dd>Deian Stefan; et al. <a href="http://www.scs.stanford.edu/~deian/pubs/stefan:2011:dclabels.pdf">Disjunction Category Labels</a>. URL: <a href="http://www.scs.stanford.edu/~deian/pubs/stefan:2011:dclabels.pdf">http://www.scs.stanford.edu/~deian/pubs/stefan:2011:dclabels.pdf</a>
   <dt id="biblio-dom-parsing">[DOM-Parsing]
   <dd>Travis Leithead. <a href="https://www.w3.org/TR/DOM-Parsing/">DOM Parsing and Serialization</a>. 17 May 2016. WD. URL: <a href="https://www.w3.org/TR/DOM-Parsing/">https://www.w3.org/TR/DOM-Parsing/</a>
   <dt id="biblio-webstorage">[WEBSTORAGE]
   <dd>Ian Hickson. <a href="https://www.w3.org/TR/webstorage/">Web Storage (Second Edition)</a>. 19 April 2016. REC. URL: <a href="https://www.w3.org/TR/webstorage/">https://www.w3.org/TR/webstorage/</a>
   <dt id="biblio-workers">[WORKERS]
   <dd>Ian Hickson. <a href="https://www.w3.org/TR/workers/">Web Workers</a>. 24 September 2015. WD. URL: <a href="https://www.w3.org/TR/workers/">https://www.w3.org/TR/workers/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-label-label" id="ref-for-dom-label-label①④">Constructor</a>, <a class="nv idl-code" data-link-type="constructor" href="#dom-label-label-principal" id="ref-for-dom-label-label-principal①">Constructor</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString③"><span class="kt">DOMString</span></a> <a class="nv" href="#dom-label-label-principal-principal"><code>principal</code></a>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③">Exposed</a>=(<span class="n">Window</span>, <span class="n">Worker</span>)]
<span class="kt">interface</span> <a class="nv" href="#label①"><code>Label</code></a> {
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean②"><span class="kt">boolean</span></a> <a class="nv idl-code" data-link-type="method" href="#dom-label-equals" id="ref-for-dom-label-equals②">equals</a>(<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①②⑨①">Label</a> <a class="nv" href="#dom-label-equals-other-other"><code>other</code></a>);
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean①①"><span class="kt">boolean</span></a> <a class="nv idl-code" data-link-type="method" href="#dom-label-subsumes" id="ref-for-dom-label-subsumes③">subsumes</a>(<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③⓪①">Label</a> <a class="nv" href="#dom-label-subsumes-other-priv-other"><code>other</code></a>, <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①③①">Privilege</a> <a class="nv" href="#dom-label-subsumes-other-priv-priv"><code>priv</code></a>);

  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③①①">Label</a> <a class="nv" href="#dom-label-and"><code>and</code></a>((<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③②①">Label</a> <span class="kt">or</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①①"><span class="kt">DOMString</span></a>) <a class="nv" href="#dom-label-and-other-other"><code>other</code></a>);
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③③①">Label</a> <a class="nv" href="#dom-label-_or"><code>_or</code></a>((<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①③④①">Label</a> <span class="kt">or</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②①"><span class="kt">DOMString</span></a>) <a class="nv" href="#dom-label-_or-other-other"><code>other</code></a>);

  <a class="kt" data-link-type="dfn" href="#label-stringification-behavior" id="ref-for-label-stringification-behavior①">stringifier</a>;
};

[<a class="nv idl-code" data-link-type="constructor" href="#dom-privilege-privilege" id="ref-for-dom-privilege-privilege①①">Constructor</a>, <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①">Exposed</a>=(<span class="n">Window</span>, <span class="n">Worker</span>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext③">SecureContext</a>]
<span class="kt">interface</span> <a class="nv" href="#privilege①"><code>Privilege</code></a> {
  <span class="kt">static</span> <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑥①">Privilege</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-freshprivilege" id="ref-for-dom-privilege-freshprivilege⑥">FreshPrivilege</a>(); // Named constructor
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①④⑥①">Label</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-aslabel" id="ref-for-dom-privilege-aslabel①①">asLabel</a>();

  <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑦①">Privilege</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-combine" id="ref-for-dom-privilege-combine①①">combine</a>(<a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑧①">Privilege</a> <a class="nv" href="#dom-privilege-combine-other-other"><code>other</code></a>);
  [<a class="nv idl-code" data-link-type="extended-attribute">Throws</a>] <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①⑨①">Privilege</a> <a class="nv idl-code" data-link-type="method" href="#dom-privilege-delegate" id="ref-for-dom-privilege-delegate②">delegate</a>(<a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①④⑦①">Label</a> <a class="nv" href="#dom-privilege-delegate-label-label"><code>label</code></a>);
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext①①">SecureContext</a>, <a class="nv idl-code" data-link-type="extended-attribute">COWLContext</a>]
<span class="kt">interface</span> <a class="nv" href="#cowl"><code>COWL</code></a> {
  [<a class="nv idl-code" data-link-type="extended-attribute">SetterThrows</a>] <span class="kt">static</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑤⑥①">Label</a> <a class="nv idl-code" data-link-type="attribute" data-type="Label" href="#dom-cowl-confidentiality" id="ref-for-dom-cowl-confidentiality①">confidentiality</a>;
  [<a class="nv idl-code" data-link-type="extended-attribute">SetterThrows</a>] <span class="kt">static</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑤⑦①">Label</a> <a class="nv idl-code" data-link-type="attribute" data-type="Label" href="#dom-cowl-integrity" id="ref-for-dom-cowl-integrity①">integrity</a>;
  [<a class="nv idl-code" data-link-type="extended-attribute">SetterThrows</a>] <span class="kt">static</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#privilege①" id="ref-for-privilege①①⑨①">Privilege</a> <a class="nv idl-code" data-link-type="attribute" data-type="Privilege" href="#dom-cowl-privilege" id="ref-for-dom-cowl-privilege①">privilege</a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-cilabel"><code>CILabel</code></a> {
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥②①">Label</a>? <a class="nv" data-type="Label? " href="#dom-cilabel-confidentiality"><code>confidentiality</code></a>;
  <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥③①">Label</a>? <a class="nv" data-type="Label? " href="#dom-cilabel-integrity"><code>integrity</code></a>;
};

[<a class="nv idl-code" data-link-type="constructor" href="#dom-labeledobject-labeledobject" id="ref-for-dom-labeledobject-labeledobject③">Constructor</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object③"><span class="kt">object</span></a> <a class="nv" href="#dom-labeledobject-labeledobject-obj-labels-obj"><code>obj</code></a>, <a class="n" data-link-type="idl-name" href="#dictdef-cilabel" id="ref-for-dictdef-cilabel②">CILabel</a>? <a class="nv" href="#dom-labeledobject-labeledobject-obj-labels-labels"><code>labels</code></a>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②①">Exposed</a>=(<span class="n">Window</span>, <span class="n">Worker</span>), <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext②①">SecureContext</a>]
<span class="kt">interface</span> <a class="nv" href="#labeledobject"><code>LabeledObject</code></a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥④①">Label</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Label" href="#dom-labeledobject-confidentiality" id="ref-for-dom-labeledobject-confidentiality①">confidentiality</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#label①" id="ref-for-label①⑥⑤①">Label</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Label" href="#dom-labeledobject-integrity" id="ref-for-dom-labeledobject-integrity①">integrity</a>;

  [<a class="nv idl-code" data-link-type="extended-attribute">GetterThrows</a>] <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object①①"><span class="kt">object</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="object" href="#dom-labeledobject-protectedobject" id="ref-for-dom-labeledobject-protectedobject⑤">protectedObject</a>;

  [<a class="nv idl-code" data-link-type="extended-attribute">Throws</a>] <a class="n" data-link-type="idl-name" href="#labeledobject" id="ref-for-labeledobject⑧①">LabeledObject</a> <a class="nv idl-code" data-link-type="method" href="#dom-labeledobject-clone" id="ref-for-dom-labeledobject-clone①">clone</a>(<a class="n" data-link-type="idl-name" href="#dictdef-cilabel" id="ref-for-dictdef-cilabel①①">CILabel</a> <a class="nv" href="#dom-labeledobject-clone-labels-labels"><code>labels</code></a>);
};

<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest④①">XMLHttpRequest</a> {
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-xmlhttprequest-send" id="ref-for-dom-xmlhttprequest-send①">send</a>(<a class="n" data-link-type="idl-name" href="#labeledobject" id="ref-for-labeledobject②①①">LabeledObject</a> <a class="nv" href="#dom-xmlhttprequest-send-lobj-lobj"><code>lobj</code></a>);
};

<span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="https://xhr.spec.whatwg.org/#xmlhttprequestresponsetype" id="ref-for-xmlhttprequestresponsetype①①">XMLHttpRequestResponseType</a> {
  // ... existing response types ...
  <a class="s" href="#dom-xmlhttprequestresponsetype-labeled-json"><code>"labeled-json"</code></a>
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> is there a better way for us to just disallow direct DOM
access and preserve same-origin?<a href="#issue-af89ca42"> ↵ </a></div>
  </div>
  <aside class="dfn-panel" data-for="origin-label">
   <b><a href="#origin-label">#origin-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-origin-label">1. Introduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label">
   <b><a href="#label">#label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label">1.2.1. Confining untrusted third-party services</a> <a href="#ref-for-label②">(2)</a>
    <li><a href="#ref-for-label③">1.2.2. Sharing data with third-party mashups</a>
    <li><a href="#ref-for-label④">1.2.3. Content isolation via privilege separation</a>
    <li><a href="#ref-for-label⑤">1.2.4. Running content with least-privileges</a>
    <li><a href="#ref-for-label⑥">1.4.2. Using labels to enhance privacy</a>
    <li><a href="#ref-for-label⑦">2.1. Labels</a>
    <li><a href="#ref-for-label⑧">2.2. Privileges</a>
    <li><a href="#ref-for-label⑨">3. Framework</a> <a href="#ref-for-label①⓪">(2)</a>
    <li><a href="#ref-for-label①①">3.1. Labels</a>
    <li><a href="#ref-for-label①②">3.1.1. Constructors</a>
    <li><a href="#ref-for-label①③">3.1.2. Methods</a>
    <li><a href="#ref-for-label①④">3.2.2. Methods</a> <a href="#ref-for-label①⑤">(2)</a>
    <li><a href="#ref-for-label①⑥">3.3. Labeled Contexts</a> <a href="#ref-for-label①⑦">(2)</a>
    <li><a href="#ref-for-label①⑧">3.4. Labeled Objects</a> <a href="#ref-for-label①⑨">(2)</a>
    <li><a href="#ref-for-label②⓪">3.6.1. Sending labeled objects</a>
    <li><a href="#ref-for-label②①">3.6.2. Receiving labeled objects</a> <a href="#ref-for-label②②">(2)</a> <a href="#ref-for-label②③">(3)</a>
    <li><a href="#ref-for-label②④">4.1. Label Normal Form Reduction</a> <a href="#ref-for-label②⑤">(2)</a> <a href="#ref-for-label②⑥">(3)</a>
    <li><a href="#ref-for-label②⑦">4.3. Label Downgrade</a>
    <li><a href="#ref-for-label②⑧">4.5. Context Tainting</a> <a href="#ref-for-label②⑨">(2)</a>
    <li><a href="#ref-for-label③⓪">4.10. 
      Parse labeled data metadata </a>
    <li><a href="#ref-for-label③①">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="labeled-objects">
   <b><a href="#labeled-objects">#labeled-objects</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-labeled-objects">1.2.1. Confining untrusted third-party services</a>
    <li><a href="#ref-for-labeled-objects①">2.1. Labels</a>
    <li><a href="#ref-for-labeled-objects②">2.2. Privileges</a>
    <li><a href="#ref-for-labeled-objects③">3.2.3. Examples</a>
    <li><a href="#ref-for-labeled-objects④">3.4.1. Constructors</a>
    <li><a href="#ref-for-labeled-objects⑤">3.4.4. Examples</a>
    <li><a href="#ref-for-labeled-objects⑥">3.5.1. Sec-COWL in HTTP Requests</a>
    <li><a href="#ref-for-labeled-objects⑦">3.6.1. Sending labeled objects</a> <a href="#ref-for-labeled-objects⑧">(2)</a>
    <li><a href="#ref-for-labeled-objects⑨">3.6.2. Receiving labeled objects</a> <a href="#ref-for-labeled-objects①⓪">(2)</a>
    <li><a href="#ref-for-labeled-objects①①">3.6.2.1. Examples</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="principal">
   <b><a href="#principal">#principal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-principal">2.1. Labels</a>
    <li><a href="#ref-for-principal①">3. Framework</a>
    <li><a href="#ref-for-principal②">3.1. Labels</a>
    <li><a href="#ref-for-principal③">3.1.1. Constructors</a> <a href="#ref-for-principal④">(2)</a>
    <li><a href="#ref-for-principal⑤">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-principal⑥">4.12. 
      Parse label expression </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="origin-principal">
   <b><a href="#origin-principal">#origin-principal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-origin-principal">2.1. Labels</a>
    <li><a href="#ref-for-origin-principal①">4.7. Structured Cloning</a> <a href="#ref-for-origin-principal②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="unique-principal">
   <b><a href="#unique-principal">#unique-principal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-unique-principal">2.1. Labels</a>
    <li><a href="#ref-for-unique-principal①">3.2.1. Constructors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="application-specific-principal">
   <b><a href="#application-specific-principal">#application-specific-principal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-application-specific-principal">1.4.1. Encoding information in labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="normal-form">
   <b><a href="#normal-form">#normal-form</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-normal-form">2.1. Labels</a> <a href="#ref-for-normal-form①">(2)</a>
    <li><a href="#ref-for-normal-form②">3.1.2. Methods</a> <a href="#ref-for-normal-form③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="equivalent">
   <b><a href="#equivalent">#equivalent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-equivalent">3.1.2. Methods</a> <a href="#ref-for-equivalent①">(2)</a> <a href="#ref-for-equivalent②">(3)</a>
    <li><a href="#ref-for-equivalent③">3.2.2. Methods</a> <a href="#ref-for-equivalent④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="subsumes">
   <b><a href="#subsumes">#subsumes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-subsumes">3.1.2. Methods</a>
    <li><a href="#ref-for-subsumes①">3.2. Privileges</a>
    <li><a href="#ref-for-subsumes②">3.2.2. Methods</a>
    <li><a href="#ref-for-subsumes③">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-subsumes④">(2)</a> <a href="#ref-for-subsumes⑤">(3)</a> <a href="#ref-for-subsumes⑥">(4)</a>
    <li><a href="#ref-for-subsumes⑦">4.3. Label Downgrade</a>
    <li><a href="#ref-for-subsumes⑧">4.6. Write Check</a> <a href="#ref-for-subsumes⑨">(2)</a>
    <li><a href="#ref-for-subsumes①⓪">4.7. Structured Cloning</a>
    <li><a href="#ref-for-subsumes①①">4.8. 
      Should fetching request be blocked as COWL? </a>
    <li><a href="#ref-for-subsumes①②">4.9. 
      Process response to request as COWL </a> <a href="#ref-for-subsumes①③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="current-confidentiality-label">
   <b><a href="#current-confidentiality-label">#current-confidentiality-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-current-confidentiality-label">2.2. Privileges</a> <a href="#ref-for-current-confidentiality-label①">(2)</a>
    <li><a href="#ref-for-current-confidentiality-label②">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-current-confidentiality-label③">3.3.1. Attributes</a> <a href="#ref-for-current-confidentiality-label④">(2)</a> <a href="#ref-for-current-confidentiality-label⑤">(3)</a>
    <li><a href="#ref-for-current-confidentiality-label⑥">3.4.1. Constructors</a>
    <li><a href="#ref-for-current-confidentiality-label⑦">4.9. 
      Process response to request as COWL </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="current-integrity-label">
   <b><a href="#current-integrity-label">#current-integrity-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-current-integrity-label">2.2. Privileges</a> <a href="#ref-for-current-integrity-label①">(2)</a> <a href="#ref-for-current-integrity-label②">(3)</a>
    <li><a href="#ref-for-current-integrity-label③">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-current-integrity-label④">3.3.1. Attributes</a> <a href="#ref-for-current-integrity-label⑤">(2)</a> <a href="#ref-for-current-integrity-label⑥">(3)</a>
    <li><a href="#ref-for-current-integrity-label⑦">3.4.1. Constructors</a>
    <li><a href="#ref-for-current-integrity-label⑧">3.7.4. Modifications to WebSockets</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="tainted">
   <b><a href="#tainted">#tainted</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-tainted">3.2.3. Examples</a>
    <li><a href="#ref-for-tainted①">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-tainted②">3.4.2. Attributes</a> <a href="#ref-for-tainted③">(2)</a>
    <li><a href="#ref-for-tainted④">3.6.2.1. Examples</a> <a href="#ref-for-tainted⑤">(2)</a>
    <li><a href="#ref-for-tainted⑥">3.7.4. Modifications to WebSockets</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="privilege">
   <b><a href="#privilege">#privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-privilege">1. Introduction</a>
    <li><a href="#ref-for-privilege②">1.2.3. Content isolation via privilege separation</a>
    <li><a href="#ref-for-privilege③">2.2. Privileges</a>
    <li><a href="#ref-for-privilege④">3. Framework</a> <a href="#ref-for-privilege⑤">(2)</a>
    <li><a href="#ref-for-privilege⑥">3.2. Privileges</a>
    <li><a href="#ref-for-privilege⑦">3.2.3. Examples</a>
    <li><a href="#ref-for-privilege⑧">3.3. Labeled Contexts</a> <a href="#ref-for-privilege⑨">(2)</a>
    <li><a href="#ref-for-privilege①⓪">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-privilege①①">(2)</a>
    <li><a href="#ref-for-privilege①②">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="current-privilege">
   <b><a href="#current-privilege">#current-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-current-privilege">2.2. Privileges</a> <a href="#ref-for-current-privilege①">(2)</a> <a href="#ref-for-current-privilege②">(3)</a> <a href="#ref-for-current-privilege③">(4)</a> <a href="#ref-for-current-privilege④">(5)</a> <a href="#ref-for-current-privilege⑤">(6)</a> <a href="#ref-for-current-privilege⑥">(7)</a> <a href="#ref-for-current-privilege⑦">(8)</a>
    <li><a href="#ref-for-current-privilege⑧">3.2.2. Methods</a>
    <li><a href="#ref-for-current-privilege⑨">3.2.3. Examples</a>
    <li><a href="#ref-for-current-privilege①⓪">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-current-privilege①①">3.3.1. Attributes</a> <a href="#ref-for-current-privilege①②">(2)</a>
    <li><a href="#ref-for-current-privilege①③">4.5. Context Tainting</a> <a href="#ref-for-current-privilege①④">(2)</a>
    <li><a href="#ref-for-current-privilege①⑤">4.9. 
      Process response to request as COWL </a> <a href="#ref-for-current-privilege①⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="effective-confidentiality-label">
   <b><a href="#effective-confidentiality-label">#effective-confidentiality-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-effective-confidentiality-label">2.2. Privileges</a>
    <li><a href="#ref-for-effective-confidentiality-label①">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-effective-confidentiality-label②">(2)</a>
    <li><a href="#ref-for-effective-confidentiality-label③">3.7.4. Modifications to WebSockets</a>
    <li><a href="#ref-for-effective-confidentiality-label④">4.6. Write Check</a>
    <li><a href="#ref-for-effective-confidentiality-label⑤">4.8. 
      Should fetching request be blocked as COWL? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="effective-integrity-label">
   <b><a href="#effective-integrity-label">#effective-integrity-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-effective-integrity-label">2.2. Privileges</a>
    <li><a href="#ref-for-effective-integrity-label①">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-effective-integrity-label②">(2)</a>
    <li><a href="#ref-for-effective-integrity-label③">4.6. Write Check</a>
    <li><a href="#ref-for-effective-integrity-label④">4.9. 
      Process response to request as COWL </a> <a href="#ref-for-effective-integrity-label⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ownership">
   <b><a href="#ownership">#ownership</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ownership">3.2.2. Methods</a>
    <li><a href="#ref-for-ownership①">3.2.3. Examples</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="owns">
   <b><a href="#owns">#owns</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-owns">3.5.1. Sec-COWL in HTTP Requests</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-set">
   <b><a href="#label-set">#label-set</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-set">3.1. Labels</a>
    <li><a href="#ref-for-label-set①">3.1.1. Constructors</a>
    <li><a href="#ref-for-label-set②">3.1.2. Methods</a> <a href="#ref-for-label-set③">(2)</a> <a href="#ref-for-label-set④">(3)</a>
    <li><a href="#ref-for-label-set⑤">3.1.3. Serializing labels</a>
    <li><a href="#ref-for-label-set⑥">4.1. Label Normal Form Reduction</a> <a href="#ref-for-label-set⑦">(2)</a> <a href="#ref-for-label-set⑧">(3)</a> <a href="#ref-for-label-set⑨">(4)</a>
    <li><a href="#ref-for-label-set①⓪">4.2. Label Subsumption</a> <a href="#ref-for-label-set①①">(2)</a>
    <li><a href="#ref-for-label-set①②">4.3. Label Downgrade</a> <a href="#ref-for-label-set①③">(2)</a> <a href="#ref-for-label-set①④">(3)</a> <a href="#ref-for-label-set①⑤">(4)</a>
    <li><a href="#ref-for-label-set①⑥">4.7. Structured Cloning</a> <a href="#ref-for-label-set①⑦">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="disjunction-set">
   <b><a href="#disjunction-set">#disjunction-set</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-disjunction-set">3.1. Labels</a> <a href="#ref-for-disjunction-set①">(2)</a>
    <li><a href="#ref-for-disjunction-set②">3.1.1. Constructors</a>
    <li><a href="#ref-for-disjunction-set③">3.1.2. Methods</a> <a href="#ref-for-disjunction-set④">(2)</a> <a href="#ref-for-disjunction-set⑤">(3)</a>
    <li><a href="#ref-for-disjunction-set⑥">3.1.3. Serializing labels</a>
    <li><a href="#ref-for-disjunction-set⑦">4.1. Label Normal Form Reduction</a> <a href="#ref-for-disjunction-set⑧">(2)</a> <a href="#ref-for-disjunction-set⑨">(3)</a> <a href="#ref-for-disjunction-set①⓪">(4)</a>
    <li><a href="#ref-for-disjunction-set①①">4.2. Label Subsumption</a> <a href="#ref-for-disjunction-set①②">(2)</a>
    <li><a href="#ref-for-disjunction-set①③">4.3. Label Downgrade</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="empty-label">
   <b><a href="#empty-label">#empty-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-empty-label">3.1.1. Constructors</a>
    <li><a href="#ref-for-empty-label②">3.1.3. Serializing labels</a>
    <li><a href="#ref-for-empty-label③">3.2. Privileges</a>
    <li><a href="#ref-for-empty-label④">3.3. Labeled Contexts</a> <a href="#ref-for-empty-label⑤">(2)</a> <a href="#ref-for-empty-label⑥">(3)</a>
    <li><a href="#ref-for-empty-label⑦">3.7.4. Modifications to WebSockets</a> <a href="#ref-for-empty-label⑧">(2)</a> <a href="#ref-for-empty-label⑨">(3)</a> <a href="#ref-for-empty-label①⓪">(4)</a> <a href="#ref-for-empty-label①①">(5)</a>
    <li><a href="#ref-for-empty-label①②">4.1. Label Normal Form Reduction</a>
    <li><a href="#ref-for-empty-label①③">4.3. Label Downgrade</a>
    <li><a href="#ref-for-empty-label①④">4.5. Context Tainting</a>
    <li><a href="#ref-for-empty-label①⑤">4.8. 
      Should fetching request be blocked as COWL? </a>
    <li><a href="#ref-for-empty-label①⑥">4.9. 
      Process response to request as COWL </a>
    <li><a href="#ref-for-empty-label①⑦">4.12. 
      Parse label expression </a> <a href="#ref-for-empty-label①⑧">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-label-principal-principal">
   <b><a href="#dom-label-label-principal-principal">#dom-label-label-principal-principal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-label-principal-principal">3.1.1. Constructors</a> <a href="#ref-for-dom-label-label-principal-principal①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label①">
   <b><a href="#label①">#label①</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label①">1.2.1. Confining untrusted third-party services</a> <a href="#ref-for-label①①⓪">(2)</a>
    <li><a href="#ref-for-label①①①">2.1. Labels</a> <a href="#ref-for-label①①②">(2)</a> <a href="#ref-for-label①①③">(3)</a> <a href="#ref-for-label①①④">(4)</a> <a href="#ref-for-label①①⑤">(5)</a>
    <li><a href="#ref-for-label①①⑥">2.2. Privileges</a> <a href="#ref-for-label①①⑦">(2)</a> <a href="#ref-for-label①①⑧">(3)</a> <a href="#ref-for-label①①⑨">(4)</a> <a href="#ref-for-label①②⓪">(5)</a> <a href="#ref-for-label①②①">(6)</a> <a href="#ref-for-label①②②">(7)</a> <a href="#ref-for-label①②③">(8)</a> <a href="#ref-for-label①②④">(9)</a> <a href="#ref-for-label①②⑤">(10)</a>
    <li><a href="#ref-for-label①②⑥">3. Framework</a>
    <li><a href="#ref-for-label①②⑦">3.1. Labels</a> <a href="#ref-for-label①②⑧">(2)</a> <a href="#ref-for-label①②⑨">(3)</a> <a href="#ref-for-label①③⓪">(4)</a> <a href="#ref-for-label①③①">(5)</a> <a href="#ref-for-label①③②">(6)</a> <a href="#ref-for-label①③③">(7)</a> <a href="#ref-for-label①③④">(8)</a>
    <li><a href="#ref-for-label①③⑤">3.1.2. Methods</a> <a href="#ref-for-label①③⑥">(2)</a> <a href="#ref-for-label①③⑦">(3)</a> <a href="#ref-for-label①③⑧">(4)</a> <a href="#ref-for-label①③⑨">(5)</a>
    <li><a href="#ref-for-label①④⓪">3.1.4. Examples</a> <a href="#ref-for-label①④①">(2)</a> <a href="#ref-for-label①④②">(3)</a> <a href="#ref-for-label①④③">(4)</a> <a href="#ref-for-label①④④">(5)</a> <a href="#ref-for-label①④⑤">(6)</a>
    <li><a href="#ref-for-label①④⑥">3.2. Privileges</a> <a href="#ref-for-label①④⑦">(2)</a>
    <li><a href="#ref-for-label①④⑧">3.2.3. Examples</a> <a href="#ref-for-label①④⑨">(2)</a> <a href="#ref-for-label①⑤⓪">(3)</a> <a href="#ref-for-label①⑤①">(4)</a> <a href="#ref-for-label①⑤②">(5)</a> <a href="#ref-for-label①⑤③">(6)</a> <a href="#ref-for-label①⑤④">(7)</a> <a href="#ref-for-label①⑤⑤">(8)</a>
    <li><a href="#ref-for-label①⑤⑥">3.3. Labeled Contexts</a> <a href="#ref-for-label①⑤⑦">(2)</a>
    <li><a href="#ref-for-label①⑤⑧">3.3.1. Attributes</a> <a href="#ref-for-label①⑤⑨">(2)</a>
    <li><a href="#ref-for-label①⑥⓪">3.3.2. Examples</a> <a href="#ref-for-label①⑥①">(2)</a>
    <li><a href="#ref-for-label①⑥②">3.4. Labeled Objects</a> <a href="#ref-for-label①⑥③">(2)</a> <a href="#ref-for-label①⑥④">(3)</a> <a href="#ref-for-label①⑥⑤">(4)</a>
    <li><a href="#ref-for-label①⑥⑥">3.4.2. Attributes</a> <a href="#ref-for-label①⑥⑦">(2)</a>
    <li><a href="#ref-for-label①⑥⑧">3.4.4. Examples</a> <a href="#ref-for-label①⑥⑨">(2)</a>
    <li><a href="#ref-for-label①⑦⓪">3.5.2. Sec-COWL in HTTP Responses</a>
    <li><a href="#ref-for-label①⑦①">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-label①⑦②">(2)</a>
    <li><a href="#ref-for-label①⑦③">3.7.4. Modifications to WebSockets</a> <a href="#ref-for-label①⑦④">(2)</a>
    <li><a href="#ref-for-label①⑦⑤">4.3. Label Downgrade</a>
    <li><a href="#ref-for-label①⑦⑥">4.7. Structured Cloning</a> <a href="#ref-for-label①⑦⑦">(2)</a>
    <li><a href="#ref-for-label①⑦⑧">4.8. 
      Should fetching request be blocked as COWL? </a>
    <li><a href="#ref-for-label①⑦⑨">4.9. 
      Process response to request as COWL </a>
    <li><a href="#ref-for-label①⑧⓪">4.12. 
      Parse label expression </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-equals-other-other">
   <b><a href="#dom-label-equals-other-other">#dom-label-equals-other-other</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-equals-other-other">3.1.2. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-subsumes-other-priv-other">
   <b><a href="#dom-label-subsumes-other-priv-other">#dom-label-subsumes-other-priv-other</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-subsumes-other-priv-other">3.1.2. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-subsumes-other-priv-priv">
   <b><a href="#dom-label-subsumes-other-priv-priv">#dom-label-subsumes-other-priv-priv</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-subsumes-other-priv-priv">3.1.2. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-and">
   <b><a href="#dom-label-and">#dom-label-and</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-and">3.2.2. Methods</a>
    <li><a href="#ref-for-dom-label-and①">4.1. Label Normal Form Reduction</a>
    <li><a href="#ref-for-dom-label-and②">4.4. Label Upgrade</a>
    <li><a href="#ref-for-dom-label-and③">4.5. Context Tainting</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-and-other-other">
   <b><a href="#dom-label-and-other-other">#dom-label-and-other-other</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-and-other-other">3.1.2. Methods</a> <a href="#ref-for-dom-label-and-other-other①">(2)</a> <a href="#ref-for-dom-label-and-other-other②">(3)</a> <a href="#ref-for-dom-label-and-other-other③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-_or-other-other">
   <b><a href="#dom-label-_or-other-other">#dom-label-_or-other-other</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-_or-other-other">3.1.2. Methods</a> <a href="#ref-for-dom-label-_or-other-other①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-label">
   <b><a href="#dom-label-label">#dom-label-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-label">3.1. Labels</a>
    <li><a href="#ref-for-dom-label-label①">3.1.1. Constructors</a> <a href="#ref-for-dom-label-label②">(2)</a>
    <li><a href="#ref-for-dom-label-label③">3.1.2. Methods</a> <a href="#ref-for-dom-label-label④">(2)</a>
    <li><a href="#ref-for-dom-label-label⑤">3.2.1. Constructors</a>
    <li><a href="#ref-for-dom-label-label⑥">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-dom-label-label⑦">3.6.1. Sending labeled objects</a>
    <li><a href="#ref-for-dom-label-label⑧">3.6.2. Receiving labeled objects</a>
    <li><a href="#ref-for-dom-label-label⑨">3.7.4. Modifications to WebSockets</a> <a href="#ref-for-dom-label-label①⓪">(2)</a>
    <li><a href="#ref-for-dom-label-label①①">4.1. Label Normal Form Reduction</a> <a href="#ref-for-dom-label-label①②">(2)</a>
    <li><a href="#ref-for-dom-label-label①③">4.8. 
      Should fetching request be blocked as COWL? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-label-principal">
   <b><a href="#dom-label-label-principal">#dom-label-label-principal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-label-principal">3.1. Labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-equals">
   <b><a href="#dom-label-equals">#dom-label-equals</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-equals">3.1. Labels</a>
    <li><a href="#ref-for-dom-label-equals①">4.1. Label Normal Form Reduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-subsumes">
   <b><a href="#dom-label-subsumes">#dom-label-subsumes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-subsumes">3.1. Labels</a>
    <li><a href="#ref-for-dom-label-subsumes①">3.4.3. Methods</a>
    <li><a href="#ref-for-dom-label-subsumes②">4.1. Label Normal Form Reduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-label-or">
   <b><a href="#dom-label-or">#dom-label-or</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-label-or">4.1. Label Normal Form Reduction</a>
    <li><a href="#ref-for-dom-label-or①">4.5. Context Tainting</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-stringification-behavior">
   <b><a href="#label-stringification-behavior">#label-stringification-behavior</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-stringification-behavior">3.1. Labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="internal-privilege-label">
   <b><a href="#internal-privilege-label">#internal-privilege-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-internal-privilege-label">2.2. Privileges</a>
    <li><a href="#ref-for-internal-privilege-label①">3.2. Privileges</a> <a href="#ref-for-internal-privilege-label②">(2)</a> <a href="#ref-for-internal-privilege-label③">(3)</a>
    <li><a href="#ref-for-internal-privilege-label④">3.2.1. Constructors</a> <a href="#ref-for-internal-privilege-label⑤">(2)</a>
    <li><a href="#ref-for-internal-privilege-label⑥">3.2.2. Methods</a> <a href="#ref-for-internal-privilege-label⑦">(2)</a> <a href="#ref-for-internal-privilege-label⑧">(3)</a> <a href="#ref-for-internal-privilege-label⑨">(4)</a> <a href="#ref-for-internal-privilege-label①⓪">(5)</a> <a href="#ref-for-internal-privilege-label①①">(6)</a> <a href="#ref-for-internal-privilege-label①②">(7)</a>
    <li><a href="#ref-for-internal-privilege-label①③">3.2.3. Examples</a> <a href="#ref-for-internal-privilege-label①④">(2)</a>
    <li><a href="#ref-for-internal-privilege-label①⑤">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-internal-privilege-label①⑥">3.4.3. Methods</a>
    <li><a href="#ref-for-internal-privilege-label①⑦">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-internal-privilege-label①⑧">4.3. Label Downgrade</a>
    <li><a href="#ref-for-internal-privilege-label①⑨">4.4. Label Upgrade</a>
    <li><a href="#ref-for-internal-privilege-label②⓪">4.7. Structured Cloning</a> <a href="#ref-for-internal-privilege-label②①">(2)</a>
    <li><a href="#ref-for-internal-privilege-label②②">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="combination">
   <b><a href="#combination">#combination</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-combination">2.2. Privileges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="empty-privilege">
   <b><a href="#empty-privilege">#empty-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-empty-privilege">1.2.4. Running content with least-privileges</a> <a href="#ref-for-empty-privilege①">(2)</a> <a href="#ref-for-empty-privilege②">(3)</a>
    <li><a href="#ref-for-empty-privilege③">3.2. Privileges</a> <a href="#ref-for-empty-privilege④">(2)</a>
    <li><a href="#ref-for-empty-privilege⑤">3.2.3. Examples</a> <a href="#ref-for-empty-privilege⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dropping-privileges">
   <b><a href="#dropping-privileges">#dropping-privileges</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dropping-privileges">1.2.4. Running content with least-privileges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="delegated-privilege">
   <b><a href="#delegated-privilege">#delegated-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-delegated-privilege">1. Introduction</a>
    <li><a href="#ref-for-delegated-privilege①">1.1. Goals</a>
    <li><a href="#ref-for-delegated-privilege②">1.2.3. Content isolation via privilege separation</a> <a href="#ref-for-delegated-privilege③">(2)</a> <a href="#ref-for-delegated-privilege④">(3)</a>
    <li><a href="#ref-for-delegated-privilege⑤">1.2.4. Running content with least-privileges</a>
    <li><a href="#ref-for-delegated-privilege⑥">2.2. Privileges</a>
    <li><a href="#ref-for-delegated-privilege⑦">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-delegated-privilege⑧">3.5.1. Sec-COWL in HTTP Requests</a>
    <li><a href="#ref-for-delegated-privilege⑨">4.7. Structured Cloning</a>
    <li><a href="#ref-for-delegated-privilege①⓪">4.9. 
      Process response to request as COWL </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="privilege①">
   <b><a href="#privilege①">#privilege①</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-privilege①">3. Framework</a>
    <li><a href="#ref-for-privilege①③">3.1. Labels</a>
    <li><a href="#ref-for-privilege①④">3.2. Privileges</a> <a href="#ref-for-privilege①⑤">(2)</a> <a href="#ref-for-privilege①⑥">(3)</a> <a href="#ref-for-privilege①⑦">(4)</a> <a href="#ref-for-privilege①⑧">(5)</a> <a href="#ref-for-privilege①⑨">(6)</a>
    <li><a href="#ref-for-privilege①①⓪">3.2.1. Constructors</a> <a href="#ref-for-privilege①①①">(2)</a>
    <li><a href="#ref-for-privilege①①②">3.2.2. Methods</a> <a href="#ref-for-privilege①①③">(2)</a> <a href="#ref-for-privilege①①④">(3)</a> <a href="#ref-for-privilege①①⑤">(4)</a> <a href="#ref-for-privilege①①⑥">(5)</a> <a href="#ref-for-privilege①①⑦">(6)</a> <a href="#ref-for-privilege①①⑧">(7)</a>
    <li><a href="#ref-for-privilege①①⑨">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-privilege①②⓪">3.3.1. Attributes</a>
    <li><a href="#ref-for-privilege①②①">4.7. Structured Cloning</a> <a href="#ref-for-privilege①②②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-privilege-combine-other-other">
   <b><a href="#dom-privilege-combine-other-other">#dom-privilege-combine-other-other</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-privilege-combine-other-other">3.2.2. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-privilege-delegate-label-label">
   <b><a href="#dom-privilege-delegate-label-label">#dom-privilege-delegate-label-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-privilege-delegate-label-label">3.2.2. Methods</a> <a href="#ref-for-dom-privilege-delegate-label-label①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-privilege-privilege">
   <b><a href="#dom-privilege-privilege">#dom-privilege-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-privilege-privilege">1.2.4. Running content with least-privileges</a>
    <li><a href="#ref-for-dom-privilege-privilege①">3.2. Privileges</a>
    <li><a href="#ref-for-dom-privilege-privilege②">3.2.1. Constructors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-privilege-freshprivilege">
   <b><a href="#dom-privilege-freshprivilege">#dom-privilege-freshprivilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-privilege-freshprivilege">3.2. Privileges</a>
    <li><a href="#ref-for-dom-privilege-freshprivilege①">3.2.1. Constructors</a>
    <li><a href="#ref-for-dom-privilege-freshprivilege②">3.2.3. Examples</a> <a href="#ref-for-dom-privilege-freshprivilege③">(2)</a>
    <li><a href="#ref-for-dom-privilege-freshprivilege④">3.5.1. Sec-COWL in HTTP Requests</a>
    <li><a href="#ref-for-dom-privilege-freshprivilege⑤">4.7. Structured Cloning</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-privilege-aslabel">
   <b><a href="#dom-privilege-aslabel">#dom-privilege-aslabel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-privilege-aslabel">3.1.2. Methods</a>
    <li><a href="#ref-for-dom-privilege-aslabel①">3.2. Privileges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-privilege-combine">
   <b><a href="#dom-privilege-combine">#dom-privilege-combine</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-privilege-combine">3.2. Privileges</a> <a href="#ref-for-dom-privilege-combine①">(2)</a>
    <li><a href="#ref-for-dom-privilege-combine②">3.2.2. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-privilege-delegate">
   <b><a href="#dom-privilege-delegate">#dom-privilege-delegate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-privilege-delegate">3.2. Privileges</a>
    <li><a href="#ref-for-dom-privilege-delegate①">3.2.2. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="cowl-state">
   <b><a href="#cowl-state">#cowl-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cowl-state">3.3. Labeled Contexts</a> <a href="#ref-for-cowl-state①">(2)</a> <a href="#ref-for-cowl-state②">(3)</a>
    <li><a href="#ref-for-cowl-state③">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-cowl-state④">3.5.2. Sec-COWL in HTTP Responses</a>
    <li><a href="#ref-for-cowl-state⑤">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-cowl-state⑥">(2)</a>
    <li><a href="#ref-for-cowl-state⑦">4.5. Context Tainting</a>
    <li><a href="#ref-for-cowl-state⑧">4.8. 
      Should fetching request be blocked as COWL? </a> <a href="#ref-for-cowl-state⑨">(2)</a>
    <li><a href="#ref-for-cowl-state①⓪">4.9. 
      Process response to request as COWL </a> <a href="#ref-for-cowl-state①①">(2)</a> <a href="#ref-for-cowl-state①②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="confinement-mode">
   <b><a href="#confinement-mode">#confinement-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-confinement-mode">3.3. Labeled Contexts</a> <a href="#ref-for-confinement-mode①">(2)</a> <a href="#ref-for-confinement-mode②">(3)</a> <a href="#ref-for-confinement-mode③">(4)</a>
    <li><a href="#ref-for-confinement-mode④">3.5.1. Sec-COWL in HTTP Requests</a>
    <li><a href="#ref-for-confinement-mode⑤">3.7.3. Modifications to HTML5</a> <a href="#ref-for-confinement-mode⑥">(2)</a>
    <li><a href="#ref-for-confinement-mode⑦">3.7.4. Modifications to WebSockets</a> <a href="#ref-for-confinement-mode⑧">(2)</a>
    <li><a href="#ref-for-confinement-mode⑨">4.8. 
      Should fetching request be blocked as COWL? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="confined-context">
   <b><a href="#confined-context">#confined-context</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-confined-context">3.3. Labeled Contexts</a> <a href="#ref-for-confined-context①">(2)</a> <a href="#ref-for-confined-context②">(3)</a>
    <li><a href="#ref-for-confined-context③">3.4. Labeled Objects</a>
    <li><a href="#ref-for-confined-context④">3.6.2.1. Examples</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="unconfined-context">
   <b><a href="#unconfined-context">#unconfined-context</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-unconfined-context">3.3. Labeled Contexts</a> <a href="#ref-for-unconfined-context①">(2)</a> <a href="#ref-for-unconfined-context②">(3)</a> <a href="#ref-for-unconfined-context③">(4)</a>
    <li><a href="#ref-for-unconfined-context④">3.4. Labeled Objects</a>
    <li><a href="#ref-for-unconfined-context⑤">3.4.2. Attributes</a>
    <li><a href="#ref-for-unconfined-context⑥">4.5. Context Tainting</a> <a href="#ref-for-unconfined-context⑦">(2)</a>
    <li><a href="#ref-for-unconfined-context⑧">4.9. 
      Process response to request as COWL </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="context-labels">
   <b><a href="#context-labels">#context-labels</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-context-labels">1.2.2. Sharing data with third-party mashups</a>
    <li><a href="#ref-for-context-labels①">2.1. Labels</a>
    <li><a href="#ref-for-context-labels②">2.2. Privileges</a>
    <li><a href="#ref-for-context-labels③">4.5. Context Tainting</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="context-confidentiality-label">
   <b><a href="#context-confidentiality-label">#context-confidentiality-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-context-confidentiality-label">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-context-confidentiality-label①">3.3.2. Examples</a>
    <li><a href="#ref-for-context-confidentiality-label②">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-context-confidentiality-label③">3.5.1. Sec-COWL in HTTP Requests</a>
    <li><a href="#ref-for-context-confidentiality-label④">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-context-confidentiality-label⑤">(2)</a>
    <li><a href="#ref-for-context-confidentiality-label⑥">4.5. Context Tainting</a> <a href="#ref-for-context-confidentiality-label⑦">(2)</a>
    <li><a href="#ref-for-context-confidentiality-label⑧">4.9. 
      Process response to request as COWL </a> <a href="#ref-for-context-confidentiality-label⑨">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="context-integrity-label">
   <b><a href="#context-integrity-label">#context-integrity-label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-context-integrity-label">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-context-integrity-label①">3.3.2. Examples</a>
    <li><a href="#ref-for-context-integrity-label②">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-context-integrity-label③">3.5.1. Sec-COWL in HTTP Requests</a>
    <li><a href="#ref-for-context-integrity-label④">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-context-integrity-label⑤">(2)</a>
    <li><a href="#ref-for-context-integrity-label⑥">3.7.4. Modifications to WebSockets</a>
    <li><a href="#ref-for-context-integrity-label⑦">4.5. Context Tainting</a> <a href="#ref-for-context-integrity-label⑧">(2)</a>
    <li><a href="#ref-for-context-integrity-label⑨">4.9. 
      Process response to request as COWL </a> <a href="#ref-for-context-integrity-label①⓪">(2)</a> <a href="#ref-for-context-integrity-label①①">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="context-privilege">
   <b><a href="#context-privilege">#context-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-context-privilege">1.2.3. Content isolation via privilege separation</a>
    <li><a href="#ref-for-context-privilege①">1.2.4. Running content with least-privileges</a>
    <li><a href="#ref-for-context-privilege②">1.4.1. Encoding information in labels</a>
    <li><a href="#ref-for-context-privilege③">3. Framework</a>
    <li><a href="#ref-for-context-privilege④">3.2. Privileges</a>
    <li><a href="#ref-for-context-privilege⑤">3.2.3. Examples</a> <a href="#ref-for-context-privilege⑥">(2)</a>
    <li><a href="#ref-for-context-privilege⑦">3.3. Labeled Contexts</a> <a href="#ref-for-context-privilege⑧">(2)</a>
    <li><a href="#ref-for-context-privilege⑨">3.3.2. Examples</a>
    <li><a href="#ref-for-context-privilege①⓪">3.4.3. Methods</a>
    <li><a href="#ref-for-context-privilege①①">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-context-privilege①②">3.5.1. Sec-COWL in HTTP Requests</a>
    <li><a href="#ref-for-context-privilege①③">3.6.1. Sending labeled objects</a>
    <li><a href="#ref-for-context-privilege①④">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-context-privilege①⑤">(2)</a>
    <li><a href="#ref-for-context-privilege①⑥">4.9. 
      Process response to request as COWL </a> <a href="#ref-for-context-privilege①⑦">(2)</a> <a href="#ref-for-context-privilege①⑧">(3)</a> <a href="#ref-for-context-privilege①⑨">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-cowl-state">
   <b><a href="#default-cowl-state">#default-cowl-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-cowl-state">3.3. Labeled Contexts</a> <a href="#ref-for-default-cowl-state①">(2)</a>
    <li><a href="#ref-for-default-cowl-state②">3.6.1.1. Examples</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-privilege">
   <b><a href="#default-privilege">#default-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-privilege">1.2.4. Running content with least-privileges</a>
    <li><a href="#ref-for-default-privilege①">3.2.3. Examples</a>
    <li><a href="#ref-for-default-privilege②">4.7. Structured Cloning</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="cowl">
   <b><a href="#cowl">#cowl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cowl">3. Framework</a> <a href="#ref-for-cowl①">(2)</a>
    <li><a href="#ref-for-cowl②">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-cowl③">3.3.2. Examples</a> <a href="#ref-for-cowl④">(2)</a> <a href="#ref-for-cowl⑤">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cowl-confidentiality">
   <b><a href="#dom-cowl-confidentiality">#dom-cowl-confidentiality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-cowl-confidentiality">3.3. Labeled Contexts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cowl-integrity">
   <b><a href="#dom-cowl-integrity">#dom-cowl-integrity</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-cowl-integrity">3.3. Labeled Contexts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cowl-privilege">
   <b><a href="#dom-cowl-privilege">#dom-cowl-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-cowl-privilege">3.3. Labeled Contexts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="protected-object">
   <b><a href="#protected-object">#protected-object</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-protected-object">1.2.1. Confining untrusted third-party services</a>
    <li><a href="#ref-for-protected-object①">3.4.1. Constructors</a>
    <li><a href="#ref-for-protected-object②">3.4.2. Attributes</a> <a href="#ref-for-protected-object③">(2)</a>
    <li><a href="#ref-for-protected-object④">3.4.3. Methods</a> <a href="#ref-for-protected-object⑤">(2)</a>
    <li><a href="#ref-for-protected-object⑥">3.6.1. Sending labeled objects</a> <a href="#ref-for-protected-object⑦">(2)</a>
    <li><a href="#ref-for-protected-object⑧">3.6.2. Receiving labeled objects</a>
    <li><a href="#ref-for-protected-object⑨">3.6.2.1. Examples</a>
    <li><a href="#ref-for-protected-object①⓪">4.7. Structured Cloning</a> <a href="#ref-for-protected-object①①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-cilabel">
   <b><a href="#dictdef-cilabel">#dictdef-cilabel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-cilabel">3.4. Labeled Objects</a> <a href="#ref-for-dictdef-cilabel①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cilabel-confidentiality">
   <b><a href="#dom-cilabel-confidentiality">#dom-cilabel-confidentiality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-cilabel-confidentiality">3.4.1. Constructors</a>
    <li><a href="#ref-for-dom-cilabel-confidentiality①">3.4.3. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cilabel-integrity">
   <b><a href="#dom-cilabel-integrity">#dom-cilabel-integrity</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-cilabel-integrity">3.4.1. Constructors</a>
    <li><a href="#ref-for-dom-cilabel-integrity①">3.4.3. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-labeledobject-obj-labels-obj">
   <b><a href="#dom-labeledobject-labeledobject-obj-labels-obj">#dom-labeledobject-labeledobject-obj-labels-obj</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-labeledobject-obj-labels-obj">3.4.1. Constructors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-labeledobject-obj-labels-labels">
   <b><a href="#dom-labeledobject-labeledobject-obj-labels-labels">#dom-labeledobject-labeledobject-obj-labels-labels</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-labeledobject-obj-labels-labels">3.4.1. Constructors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="labeledobject">
   <b><a href="#labeledobject">#labeledobject</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-labeledobject">1.2.1. Confining untrusted third-party services</a>
    <li><a href="#ref-for-labeledobject①">2.2. Privileges</a>
    <li><a href="#ref-for-labeledobject②">3. Framework</a>
    <li><a href="#ref-for-labeledobject③">3.2.3. Examples</a>
    <li><a href="#ref-for-labeledobject④">3.3. Labeled Contexts</a>
    <li><a href="#ref-for-labeledobject⑤">3.4. Labeled Objects</a> <a href="#ref-for-labeledobject⑥">(2)</a> <a href="#ref-for-labeledobject⑦">(3)</a> <a href="#ref-for-labeledobject⑧">(4)</a>
    <li><a href="#ref-for-labeledobject⑨">3.4.1. Constructors</a> <a href="#ref-for-labeledobject①⓪">(2)</a>
    <li><a href="#ref-for-labeledobject①①">3.4.2. Attributes</a> <a href="#ref-for-labeledobject①②">(2)</a> <a href="#ref-for-labeledobject①③">(3)</a> <a href="#ref-for-labeledobject①④">(4)</a> <a href="#ref-for-labeledobject①⑤">(5)</a>
    <li><a href="#ref-for-labeledobject①⑥">3.4.3. Methods</a>
    <li><a href="#ref-for-labeledobject①⑦">3.4.4. Examples</a> <a href="#ref-for-labeledobject①⑧">(2)</a> <a href="#ref-for-labeledobject①⑨">(3)</a> <a href="#ref-for-labeledobject②⓪">(4)</a>
    <li><a href="#ref-for-labeledobject②①">3.6.1. Sending labeled objects</a> <a href="#ref-for-labeledobject②②">(2)</a>
    <li><a href="#ref-for-labeledobject②③">3.6.2. Receiving labeled objects</a> <a href="#ref-for-labeledobject②④">(2)</a>
    <li><a href="#ref-for-labeledobject②⑤">3.6.2.1. Examples</a> <a href="#ref-for-labeledobject②⑥">(2)</a>
    <li><a href="#ref-for-labeledobject②⑦">4.7. Structured Cloning</a> <a href="#ref-for-labeledobject②⑧">(2)</a> <a href="#ref-for-labeledobject②⑨">(3)</a> <a href="#ref-for-labeledobject③⓪">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-clone-labels-labels">
   <b><a href="#dom-labeledobject-clone-labels-labels">#dom-labeledobject-clone-labels-labels</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-clone-labels-labels">3.4.3. Methods</a> <a href="#ref-for-dom-labeledobject-clone-labels-labels①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-labeledobject">
   <b><a href="#dom-labeledobject-labeledobject">#dom-labeledobject-labeledobject</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-labeledobject">3.4. Labeled Objects</a>
    <li><a href="#ref-for-dom-labeledobject-labeledobject①">3.4.1. Constructors</a> <a href="#ref-for-dom-labeledobject-labeledobject②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-confidentiality">
   <b><a href="#dom-labeledobject-confidentiality">#dom-labeledobject-confidentiality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-confidentiality">3.4. Labeled Objects</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-integrity">
   <b><a href="#dom-labeledobject-integrity">#dom-labeledobject-integrity</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-integrity">3.4. Labeled Objects</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-protectedobject">
   <b><a href="#dom-labeledobject-protectedobject">#dom-labeledobject-protectedobject</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-protectedobject">3.4. Labeled Objects</a>
    <li><a href="#ref-for-dom-labeledobject-protectedobject①">3.4.4. Examples</a> <a href="#ref-for-dom-labeledobject-protectedobject②">(2)</a> <a href="#ref-for-dom-labeledobject-protectedobject③">(3)</a>
    <li><a href="#ref-for-dom-labeledobject-protectedobject④">3.6.2.1. Examples</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-labeledobject-clone">
   <b><a href="#dom-labeledobject-clone">#dom-labeledobject-clone</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-labeledobject-clone">3.4. Labeled Objects</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-metadata">
   <b><a href="#label-metadata">#label-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-metadata">3.5. The Sec-COWL HTTP Header Field</a> <a href="#ref-for-label-metadata①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="labeled-context-metadata">
   <b><a href="#labeled-context-metadata">#labeled-context-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-labeled-context-metadata">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-labeled-context-metadata①">3.5.1. Sec-COWL in HTTP Requests</a> <a href="#ref-for-labeled-context-metadata②">(2)</a> <a href="#ref-for-labeled-context-metadata③">(3)</a>
    <li><a href="#ref-for-labeled-context-metadata④">3.5.2. Sec-COWL in HTTP Responses</a>
    <li><a href="#ref-for-labeled-context-metadata⑤">4.9. 
      Process response to request as COWL </a>
    <li><a href="#ref-for-labeled-context-metadata⑥">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ctx-metadata">
   <b><a href="#ctx-metadata">#ctx-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ctx-metadata">3.5.1. Sec-COWL in HTTP Requests</a> <a href="#ref-for-ctx-metadata①">(2)</a> <a href="#ref-for-ctx-metadata②">(3)</a>
    <li><a href="#ref-for-ctx-metadata③">3.5.2. Sec-COWL in HTTP Responses</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ctx-directive">
   <b><a href="#ctx-directive">#ctx-directive</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ctx-directive">3.5. The Sec-COWL HTTP Header Field</a> <a href="#ref-for-ctx-directive①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ctx-directive-name">
   <b><a href="#ctx-directive-name">#ctx-directive-name</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ctx-directive-name">3.5. The Sec-COWL HTTP Header Field</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ctx-confidentiality">
   <b><a href="#ctx-confidentiality">#ctx-confidentiality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ctx-confidentiality">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-ctx-confidentiality①">3.5.1. Sec-COWL in HTTP Requests</a> <a href="#ref-for-ctx-confidentiality②">(2)</a>
    <li><a href="#ref-for-ctx-confidentiality③">3.6.1.1. Examples</a>
    <li><a href="#ref-for-ctx-confidentiality④">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ctx-integrity">
   <b><a href="#ctx-integrity">#ctx-integrity</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ctx-integrity">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-ctx-integrity①">3.5.1. Sec-COWL in HTTP Requests</a> <a href="#ref-for-ctx-integrity②">(2)</a>
    <li><a href="#ref-for-ctx-integrity③">3.6.1.1. Examples</a>
    <li><a href="#ref-for-ctx-integrity④">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ctx-privilege">
   <b><a href="#ctx-privilege">#ctx-privilege</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ctx-privilege">1.2.3. Content isolation via privilege separation</a>
    <li><a href="#ref-for-ctx-privilege①">1.2.4. Running content with least-privileges</a>
    <li><a href="#ref-for-ctx-privilege②">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-ctx-privilege③">3.5.1. Sec-COWL in HTTP Requests</a> <a href="#ref-for-ctx-privilege④">(2)</a>
    <li><a href="#ref-for-ctx-privilege⑤">3.5.2. Sec-COWL in HTTP Responses</a>
    <li><a href="#ref-for-ctx-privilege⑥">3.6.1.1. Examples</a>
    <li><a href="#ref-for-ctx-privilege⑦">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="labeled-data-metadata">
   <b><a href="#labeled-data-metadata">#labeled-data-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-labeled-data-metadata">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-labeled-data-metadata①">3.5.1. Sec-COWL in HTTP Requests</a> <a href="#ref-for-labeled-data-metadata②">(2)</a>
    <li><a href="#ref-for-labeled-data-metadata③">3.5.2. Sec-COWL in HTTP Responses</a>
    <li><a href="#ref-for-labeled-data-metadata④">3.6.1. Sending labeled objects</a>
    <li><a href="#ref-for-labeled-data-metadata⑤">4.9. 
      Process response to request as COWL </a>
    <li><a href="#ref-for-labeled-data-metadata⑥">4.10. 
      Parse labeled data metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="data-metadata">
   <b><a href="#data-metadata">#data-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-data-metadata">3.5.1. Sec-COWL in HTTP Requests</a> <a href="#ref-for-data-metadata①">(2)</a> <a href="#ref-for-data-metadata②">(3)</a>
    <li><a href="#ref-for-data-metadata③">3.5.2. Sec-COWL in HTTP Responses</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="data-directive">
   <b><a href="#data-directive">#data-directive</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-data-directive">3.5. The Sec-COWL HTTP Header Field</a> <a href="#ref-for-data-directive①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="data-directive-name">
   <b><a href="#data-directive-name">#data-directive-name</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-data-directive-name">3.5. The Sec-COWL HTTP Header Field</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="data-confidentiality">
   <b><a href="#data-confidentiality">#data-confidentiality</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-data-confidentiality">1.2.2. Sharing data with third-party mashups</a>
    <li><a href="#ref-for-data-confidentiality①">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-data-confidentiality②">3.5.2. Sec-COWL in HTTP Responses</a>
    <li><a href="#ref-for-data-confidentiality③">3.6.1.1. Examples</a>
    <li><a href="#ref-for-data-confidentiality④">4.10. 
      Parse labeled data metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="data-integrity">
   <b><a href="#data-integrity">#data-integrity</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-data-integrity">3.5. The Sec-COWL HTTP Header Field</a>
    <li><a href="#ref-for-data-integrity①">3.5.2. Sec-COWL in HTTP Responses</a>
    <li><a href="#ref-for-data-integrity②">3.6.1.1. Examples</a>
    <li><a href="#ref-for-data-integrity③">4.10. 
      Parse labeled data metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-expression">
   <b><a href="#label-expression">#label-expression</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-expression">3.1.3. Serializing labels</a>
    <li><a href="#ref-for-label-expression①">3.5. The Sec-COWL HTTP Header Field</a> <a href="#ref-for-label-expression②">(2)</a>
    <li><a href="#ref-for-label-expression③">4.12. 
      Parse label expression </a> <a href="#ref-for-label-expression④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="and-expression">
   <b><a href="#and-expression">#and-expression</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-and-expression">3.5. The Sec-COWL HTTP Header Field</a> <a href="#ref-for-and-expression①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="or-expression">
   <b><a href="#or-expression">#or-expression</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-or-expression">3.5. The Sec-COWL HTTP Header Field</a> <a href="#ref-for-or-expression①">(2)</a> <a href="#ref-for-or-expression②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="empty-label①">
   <b><a href="#empty-label①">#empty-label①</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-empty-label①">3.2.1. Constructors</a>
    <li><a href="#ref-for-empty-label①⑨">3.5. The Sec-COWL HTTP Header Field</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="principal-expression">
   <b><a href="#principal-expression">#principal-expression</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-principal-expression">3.5. The Sec-COWL HTTP Header Field</a> <a href="#ref-for-principal-expression①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="origin-principal-expression">
   <b><a href="#origin-principal-expression">#origin-principal-expression</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-origin-principal-expression">3.5. The Sec-COWL HTTP Header Field</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="app-principal-expression">
   <b><a href="#app-principal-expression">#app-principal-expression</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-app-principal-expression">2.1. Labels</a>
    <li><a href="#ref-for-app-principal-expression①">3.5. The Sec-COWL HTTP Header Field</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="unique-principal-expression">
   <b><a href="#unique-principal-expression">#unique-principal-expression</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-unique-principal-expression">2.1. Labels</a>
    <li><a href="#ref-for-unique-principal-expression①">3.5. The Sec-COWL HTTP Header Field</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xmlhttprequest-send-lobj-lobj">
   <b><a href="#dom-xmlhttprequest-send-lobj-lobj">#dom-xmlhttprequest-send-lobj-lobj</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xmlhttprequest-send-lobj-lobj">3.6.1. Sending labeled objects</a> <a href="#ref-for-dom-xmlhttprequest-send-lobj-lobj①">(2)</a> <a href="#ref-for-dom-xmlhttprequest-send-lobj-lobj②">(3)</a> <a href="#ref-for-dom-xmlhttprequest-send-lobj-lobj③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xmlhttprequest-send">
   <b><a href="#dom-xmlhttprequest-send">#dom-xmlhttprequest-send</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xmlhttprequest-send">3.6.1. Sending labeled objects</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="response-labeledobject-object">
   <b><a href="#response-labeledobject-object">#response-labeledobject-object</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-response-labeledobject-object">3.6.2. Receiving labeled objects</a> <a href="#ref-for-response-labeledobject-object①">(2)</a> <a href="#ref-for-response-labeledobject-object②">(3)</a> <a href="#ref-for-response-labeledobject-object③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="labeled-json-response">
   <b><a href="#labeled-json-response">#labeled-json-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-labeled-json-response">1.2.2. Sharing data with third-party mashups</a>
    <li><a href="#ref-for-labeled-json-response①">3.6.2. Receiving labeled objects</a>
    <li><a href="#ref-for-labeled-json-response②">3.6.2.1. Examples</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-normal-form-reduction">
   <b><a href="#label-normal-form-reduction">#label-normal-form-reduction</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-normal-form-reduction">2.1. Labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-subsumption">
   <b><a href="#label-subsumption">#label-subsumption</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-subsumption">2.1. Labels</a>
    <li><a href="#ref-for-label-subsumption①">4.2. Label Subsumption</a>
    <li><a href="#ref-for-label-subsumption②">4.9. 
      Process response to request as COWL </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-downgrade">
   <b><a href="#label-downgrade">#label-downgrade</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-downgrade">2.2. Privileges</a>
    <li><a href="#ref-for-label-downgrade①">4.3. Label Downgrade</a>
    <li><a href="#ref-for-label-downgrade②">4.4. Label Upgrade</a>
    <li><a href="#ref-for-label-downgrade③">4.5. Context Tainting</a> <a href="#ref-for-label-downgrade④">(2)</a>
    <li><a href="#ref-for-label-downgrade⑤">4.9. 
      Process response to request as COWL </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label-upgrade">
   <b><a href="#label-upgrade">#label-upgrade</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-upgrade">2.2. Privileges</a>
    <li><a href="#ref-for-label-upgrade①">3.7.2. Modifications to Web Messaging</a> <a href="#ref-for-label-upgrade②">(2)</a> <a href="#ref-for-label-upgrade③">(3)</a> <a href="#ref-for-label-upgrade④">(4)</a>
    <li><a href="#ref-for-label-upgrade⑤">4.4. Label Upgrade</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="context-tainting">
   <b><a href="#context-tainting">#context-tainting</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-context-tainting">2.1. Labels</a>
    <li><a href="#ref-for-context-tainting①">3.4.2. Attributes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="write-check">
   <b><a href="#write-check">#write-check</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-write-check">3.3.1. Attributes</a> <a href="#ref-for-write-check①">(2)</a>
    <li><a href="#ref-for-write-check②">3.4.1. Constructors</a>
    <li><a href="#ref-for-write-check③">3.7.4. Modifications to WebSockets</a> <a href="#ref-for-write-check④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-labeled-data-metadata">
   <b><a href="#parse-labeled-data-metadata">#parse-labeled-data-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-labeled-data-metadata">4.9. 
      Process response to request as COWL </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-labeled-context-metadata">
   <b><a href="#parse-labeled-context-metadata">#parse-labeled-context-metadata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-labeled-context-metadata">4.9. 
      Process response to request as COWL </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-label-expression①">
   <b><a href="#parse-label-expression①">#parse-label-expression①</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-label-expression①">4.10. 
      Parse labeled data metadata </a>
    <li><a href="#ref-for-parse-label-expression①①">4.11. 
      Parse labeled context metadata </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="split">
   <b><a href="#split">#split</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-split">4.12. 
      Parse label expression </a> <a href="#ref-for-split①">(2)</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>